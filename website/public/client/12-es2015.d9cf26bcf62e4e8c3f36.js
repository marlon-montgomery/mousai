(window.webpackJsonp=window.webpackJsonp||[]).push([[12],{n0fL:function(t,e,n){"use strict";n.r(e),n.d(e,"BackstageModule",function(){return ri});var i=n("ofXK"),a=n("tyNb"),r=n("2Vo4"),o=n("nYR2"),c=n("8/ZB"),s=n("fXoL"),l=n("/uxT"),u=n("3Pt+"),b=n("kmQS"),d=n("ORVr"),m=n("QJx+"),p=n("h586"),g=n("xrAa"),f=n("Rd8u"),h=n("pCVY"),v=n("bTqV"),y=n("NFeN"),k=n("DzUk"),x=n("rG4v"),P=n("LRne"),U=n("Kj3r"),C=n("/uUt"),V=n("eIep"),O=n("JIr8"),I=n("lJxs"),D=n("OkhP"),_=n("STbY"),M=n("FBzJ"),w=n("8HKz");const J=["searchInput"],A=["fakeInput"];function F(t,e){if(1&t&&(s.Vb(0,"span"),s.Qb(1,"media-image",16),s.Jc(2),s.Ub()),2&t){const t=e.ngIf;s.Db(1),s.nc("media",t),s.Db(1),s.Lc(" ",t.name," ")}}function Q(t,e){1&t&&(s.Vb(0,"span",17),s.Jc(1,"Select an artist"),s.Ub())}function $(t,e){if(1&t){const t=s.Wb();s.Vb(0,"button",18),s.cc("click",function(){return s.yc(t),s.gc().clearSearchInput()}),s.Qb(1,"mat-icon",19),s.Ub()}}function T(t,e){if(1&t){const t=s.Wb();s.Vb(0,"button",20),s.cc("click",function(){s.yc(t);const n=e.$implicit;return s.gc().selectArtist(n)}),s.Qb(1,"media-image",16),s.Vb(2,"div",21),s.Vb(3,"div",22),s.Jc(4),s.Ub(),s.Vb(5,"div",23),s.Jc(6,"Artist"),s.Ub(),s.Ub(),s.Ub()}if(2&t){const t=e.$implicit;s.Db(1),s.nc("media",t),s.Db(3),s.Kc(t.name)}}function S(t,e){1&t&&(s.Vb(0,"div",24),s.Jc(1,"No artists found."),s.Ub())}let H=(()=>{class t{constructor(t){this.search=t,this.listAll=!1,this.isDisabled$=new r.a(!1),this.searchFormControl=new u.g,this.loading$=new r.a(!1),this.artists$=new r.a([]),this.selectedArtist$=new r.a(null),this.searchedOnce=!1}ngOnInit(){this.bindToSearchControl()}writeValue(t){this.selectedArtist$.next(t)}registerOnChange(t){this.propagateChange=t}registerOnTouched(){}setDisabledState(t){this.isDisabled$.next(t)}bindToSearchControl(){this.searchFormControl.valueChanges.pipe(Object(U.a)(150),Object(C.a)(),Object(V.a)(t=>this.searchArtists(t)),Object(O.a)(()=>Object(P.a)([]))).subscribe(t=>{this.searchedOnce=!0,this.artists$.next(t)})}searchArtists(t){return this.loading$.next(!0),this.search.suggestArtists({query:t,limit:7,listAll:this.listAll}).pipe(Object(o.a)(()=>this.loading$.next(!1)),Object(I.a)(t=>t.artists))}onMenuOpened(){document.querySelector(".select-artist-control-menu").style.width=this.fakeInput.nativeElement.getBoundingClientRect().width+"px",this.searchedOnce||this.clearSearchInput()}selectArtist(t){this.selectedArtist$.next(t),this.propagateChange(t)}clearSearchInput(){this.searchFormControl.setValue("")}onMenuClosed(){this.loading$.next(!1),this.clearSearchInput()}}return t.\u0275fac=function(e){return new(e||t)(s.Pb(D.a))},t.\u0275cmp=s.Jb({type:t,selectors:[["select-artist-control"]],viewQuery:function(t,e){if(1&t&&(s.Pc(J,1),s.Pc(A,1)),2&t){let t;s.uc(t=s.dc())&&(e.searchInput=t.first),s.uc(t=s.dc())&&(e.fakeInput=t.first)}},hostAttrs:["tabindex","0"],inputs:{listAll:"listAll"},features:[s.Cb([{provide:u.q,useExisting:t,multi:!0}])],decls:22,vars:20,consts:[[1,"fake-input",3,"matMenuTriggerFor","menuOpened","menuClosed"],["fakeInput",""],[4,"ngIf","ngIfElse"],["anyArtist",""],[1,"arrow-container"],[1,"arrow"],[1,"select-artist-control-menu"],["menu","matMenu"],[1,"input-container","search-input-container",3,"click"],[1,"search-input-wrapper"],["type","text","placeholder","Search...","mat-menu-item","","trans-placeholder","",3,"formControl"],["searchInput",""],["class","clear-search-input-button","mat-icon-button","",3,"click",4,"ngIf"],[1,"small",3,"isVisible"],["type","button","mat-menu-item","",3,"click",4,"ngFor","ngForOf"],["mat-menu-item","","disabled","","trans","",4,"ngIf"],[1,"result-image",3,"media"],["trans",""],["mat-icon-button","",1,"clear-search-input-button",3,"click"],["svgIcon","close"],["type","button","mat-menu-item","",3,"click"],[1,"user-info"],[1,"name"],["trans","",1,"email"],["mat-menu-item","","disabled","","trans",""]],template:function(t,e){if(1&t&&(s.Vb(0,"div",0,1),s.cc("menuOpened",function(){return e.onMenuOpened()})("menuClosed",function(){return e.onMenuClosed()}),s.hc(2,"async"),s.Hc(3,F,3,2,"span",2),s.hc(4,"async"),s.Hc(5,Q,2,0,"ng-template",null,3,s.Ic),s.Vb(7,"div",4),s.Qb(8,"div",5),s.Ub(),s.Ub(),s.Vb(9,"mat-menu",6,7),s.Vb(11,"div",8),s.cc("click",function(t){return t.stopPropagation()}),s.Vb(12,"div",9),s.Qb(13,"input",10,11),s.Hc(15,$,2,0,"button",12),s.Qb(16,"loading-indicator",13),s.hc(17,"async"),s.Ub(),s.Ub(),s.Hc(18,T,7,2,"button",14),s.hc(19,"async"),s.Hc(20,S,2,0,"div",15),s.hc(21,"async"),s.Ub()),2&t){const t=s.vc(6),n=s.vc(10);s.Hb("disabled",s.ic(2,10,e.isDisabled$)),s.nc("matMenuTriggerFor",n),s.Db(3),s.nc("ngIf",s.ic(4,12,e.selectedArtist$))("ngIfElse",t),s.Db(10),s.nc("formControl",e.searchFormControl),s.Db(2),s.nc("ngIf",e.searchFormControl.value),s.Db(1),s.nc("isVisible",s.ic(17,14,e.loading$)),s.Db(2),s.nc("ngForOf",s.ic(19,16,e.artists$)),s.Db(2),s.nc("ngIf",e.searchedOnce&&!s.ic(21,18,e.artists$).length)}},directives:[_.c,i.o,_.d,u.c,_.a,f.a,u.s,u.h,M.a,i.n,w.a,v.b,y.a],pipes:[i.b],styles:["[_nghost-%COMP%]{display:block;min-width:280px;max-width:100%}.fake-input[_ngcontent-%COMP%]{position:relative;display:flex;align-items:center;cursor:pointer}.fake-input.disabled[_ngcontent-%COMP%]{pointer-events:none;opacity:.7}.result-image[_ngcontent-%COMP%]{display:inline-block;margin-right:5px;width:25px;height:25px;border-radius:4px;vertical-align:middle}.placeholder[_ngcontent-%COMP%]{opacity:.6}.arrow-container[_ngcontent-%COMP%]{height:100%;position:absolute;top:1px;right:1px;width:20px}.arrow[_ngcontent-%COMP%]{position:absolute;border-color:#000 transparent transparent;border-style:solid;border-width:5px 4px 0;height:0;width:0;left:50%;top:50%;margin-left:-4px;margin-top:-2px}  .select-artist-control-menu{max-width:none!important}.mat-menu-item[_ngcontent-%COMP%]:first-of-type{border-top:1px solid var(--be-divider-default)}.search-input-container[_ngcontent-%COMP%]{padding:7px 15px 15px}.search-input-wrapper[_ngcontent-%COMP%]{position:relative}.clear-search-input-button[_ngcontent-%COMP%]{position:absolute;top:4px;right:0;color:var(--be-secondary-text)}.mat-menu-item[_ngcontent-%COMP%]:not(input){display:flex;align-items:center;height:65px;line-height:65px}.mat-menu-item[_ngcontent-%COMP%]:not(input).selected{background-color:var(--be-accent-emphasis)}.mat-menu-item[_ngcontent-%COMP%]:not(input)   .result-image[_ngcontent-%COMP%]{width:45px;height:45px;margin-right:15px;border-radius:50%}.mat-menu-item[_ngcontent-%COMP%]:not(input)   .name[_ngcontent-%COMP%]{text-transform:capitalize;overflow:hidden;text-overflow:ellipsis}.mat-menu-item[_ngcontent-%COMP%]:not(input)   .email[_ngcontent-%COMP%]{color:var(--be-secondary-text);font-size:1.3rem;overflow:hidden;text-overflow:ellipsis}.user-info[_ngcontent-%COMP%]{line-height:normal}.any-user-info[_ngcontent-%COMP%]{line-height:35px}loading-indicator[_ngcontent-%COMP%]{position:absolute;top:12px;right:40px}"],changeDetection:0}),t})();var q=n("6SKC");function j(t,e){if(1&t&&(s.Vb(0,"div",32),s.Jc(1),s.Ub()),2&t){const t=s.gc(3).ngIf;s.Db(1),s.Kc(t.artist_id)}}function z(t,e){if(1&t&&(s.Vb(0,"div",7),s.Vb(1,"label",30),s.Jc(2,"Select Artist"),s.Ub(),s.Qb(3,"select-artist-control",31),s.Hc(4,j,2,1,"div",10),s.Ub()),2&t){const t=s.gc(2).ngIf;s.Db(3),s.nc("listAll",!0),s.Db(1),s.nc("ngIf",t.artist_id)}}function E(t,e){if(1&t&&(s.Vb(0,"div",32),s.Jc(1),s.Ub()),2&t){const t=s.gc(3).ngIf;s.Db(1),s.Kc(t.name)}}function N(t,e){if(1&t&&(s.Vb(0,"div",7),s.Vb(1,"label",33),s.Jc(2,"Your artist name"),s.Ub(),s.Qb(3,"input",34),s.Hc(4,E,2,1,"div",10),s.Ub()),2&t){const t=s.gc(2).ngIf;s.Db(4),s.nc("ngIf",t.name)}}function L(t,e){if(1&t&&(s.Vb(0,"div",32),s.Jc(1),s.Ub()),2&t){const t=s.gc(2).ngIf;s.Db(1),s.Kc(t.first_name)}}function B(t,e){if(1&t&&(s.Vb(0,"div",32),s.Jc(1),s.Ub()),2&t){const t=s.gc(2).ngIf;s.Db(1),s.Kc(t.last_name)}}function K(t,e){if(1&t&&(s.Vb(0,"div",32),s.Jc(1),s.Ub()),2&t){const t=s.gc(3).ngIf;s.Db(1),s.Kc(t.role)}}function G(t,e){if(1&t&&(s.Vb(0,"div",7),s.Vb(1,"label",35),s.Jc(2,"Role"),s.Ub(),s.Vb(3,"select",36),s.Vb(4,"option",37),s.Jc(5,"Select role"),s.Ub(),s.Vb(6,"option",38),s.Jc(7,"Artist"),s.Ub(),s.Vb(8,"option",39),s.Jc(9,"Agent"),s.Ub(),s.Vb(10,"option",40),s.Jc(11,"Composer"),s.Ub(),s.Vb(12,"option",41),s.Jc(13,"Label"),s.Ub(),s.Vb(14,"option",42),s.Jc(15,"Manager"),s.Ub(),s.Vb(16,"option",43),s.Jc(17,"Musician"),s.Ub(),s.Vb(18,"option",44),s.Jc(19,"Producer"),s.Ub(),s.Vb(20,"option",45),s.Jc(21,"Publisher"),s.Ub(),s.Vb(22,"option",46),s.Jc(23,"Songwriter"),s.Ub(),s.Ub(),s.Hc(24,K,2,1,"div",10),s.Ub()),2&t){const t=s.gc(2).ngIf;s.Db(4),s.nc("value",null),s.Db(20),s.nc("ngIf",t.role)}}function R(t,e){if(1&t&&(s.Vb(0,"div",32),s.Jc(1),s.Ub()),2&t){const t=s.gc(2).ngIf;s.Db(1),s.Kc(t.company)}}function W(t,e){if(1&t){const t=s.Wb();s.Vb(0,"div",47),s.Qb(1,"img",48),s.Vb(2,"div",49),s.Vb(3,"div",50),s.Jc(4),s.Ub(),s.Vb(5,"a",51),s.Jc(6),s.Ub(),s.Ub(),s.Vb(7,"button",52),s.cc("click",function(){s.yc(t);const n=e.$implicit;return s.gc(3).removeSocialProfile(n.key)}),s.Qb(8,"mat-icon",53),s.Ub(),s.Ub()}if(2&t){const t=e.$implicit;s.Db(1),s.nc("src",t.value.avatar,s.Bc),s.Db(3),s.Lc("",t.key," Profile"),s.Db(1),s.nc("href",t.value.profileUrl,s.Bc),s.Db(1),s.Kc(t.value.profileUrl)}}function Z(t,e){if(1&t){const t=s.Wb();s.Vb(0,"div",54),s.Qb(1,"mat-icon",55),s.Vb(2,"div",49),s.Vb(3,"div",50),s.Jc(4,"Passport Scan"),s.Ub(),s.Vb(5,"div"),s.Jc(6),s.hc(7,"formattedFileSize"),s.Ub(),s.Ub(),s.Vb(8,"button",52),s.cc("click",function(){return s.yc(t),s.gc(3).removePassportUpload()}),s.Qb(9,"mat-icon",53),s.Ub(),s.Ub()}if(2&t){const t=e.ngIf;s.Db(6),s.Mc("",t.name," (",s.ic(7,2,t.file_size),")")}}const Y=function(){return["image/*"]},X=function(t){return{types:t}};function tt(t,e){if(1&t){const t=s.Wb();s.Tb(0),s.Qb(1,"upload-image-control",4),s.Hc(2,z,5,2,"div",5),s.Hc(3,N,5,1,"div",5),s.Vb(4,"div",6),s.Vb(5,"div",7),s.Vb(6,"label",8),s.Jc(7,"First name"),s.Ub(),s.Qb(8,"input",9),s.Hc(9,L,2,1,"div",10),s.Ub(),s.Vb(10,"div",7),s.Vb(11,"label",11),s.Jc(12,"Last name"),s.Ub(),s.Qb(13,"input",12),s.Hc(14,B,2,1,"div",10),s.Ub(),s.Ub(),s.Hc(15,G,25,2,"div",5),s.Vb(16,"div",7),s.Vb(17,"label",13),s.Jc(18,"Company (optional)"),s.Ub(),s.Qb(19,"input",14),s.Hc(20,R,2,1,"div",10),s.Ub(),s.Vb(21,"div",15),s.Vb(22,"div",16),s.Jc(23,"Speed up the process by connecting artist social media accounts or uploading your passport scan."),s.Ub(),s.Vb(24,"div",17),s.Vb(25,"button",18),s.cc("click",function(){return s.yc(t),s.gc(2).retrieveSocialProfile("twitter")}),s.Qb(26,"mat-icon",19),s.Vb(27,"span",0),s.Jc(28,"Connect to Twitter"),s.Ub(),s.Ub(),s.Vb(29,"button",20),s.cc("click",function(){return s.yc(t),s.gc(2).retrieveSocialProfile("facebook")}),s.Qb(30,"mat-icon",21),s.Vb(31,"span",0),s.Jc(32,"Connect to Facebook"),s.Ub(),s.Ub(),s.Vb(33,"button",22),s.cc("filesSelected",function(e){return s.yc(t),s.gc(2).uploadPassportScan(e)}),s.Qb(34,"mat-icon",23),s.Vb(35,"span",0),s.Jc(36,"Upload Passport Scan"),s.Ub(),s.Ub(),s.Ub(),s.Vb(37,"div",24),s.Hc(38,W,9,4,"div",25),s.hc(39,"keyvalue"),s.hc(40,"async"),s.Hc(41,Z,10,4,"div",26),s.hc(42,"async"),s.Qb(43,"upload-progress-bar"),s.Ub(),s.Ub(),s.Vb(44,"div",27),s.Vb(45,"a",28),s.Jc(46,"Go Back"),s.Ub(),s.Vb(47,"button",29),s.hc(48,"async"),s.Jc(49,"Submit Request"),s.Ub(),s.Ub(),s.Sb()}if(2&t){const t=e.ngIf,n=s.gc().ngIf,i=s.gc();s.Db(1),s.nc("compact",!0),s.Db(1),s.nc("ngIf","become-artist"!==t),s.Db(1),s.nc("ngIf","become-artist"===t),s.Db(6),s.nc("ngIf",n.first_name),s.Db(5),s.nc("ngIf",n.last_name),s.Db(1),s.nc("ngIf","claim-artist"===t),s.Db(5),s.nc("ngIf",n.company),s.Db(13),s.nc("uploadButton",s.rc(20,X,s.qc(19,Y))),s.Db(5),s.nc("ngForOf",s.ic(39,11,s.ic(40,13,i.socialProfiles$))),s.Db(3),s.nc("ngIf",s.ic(42,15,i.uploadedPassportEntry$)),s.Db(6),s.nc("disabled",s.ic(48,17,i.loading$))}}function et(t,e){if(1&t){const t=s.Wb();s.Vb(0,"form",2),s.cc("ngSubmit",function(){return s.yc(t),s.gc().requestAccess()}),s.Hc(1,tt,50,22,"ng-container",3),s.hc(2,"async"),s.Ub()}if(2&t){const t=s.gc();s.nc("formGroup",t.form),s.Db(1),s.nc("ngIf",s.ic(2,2,t.requestType$))}}let nt=(()=>{class t{constructor(t,e,n,i,a,o,s,l,u){var b;this.backstage=t,this.fb=e,this.settings=n,this.currentUser=i,this.socialAuth=a,this.uploadQueue=o,this.imageValidator=s,this.router=l,this.route=u,this.uploadedPassportEntry$=new r.a(null),this.socialProfiles$=new r.a(null),this.errors$=new r.a({}),this.loading$=new r.a(!1),this.requestType$=new r.a(null),this.form=this.fb.group({artist:[],artist_name:[this.currentUser.get("display_name")],image:[(null===(b=this.currentUser.primaryArtist())||void 0===b?void 0:b.image_small)||this.currentUser.get("avatar")],first_name:[this.currentUser.get("first_name")],last_name:[this.currentUser.get("last_name")],role:[],company:[""]}),this.requestType$.next(this.route.routeConfig.path.replace("requests/","")),this.requestType$.value===c.a.verifyArtist&&(this.form.get("artist").setValue(this.currentUser.primaryArtist()),this.form.get("artist").disable()),this.requestType$.value===c.a.becomeArtist&&(this.form.get("artist").setValue(this.currentUser.artistPlaceholder()),this.form.get("artist").disable()),this.requestType$.value!==c.a.claimArtist&&this.form.get("role").setValue("artist"),this.requestType$.value!==c.a.becomeArtist&&this.form.get("image").disable()}requestAccess(){var t,e;this.loading$.next(!0);const n={artist_name:this.form.value.artist_name,artist_id:null===(t=this.form.value.artist)||void 0===t?void 0:t.id,type:this.requestType$.value,data:Object.assign(Object.assign({},this.form.value),{passportScanEntryId:null===(e=this.uploadedPassportEntry$.value)||void 0===e?void 0:e.id,socialProfiles:this.socialProfiles$.value})};this.backstage.submitRequest(n).pipe(Object(o.a)(()=>this.loading$.next(!1))).subscribe(t=>{this.router.navigate(["/backstage/requests",t.request.id,"request-submitted"],{replaceUrl:!0})},t=>this.errors$.next(t.errors))}retrieveSocialProfile(t){this.socialAuth.retrieveProfile(t).then(e=>{this.socialProfiles$.next(Object.assign(Object.assign({},this.socialProfiles$.value),{[t]:e}))})}uploadPassportScan(t){this.uploadQueue.start(t,{uri:"uploads/images",httpParams:{diskPrefix:"test",disk:"private"},validator:this.imageValidator}).subscribe(t=>{this.uploadedPassportEntry$.next(t.fileEntry)})}removePassportUpload(){this.uploadedPassportEntry$.next(null)}removeSocialProfile(t){const e=Object.assign({},this.socialProfiles$.value);delete e[t],this.socialProfiles$.next(e)}}return t.\u0275fac=function(e){return new(e||t)(s.Pb(l.a),s.Pb(u.f),s.Pb(b.a),s.Pb(d.a),s.Pb(m.a),s.Pb(p.a),s.Pb(g.a),s.Pb(a.e),s.Pb(a.a))},t.\u0275cmp=s.Jb({type:t,selectors:[["backstage-request-form"]],decls:4,vars:3,consts:[["trans",""],["ngNativeValidate","","class","many-inputs",3,"formGroup","ngSubmit",4,"ngIf"],["ngNativeValidate","",1,"many-inputs",3,"formGroup","ngSubmit"],[4,"ngIf"],["formControlName","image",3,"compact"],["class","input-container",4,"ngIf"],[1,"inline-inputs-container","many-inputs"],[1,"input-container"],["for","backstage-first-name","trans",""],["type","text","id","backstage-first-name","formControlName","first_name","required",""],["class","error",4,"ngIf"],["for","backstage-last-name","trans",""],["type","text","id","backstage-last-name","formControlName","last_name","required",""],["for","backstage-company","trans",""],["type","text","id","backstage-company","formControlName","company"],[1,"speed-up-container"],["trans","",1,"speed-up-title"],[1,"speed-up-buttons"],["type","button","mat-flat-button","","color","accent",1,"twitter-btn","speed-up-button",3,"click"],["svgIcon","twitter",1,"social-icon"],["type","button","mat-flat-button","","color","accent",1,"facebook-btn","speed-up-button",3,"click"],["svgIcon","facebook",1,"social-icon"],["type","button","mat-flat-button","","color","accent",1,"passport-btn","speed-up-button",3,"uploadButton","filesSelected"],["svgIcon","document-scanner",1,"social-icon"],[1,"attached-verifications"],["class","facebook-profile verification",4,"ngFor","ngForOf"],["class","passport-attachment verification",4,"ngIf"],[1,"backstage-action-buttons"],["type","button","routerLink","/backstage/requests","mat-raised-button","","trans","",1,"backstage-action-button"],["type","submit","mat-raised-button","","color","accent","trans","",1,"backstage-action-button",3,"disabled"],["for","backstage-artist","trans",""],["id","backstage-artist","formControlName","artist",3,"listAll"],[1,"error"],["for","backstage-name","trans",""],["type","text","id","backstage-name","formControlName","artist_name","required",""],["for","backstage-role","trans",""],["type","text","id","backstage-role","formControlName","role","required",""],["disabled","","trans","",3,"value"],["value","artist","trans",""],["value","agent","trans",""],["value","composer","trans",""],["value","label","trans",""],["value","manager","trans",""],["value","musician","trans",""],["value","producer","trans",""],["value","publisher","trans",""],["value","songwriter","trans",""],[1,"facebook-profile","verification"],["alt","",1,"verification-img",3,"src"],[1,"verification-details"],["trans","",1,"verification-name"],["target","_blank",1,"verification-url",3,"href"],["type","button","mat-icon-button","",1,"remove-verification",3,"click"],["svgIcon","close"],[1,"passport-attachment","verification"],["svgIcon","document-scanner",1,"verification-img"]],template:function(t,e){1&t&&(s.Vb(0,"h1",0),s.Jc(1,"Tell us about yourself"),s.Ub(),s.Hc(2,et,3,4,"form",1),s.hc(3,"async")),2&t&&(s.Db(2),s.nc("ngIf",s.ic(3,1,e.errors$)))},directives:[f.a,i.o,u.t,u.k,h.a,u.s,u.i,u.c,u.A,v.b,y.a,k.a,i.n,x.a,a.h,v.a,H,u.B,u.w,u.E],pipes:[i.b,i.i,q.a],styles:["[_nghost-%COMP%]{display:block;max-width:800px;margin:auto}h1[_ngcontent-%COMP%]{text-align:center}upload-image-control[_ngcontent-%COMP%]{margin:15px auto;width:160px;height:160px;border-radius:50%}.input-container[_ngcontent-%COMP%]     .fake-input, .input-container[_ngcontent-%COMP%]   input[_ngcontent-%COMP%], .input-container[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{height:55px}.speed-up-container[_ngcontent-%COMP%]{padding:15px 0 30px;border-bottom:1px solid var(--be-divider-lighter)}.speed-up-title[_ngcontent-%COMP%]{font-size:1.5rem;margin-bottom:15px}.speed-up-button[_ngcontent-%COMP%]{margin-right:10px}.facebook-btn[_ngcontent-%COMP%]{background:#3b5998}.twitter-btn[_ngcontent-%COMP%]{background:#1da1f2}.social-icon[_ngcontent-%COMP%]{margin-right:5px}upload-progress-bar[_ngcontent-%COMP%]{position:absolute;bottom:0;width:100%}.attached-verifications[_ngcontent-%COMP%]:not(:empty){position:relative}.attached-verifications[_ngcontent-%COMP%]:not(:empty):not(:empty){margin-top:20px}.verification[_ngcontent-%COMP%]{display:flex;align-items:center;border:1px solid var(--be-divider-default);border-radius:4px;padding:10px;margin-bottom:10px}.verification-details[_ngcontent-%COMP%]{overflow:hidden}.verification-url[_ngcontent-%COMP%]{display:block;overflow:hidden;text-overflow:ellipsis}.verification-img[_ngcontent-%COMP%]{height:35px;width:35px;-o-object-fit:cover;object-fit:cover;flex-shrink:0;margin-right:10px}.verification-name[_ngcontent-%COMP%]{font-size:1.3rem;color:var(--be-secondary-text);text-transform:capitalize}.remove-verification[_ngcontent-%COMP%]{margin-left:auto}"],changeDetection:0}),t})(),it=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=s.Jb({type:t,selectors:[["backstage-request-submitted"]],decls:14,vars:0,consts:[[1,"text-align-center"],["svgIcon","check",1,"check-icon"],["trans",""],[1,"backstage-action-buttons"],["routerLink","/","mat-flat-button","","color","accent","trans","",1,"backstage-action-button"]],template:function(t,e){1&t&&(s.Vb(0,"div",0),s.Qb(1,"mat-icon",1),s.Ub(),s.Vb(2,"h1",2),s.Jc(3,"We've got your request"),s.Ub(),s.Vb(4,"ul"),s.Vb(5,"li"),s.Jc(6,"Our support team will review it and send you an email within 3 days!"),s.Ub(),s.Vb(7,"li"),s.Jc(8,"Don't submit another request until you hear from us."),s.Ub(),s.Vb(9,"li"),s.Jc(10,"If this artist profile is already claimed, ask an admin on your team to invite you."),s.Ub(),s.Ub(),s.Vb(11,"div",3),s.Vb(12,"a",4),s.Jc(13,"Got It"),s.Ub(),s.Ub())},directives:[y.a,f.a,a.h,v.a],styles:["[_nghost-%COMP%]{display:block;margin:auto;max-width:800px}.check-icon[_ngcontent-%COMP%]{width:64px;height:64px;line-height:64px}.check-icon[_ngcontent-%COMP%], h1[_ngcontent-%COMP%]{margin-bottom:25px}h1[_ngcontent-%COMP%]{text-align:center}ul[_ngcontent-%COMP%]{font-size:1.6rem;line-height:28px}.text-align-center[_ngcontent-%COMP%]{text-align:center}.action-buttons[_ngcontent-%COMP%]{margin-top:70px}.action-buttons[_ngcontent-%COMP%], .backstage-action-buttons[_ngcontent-%COMP%]{justify-content:center}"],changeDetection:0}),t})();function at(t,e){1&t&&(s.Tb(0),s.Jc(1,"Get verified"),s.Sb())}function rt(t,e){1&t&&(s.Tb(0),s.Jc(1,"Become an artist"),s.Sb())}const ot=function(t){return{sitename:t}},ct=function(t){return[t]};let st=(()=>{class t{constructor(t,e){this.settings=t,this.currentUser=e,this.currentUserIsArtist=!1,this.currentUserIsArtist=!!this.currentUser.primaryArtist()}}return t.\u0275fac=function(e){return new(e||t)(s.Pb(b.a),s.Pb(d.a))},t.\u0275cmp=s.Jb({type:t,selectors:[["backstage-type-selector"]],decls:14,vars:8,consts:[["trans","",3,"transValues"],["trans",""],[1,"claim-row"],[1,"claim-col",3,"routerLink"],["trans","",1,"title"],[4,"ngIf"],["src","client/assets/images/backstage/claim-artist.jpg","alt",""],["routerLink","claim-artist",1,"claim-col"],["src","client/assets/images/backstage/claim-label.jpg","alt",""]],template:function(t,e){1&t&&(s.Vb(0,"h1",0),s.Jc(1,"Get Access to :sitename for Artists"),s.Ub(),s.Vb(2,"h2",1),s.Jc(3,"First, select the type of your request."),s.Ub(),s.Vb(4,"div",2),s.Vb(5,"a",3),s.Vb(6,"div",4),s.Hc(7,at,2,0,"ng-container",5),s.Hc(8,rt,2,0,"ng-container",5),s.Ub(),s.Qb(9,"img",6),s.Ub(),s.Vb(10,"a",7),s.Vb(11,"div",4),s.Jc(12,"Claim existing artist"),s.Ub(),s.Qb(13,"img",8),s.Ub(),s.Ub()),2&t&&(s.nc("transValues",s.rc(4,ot,e.settings.get("branding.site_name"))),s.Db(5),s.nc("routerLink",s.rc(6,ct,e.currentUserIsArtist?"verify-artist":"become-artist")),s.Db(2),s.nc("ngIf",e.currentUserIsArtist),s.Db(1),s.nc("ngIf",!e.currentUserIsArtist))},directives:[f.a,a.h,i.o],styles:["[_nghost-%COMP%]{display:block;max-width:800px;margin:auto}.claim-row[_ngcontent-%COMP%]{display:flex;justify-content:space-between;margin-top:25px}.claim-col[_ngcontent-%COMP%]{display:flex;align-items:center;flex-direction:column;border:2px solid var(--be-divider-default);border-radius:10px;width:calc(50% - 30px);padding:35px 25px;transition:box-shadow .2s ease 0s;color:inherit}.claim-col[_ngcontent-%COMP%]:hover{box-shadow:0 7px 9px -4px rgba(0,0,0,.2),0 14px 21px 2px rgba(0,0,0,.14),0 5px 26px 4px rgba(0,0,0,.12);background:var(--be-background)}.claim-col[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:132px;height:132px;border-radius:50%;-o-object-fit:cover;object-fit:cover}.claim-col[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{font-size:1.8rem;font-weight:500;margin-bottom:10px}"],changeDetection:0}),t})();var lt=n("XSk8"),ut=n("snqL"),bt=n("i2dy"),dt=n("oJCZ"),mt=n("wZkO"),pt=n("I3oe"),gt=n("rGro"),ft=n("mrSG"),ht=n("/RwR"),vt=n("2hX1"),yt=n("QGXG"),kt=n("/M5e"),xt=n("twBr"),Pt=n("M7DL"),Ut=n("EAOp"),Ct=n("Um6Z"),Vt=n("Qu3c"),Ot=n("CH4Q"),It=n("zW5C");const Dt=function(t){return{artist:t}};function _t(t,e){if(1&t&&(s.Vb(0,"a",13),s.Jc(1,"New Album"),s.Ub()),2&t){const t=s.gc();s.nc("routerLink",t.urls.createAlbum(t.insideAdmin))("queryParams",s.rc(3,Dt,t.encodedArtist))("disabled",!t.artist)}}function Mt(t,e){1&t&&(s.Vb(0,"p",14),s.Qb(1,"mat-icon",15),s.Vb(2,"span",16),s.Jc(3,"Save artist first to enable album creation."),s.Ub(),s.Ub())}function wt(t,e){if(1&t){const t=s.Wb();s.Vb(0,"button",26),s.cc("click",function(){s.yc(t);const e=s.gc().$implicit;return s.gc().maybeDeleteAlbum(e)}),s.hc(1,"trans"),s.Qb(2,"mat-icon",27),s.Ub()}2&t&&s.nc("matTooltip",s.ic(1,1,"Delete album"))}function Jt(t,e){if(1&t&&(s.Vb(0,"tr"),s.Vb(1,"td"),s.Vb(2,"div",17),s.Qb(3,"media-image",18),s.Vb(4,"span"),s.Jc(5),s.Ub(),s.Ub(),s.Ub(),s.Vb(6,"td",19),s.Jc(7),s.Ub(),s.Vb(8,"td",20),s.Jc(9),s.Ub(),s.Vb(10,"td",21),s.Jc(11),s.Ub(),s.Vb(12,"td",22),s.Vb(13,"a",23),s.hc(14,"trans"),s.Qb(15,"mat-icon",24),s.Ub(),s.Hc(16,wt,3,3,"button",25),s.Ub(),s.Ub()),2&t){const t=e.$implicit,n=s.gc();s.Db(3),s.nc("media",t),s.Db(2),s.Kc(t.name),s.Db(2),s.Kc(t.release_date?t.release_date:"\u2013"),s.Db(2),s.Kc(t.views),s.Db(2),s.Kc(t.tracks_count?t.tracks_count:"\u2013"),s.Db(2),s.nc("routerLink",n.urls.editAlbum(t,n.insideAdmin))("queryParams",s.rc(11,Dt,n.encodedArtist))("matTooltip",s.ic(14,9,"Edit album")),s.Db(3),s.nc("ngIf",n.currentUser.hasPermission("albums.delete"))}}function At(t,e){1&t&&(s.Vb(0,"no-results-message",28),s.Vb(1,"span",29),s.Jc(2,"This artist has no albums yet"),s.Ub(),s.Ub())}let Ft=(()=>{class t{constructor(t,e,n,i,a,r,o){this.modal=t,this.albumsApi=e,this.currentUser=n,this.images=i,this.datatable=a,this.urls=r,this.router=o,this.albums=[],this.albums$=this.datatable.data$}ngOnChanges(t){this.artist&&(this.encodedArtist=btoa(JSON.stringify({id:this.artist.id,name:this.artist.name,image_small:this.artist.image_small})))}ngOnInit(){this.insideAdmin=this.router.url.includes("admin"),this.datatable.init({initialData:this.albums?this.albums:[]})}maybeDeleteAlbum(t){this.modal.show(ht.a,{title:"Delete Album",body:"Are you sure you want to delete this album?",ok:"Delete"}).beforeClosed().subscribe(e=>Object(ft.a)(this,void 0,void 0,function*(){e&&this.albumsApi.delete([t.id]).subscribe(()=>{this.datatable.data=this.datatable.data.filter(e=>e.id!==t.id)})}))}}return t.\u0275fac=function(e){return new(e||t)(s.Pb(yt.a),s.Pb(kt.a),s.Pb(xt.a),s.Pb(Pt.a),s.Pb(vt.a),s.Pb(dt.a),s.Pb(a.e))},t.\u0275cmp=s.Jb({type:t,selectors:[["artist-albums-table"]],inputs:{artist:"artist",albums:"albums"},features:[s.Cb([vt.a]),s.Bb],decls:22,vars:6,consts:[[1,"datatable"],["pluralResourceName","albums"],["leftContent",""],[1,"new-album-container"],["mat-raised-button","","color","accent","trans","",3,"routerLink","queryParams","disabled",4,"ngIf"],["class","save-message",4,"ngIf"],[1,"material-table"],["table-sort-header","name","trans",""],["table-sort-header","","trans",""],["table-sort-header","views","trans",""],["table-sort-header","tracks_count","trans",""],[4,"ngFor","ngForOf"],["svgImage","music.svg",4,"ngIf"],["mat-raised-button","","color","accent","trans","",3,"routerLink","queryParams","disabled"],[1,"save-message"],["svgIcon","warning"],["trans",""],[1,"column-with-image"],["default","album",3,"media"],["data-label","Release Date"],["data-label","Views"],["data-label","Number of Tracks"],[1,"edit-column"],["mat-icon-button","",3,"routerLink","queryParams","matTooltip"],["svgIcon","edit"],["mat-icon-button","","trans","",3,"matTooltip","click",4,"ngIf"],["mat-icon-button","","trans","",3,"matTooltip","click"],["svgIcon","delete"],["svgImage","music.svg"],["primary-text","","trans",""]],template:function(t,e){1&t&&(s.Vb(0,"div",0),s.Vb(1,"datatable-header",1),s.Tb(2,2),s.Vb(3,"div",3),s.Hc(4,_t,2,5,"a",4),s.Hc(5,Mt,4,0,"p",5),s.Ub(),s.Sb(),s.Ub(),s.Vb(6,"table",6),s.Vb(7,"thead"),s.Vb(8,"tr"),s.Vb(9,"th",7),s.Jc(10,"Album"),s.Ub(),s.Vb(11,"th",8),s.Jc(12,"Release Date"),s.Ub(),s.Vb(13,"th",9),s.Jc(14,"Views"),s.Ub(),s.Vb(15,"th",10),s.Jc(16,"Number Of Tracks"),s.Ub(),s.Qb(17,"th"),s.Ub(),s.Ub(),s.Vb(18,"tbody"),s.Hc(19,Jt,17,13,"tr",11),s.hc(20,"async"),s.Ub(),s.Ub(),s.Hc(21,At,3,0,"no-results-message",12),s.Ub()),2&t&&(s.Db(4),s.nc("ngIf",e.currentUser.hasPermission("music.create")),s.Db(1),s.nc("ngIf",!e.artist),s.Db(14),s.nc("ngForOf",s.ic(20,4,e.albums$)),s.Db(2),s.nc("ngIf",!e.datatable.data.length))},directives:[Ut.a,i.o,Ct.a,f.a,i.n,v.a,a.h,y.a,w.a,Vt.a,v.b,Ot.a],pipes:[i.b,It.a],styles:["artist-albums-table{display:block}artist-albums-table .new-album-container{display:flex;align-items:center}artist-albums-table .no-results-message{margin-top:35px}artist-albums-table .save-message{color:var(--be-secondary-text);font-size:1.3rem;margin-left:25px}artist-albums-table .save-message .mat-icon{vertical-align:middle;margin-right:5px;width:18px;height:18px;line-height:18px}"],encapsulation:2}),t})();var Qt=n("1jcm");function $t(t,e){1&t&&(s.Vb(0,"button",28),s.Jc(1,"Update"),s.Ub())}function Tt(t,e){1&t&&(s.Vb(0,"button",28),s.Jc(1,"Create"),s.Ub())}function St(t,e){if(1&t&&(s.Vb(0,"div",29),s.Jc(1),s.Ub()),2&t){const t=s.gc();s.Db(1),s.Kc(t.errors.name)}}function Ht(t,e){if(1&t&&(s.Vb(0,"div",29),s.Jc(1),s.Ub()),2&t){const t=s.gc();s.Db(1),s.Kc(t.errors.genres)}}function qt(t,e){1&t&&(s.Vb(0,"div",9),s.Vb(1,"label",33),s.Jc(2,"Spotify ID"),s.Ub(),s.Qb(3,"input",34),s.Ub())}function jt(t,e){if(1&t&&(s.Vb(0,"div",29),s.Jc(1),s.Ub()),2&t){const t=s.gc(2);s.Db(1),s.Kc(t.errors.verified)}}function zt(t,e){if(1&t&&(s.Tb(0),s.Hc(1,qt,4,0,"div",30),s.Vb(2,"div",31),s.Vb(3,"mat-slide-toggle",32),s.Jc(4,"Verified"),s.Ub(),s.Hc(5,jt,2,1,"div",12),s.Ub(),s.Sb()),2&t){const t=s.gc();s.Db(1),s.nc("ngIf",t.settings.get("spotify_is_setup")),s.Db(4),s.nc("ngIf",t.errors.verified)}}const Et=function(){return{diskPrefix:"bio"}},Nt=function(t){return{httpParams:t}};function Lt(t,e){if(1&t){const t=s.Wb();s.Vb(0,"upload-image-control",35),s.cc("fileDeleted",function(){s.yc(t);const n=e.index;return s.gc().removeProfileImage(n)}),s.Ub()}if(2&t){const t=e.$implicit;s.nc("formControlName",e.index)("uploadConfig",s.rc(4,Nt,s.qc(3,Et)))("buttonText",t.value?"Replace Image":"Upload Image")}}let Bt=(()=>{class t{constructor(t,e,n,i,a,r,o,c,s,l){this.settings=t,this.uploadQueue=e,this.artists=n,this.route=i,this.toast=a,this.router=r,this.fb=o,this.cd=c,this.search=s,this.urls=l,this.insideAdmin=!1,this.errors={},this.albums=[],this.form=this.fb.group({name:[""],verified:[""],image_small:[""],spotify_id:[""],genres:[[]],description:[""],country:[""],city:[""],profile_images:this.fb.array([]),links:[[]]}),this.suggestGenreFn=t=>this.search.media(t,{types:[lt.a],limit:5}).pipe(Object(I.a)(t=>t.results.genres.map(t=>t.name)))}ngOnInit(){this.bindToRouteData(),this.insideAdmin=this.router.url.includes("admin")}createOrUpdate(){this.artist?this.update():this.create()}create(){return this.artists.create(this.form.value).subscribe(t=>{this.form.markAsPristine(),this.artist=t.artist,this.toast.open("Artist created."),this.router.navigate(this.urls.editArtist(this.artist.id,!0),{replaceUrl:!0}),this.errors={}},t=>{this.errors=t.errors,this.cd.detectChanges()})}update(){return this.artists.update(this.artist.id,this.form.value).subscribe(()=>{this.form.markAsPristine(),this.toast.open("Artist updated."),this.router.navigate(["/admin/artists"])},t=>{this.errors=t.errors,this.cd.detectChanges()})}profileImagesArray(){return this.form.get("profile_images")}bindToRouteData(){this.route.data.subscribe(t=>{var e,n,i;t.api&&(this.artist=t.api.artist,this.albums=t.api.albums,this.form.patchValue({name:t.api.artist.name,verified:t.api.artist.verified,image_small:t.api.artist.image_small,spotify_id:t.api.artist.spotify_id,genres:(t.api.artist.genres||[]).map(t=>t.name),description:null===(e=t.api.artist.profile)||void 0===e?void 0:e.description,country:null===(n=t.api.artist.profile)||void 0===n?void 0:n.country,city:null===(i=t.api.artist.profile)||void 0===i?void 0:i.city,profile_images:[],links:t.api.artist.links}),(t.api.artist.profile_images||[]).forEach(t=>{this.addProfileImage(t.url)}))}),this.addProfileImage()}addProfileImage(t=""){this.profileImagesArray().push(new u.g(t))}removeProfileImage(t){this.profileImagesArray().removeAt(t)}canDeactivate(){return!this.form.dirty}}return t.\u0275fac=function(e){return new(e||t)(s.Pb(b.a),s.Pb(p.a),s.Pb(ut.a),s.Pb(a.a),s.Pb(bt.b),s.Pb(a.e),s.Pb(u.f),s.Pb(s.h),s.Pb(D.a),s.Pb(dt.a))},t.\u0275cmp=s.Jb({type:t,selectors:[["crupdate-artist-page"]],features:[s.Cb([p.a])],decls:46,vars:20,consts:[[1,"material-panel"],["ngNativeValidate","",1,"edit-main-info",3,"formGroup","ngSubmit"],[1,"left-col"],["formControlName","image_small","diskPrefix","artist"],["type","submit","mat-raised-button","","color","accent","class","main-button","trans","",4,"ngIf"],[1,"right-col","many-inputs","admin-artist-edit-inputs"],["color","accent","animationDuration","0ms"],[3,"label"],[1,"many-inputs","tab"],[1,"input-container"],["for","artist-name","trans",""],["type","text","formControlName","name","id","artist-name","required","",3,"readOnly"],["class","error",4,"ngIf"],["for","artist-genres","trans",""],["placeholder","+Add genre","id","artist-genres","formControlName","genres",3,"suggestFn"],[4,"ngIf"],["formControlName","links"],["for","artist-country","trans",""],["formControlName","country","id","artist-country"],["for","artist-city","trans",""],["formControlName","city","id","artist-city"],["for","artist-bio","trans",""],["formControlName","description","id","artist-bio","rows","8"],[1,"profile-images"],["trans","",1,"profile-images-title"],["formArrayName","profile_images",1,"profile-images-wrapper"],[3,"formControlName","uploadConfig","buttonText","fileDeleted",4,"ngFor","ngForOf"],[3,"albums","artist"],["type","submit","mat-raised-button","","color","accent","trans","",1,"main-button"],[1,"error"],["class","input-container",4,"ngIf"],[1,"setting-toggle-container"],["formControlName","verified","trans",""],["for","artist-spotify-id","trans",""],["type","text","id","artist-spotify-id","formControlName","spotify_id","minlength","22","maxlength","22"],[3,"formControlName","uploadConfig","buttonText","fileDeleted"]],template:function(t,e){1&t&&(s.Vb(0,"div",0),s.Vb(1,"form",1),s.cc("ngSubmit",function(){return e.createOrUpdate()}),s.Vb(2,"div",2),s.Qb(3,"upload-image-control",3),s.Hc(4,$t,2,0,"button",4),s.Hc(5,Tt,2,0,"button",4),s.Ub(),s.Vb(6,"div",5),s.Vb(7,"mat-tab-group",6),s.Vb(8,"mat-tab",7),s.hc(9,"trans"),s.Vb(10,"div",8),s.Vb(11,"div",9),s.Vb(12,"label",10),s.Jc(13,"Name"),s.Ub(),s.Qb(14,"input",11),s.Hc(15,St,2,1,"div",12),s.Ub(),s.Vb(16,"div",9),s.Vb(17,"label",13),s.Jc(18,"Genres"),s.Ub(),s.Qb(19,"chip-input",14),s.Hc(20,Ht,2,1,"div",12),s.Ub(),s.Hc(21,zt,6,2,"ng-container",15),s.Ub(),s.Ub(),s.Vb(22,"mat-tab",7),s.hc(23,"trans"),s.Qb(24,"profile-links-form-control",16),s.Ub(),s.Vb(25,"mat-tab",7),s.hc(26,"trans"),s.Vb(27,"div",8),s.Vb(28,"div",9),s.Vb(29,"label",17),s.Jc(30,"Country"),s.Ub(),s.Qb(31,"input",18),s.Ub(),s.Vb(32,"div",9),s.Vb(33,"label",19),s.Jc(34,"City"),s.Ub(),s.Qb(35,"input",20),s.Ub(),s.Vb(36,"div",9),s.Vb(37,"label",21),s.Jc(38,"Biography"),s.Ub(),s.Qb(39,"textarea",22),s.Ub(),s.Vb(40,"div",23),s.Vb(41,"div",24),s.Jc(42,"Biography Images"),s.Ub(),s.Vb(43,"div",25),s.Hc(44,Lt,1,6,"upload-image-control",26),s.Ub(),s.Ub(),s.Ub(),s.Ub(),s.Ub(),s.Ub(),s.Ub(),s.Qb(45,"artist-albums-table",27),s.Ub()),2&t&&(s.Db(1),s.nc("formGroup",e.form),s.Db(3),s.nc("ngIf",e.artist),s.Db(1),s.nc("ngIf",!e.artist),s.Db(3),s.nc("label",s.ic(9,14,"Details")),s.Db(6),s.nc("readOnly",!e.insideAdmin),s.Db(1),s.nc("ngIf",e.errors.name),s.Db(4),s.nc("suggestFn",e.suggestGenreFn),s.Db(1),s.nc("ngIf",e.errors.genres),s.Db(1),s.nc("ngIf",e.insideAdmin),s.Db(1),s.nc("label",s.ic(23,16,"Links")),s.Db(3),s.nc("label",s.ic(26,18,"Biography")),s.Db(19),s.nc("ngForOf",e.profileImagesArray().controls),s.Db(1),s.nc("albums",e.albums)("artist",e.artist))},directives:[u.t,u.k,h.a,u.s,u.i,i.o,mt.b,mt.a,f.a,u.c,u.A,pt.a,gt.a,u.e,i.n,Ft,v.b,Qt.a,u.o,u.n],pipes:[It.a],styles:[".edit-main-info[_ngcontent-%COMP%]{display:flex}.edit-main-info[_ngcontent-%COMP%]   .left-col[_ngcontent-%COMP%]{width:220px;flex-shrink:0;margin-right:25px}.edit-main-info[_ngcontent-%COMP%]   .left-col[_ngcontent-%COMP%]   .main-button[_ngcontent-%COMP%]{display:block;margin-top:8px;width:100%;line-height:42px}.edit-main-info[_ngcontent-%COMP%]   .left-col[_ngcontent-%COMP%]   .main-button[_ngcontent-%COMP%]   .mat-icon[_ngcontent-%COMP%]{display:inline-block;vertical-align:middle}.edit-main-info[_ngcontent-%COMP%]   .right-col[_ngcontent-%COMP%]{flex:1 1 auto;min-width:0}@media only screen and (max-width:768px){.edit-main-info[_ngcontent-%COMP%]{display:block}.edit-main-info[_ngcontent-%COMP%]   .left-col[_ngcontent-%COMP%]{max-width:220px;margin:auto auto 25px}}.profile-images[_ngcontent-%COMP%], .tab[_ngcontent-%COMP%]{padding-top:20px}.profile-images[_ngcontent-%COMP%]{margin-top:30px;border-top:1px solid var(--be-divider-lighter)}.profile-images-title[_ngcontent-%COMP%]{font-size:1.5rem;margin-bottom:10px}.profile-images-wrapper[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap}.profile-images-wrapper[_ngcontent-%COMP%]   upload-image-control[_ngcontent-%COMP%]{margin:0 15px 15px 0}artist-albums-table[_ngcontent-%COMP%]{padding-top:35px;margin-top:35px;border-top:1px solid var(--be-divider-lighter)}"],changeDetection:0}),t})();var Kt=n("5+tZ"),Gt=n("EY2u");let Rt=(()=>{class t{constructor(t,e){this.artists=t,this.router=e}resolve(t,e){const n=+t.paramMap.get("id");return this.artists.get(n,{with:["simplifiedAlbums","genres","profile"],albumsPerPage:50,forEditing:!0}).pipe(Object(O.a)(()=>(this.router.navigate(["/"]),Gt.a)),Object(Kt.a)(t=>t.artist?Object(P.a)(t):(this.router.navigate(["/"]),Gt.a)))}}return t.\u0275fac=function(e){return new(e||t)(s.Zb(ut.a),s.Zb(a.e))},t.\u0275prov=s.Lb({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();var Wt=n("5+WD"),Zt=n("oSJP"),Yt=n("7EHt"),Xt=n("Lm4C"),te=n("QeDF"),ee=n("XFMS"),ne=n("oJgS"),ie=n("/Sbb"),ae=n("IAz0"),re=n("sJvS"),oe=n("tU2R"),ce=n("PCqb"),se=n("JWVf");let le=(()=>{class t extends re.a{constructor(){super(...arguments),this.DEFAULT_MAX_SIZE_MB=50,this.showToast=!0}initValidations(){const t=[new oe.a({maxSize:this.getMaxFileSize()},this.i18n),new se.a({types:["audio","video"]},this.i18n)];this.validations.push(...t)}getMaxFileSize(){return this.settings.get("uploads.max_size",Object(ce.a)(this.DEFAULT_MAX_SIZE_MB,"MB"))}}return t.\u0275fac=function(e){return ue(e||t)},t.\u0275prov=s.Lb({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();const ue=s.Xb(le);var be=n("Se92"),de=n("xgIS"),me=n("IzEk"),pe=n("/1cH"),ge=n("A5z7"),fe=n("FKr1");const he=["searchInput"];function ve(t,e){if(1&t){const t=s.Wb();s.Vb(0,"mat-chip",10),s.cc("removed",function(){s.yc(t);const n=e.$implicit;return s.gc().deselectArtist(n)}),s.Qb(1,"img",11),s.Jc(2),s.Qb(3,"mat-icon",12),s.Ub()}if(2&t){const t=e.$implicit;s.nc("removable",!0),s.Db(1),s.nc("src",t.image_small,s.Bc)("alt",t.name),s.Db(1),s.Lc(" ",t.name," ")}}function ye(t,e){if(1&t&&(s.Vb(0,"mat-option",13),s.Qb(1,"img",11),s.Vb(2,"span"),s.Jc(3),s.Ub(),s.Ub()),2&t){const t=e.$implicit;s.nc("value",t),s.Db(1),s.nc("src",t.image_small,s.Bc)("alt",t.name+" image"),s.Db(2),s.Kc(t.name)}}function ke(t,e){if(1&t&&(s.Vb(0,"div",14),s.Jc(1),s.Ub()),2&t){const t=s.gc();s.Db(1),s.Kc(t.error)}}let xe=(()=>{class t{constructor(t,e){this.search=t,this.currentUser=e,this.searchControl=new u.g,this.value$=new r.a([]),this.searchResults$=new r.a([])}ngOnInit(){this.bindSearchControl()}ngAfterViewInit(){Object(de.a)(this.searchInput.nativeElement,"focus").pipe(Object(me.a)(1)).subscribe(()=>{this.findMatches()})}writeValue(t){this.value$.next(t)}registerOnChange(t){this.propagateChange=t}registerOnTouched(){}deselectArtist(t){const e=this.value$.value.filter(e=>e.id!==t.id);this.value$.next(e),this.propagateChange(this.value$.value)}selectArtist(t){-1===this.value$.value.findIndex(e=>e.id===t.id)&&(this.value$.next([...this.value$.value,t]),this.propagateChange(this.value$.value)),this.searchInput.nativeElement.blur()}bindSearchControl(){this.searchControl.valueChanges.pipe(Object(C.a)(),Object(U.a)(250)).subscribe(t=>{if("string"!=typeof t)return Object(P.a)([]);this.findMatches(t)})}findMatches(t){this.search.suggestArtists({query:t,limit:7}).subscribe(t=>this.searchResults$.next(t.artists))}displayFn(t){return null}}return t.\u0275fac=function(e){return new(e||t)(s.Pb(D.a),s.Pb(xt.a))},t.\u0275cmp=s.Jb({type:t,selectors:[["track-artist-control"]],viewQuery:function(t,e){if(1&t&&s.Pc(he,1),2&t){let t;s.uc(t=s.dc())&&(e.searchInput=t.first)}},hostAttrs:[1,"custom-control"],inputs:{error:"error",id:"id"},features:[s.Cb([p.a,{provide:u.q,useExisting:t,multi:!0}])],decls:13,vars:13,consts:[[1,"input-container"],["trans","",3,"for"],["type","text","placeholder","Search artists...","trans-placeholder","",3,"id","formControl","matAutocomplete"],["searchInput",""],[3,"selectable"],["class","chip-with-image",3,"removable","removed",4,"ngFor","ngForOf"],[1,"media-autocomplete-panel",3,"displayWith","optionSelected"],["artistAuto","matAutocomplete"],[3,"value",4,"ngFor","ngForOf"],["class","error",4,"ngIf"],[1,"chip-with-image",3,"removable","removed"],[3,"src","alt"],["svgIcon","cancel","matChipRemove",""],[3,"value"],[1,"error"]],template:function(t,e){if(1&t&&(s.Vb(0,"div",0),s.Vb(1,"label",1),s.Jc(2,"Artists"),s.Ub(),s.Qb(3,"input",2,3),s.Vb(5,"mat-chip-list",4),s.Hc(6,ve,4,4,"mat-chip",5),s.hc(7,"async"),s.Ub(),s.Vb(8,"mat-autocomplete",6,7),s.cc("optionSelected",function(t){return e.selectArtist(t.option.value)}),s.Hc(10,ye,4,4,"mat-option",8),s.hc(11,"async"),s.Ub(),s.Hc(12,ke,2,1,"div",9),s.Ub()),2&t){const t=s.vc(9);s.Db(1),s.nc("for",e.id),s.Db(2),s.nc("id",e.id)("formControl",e.searchControl)("matAutocomplete",t),s.Db(2),s.nc("selectable",!1),s.Db(1),s.nc("ngForOf",s.ic(7,9,e.value$)),s.Db(2),s.nc("displayWith",e.displayFn),s.Db(2),s.nc("ngForOf",s.ic(11,11,e.searchResults$)),s.Db(2),s.nc("ngIf",e.error)}},directives:[f.a,u.c,pe.c,u.s,u.h,ge.c,i.n,pe.a,i.o,ge.a,y.a,ge.d,fe.l],pipes:[i.b],styles:["[_nghost-%COMP%]{display:block}.mat-chip-list[_ngcontent-%COMP%]{display:block;margin-top:15px}.mat-standard-chip.chip-with-image[_ngcontent-%COMP%]{padding-left:0}.mat-standard-chip.chip-with-image[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:32px;height:32px;-o-object-fit:cover;object-fit:cover;border-radius:16px;margin-right:8px}"],changeDetection:0}),t})();var Pe=n("gcYM"),Ue=n("eNwd"),Ce=n("bv9b");function Ve(t,e){if(1&t&&(s.Vb(0,"div",7),s.Jc(1),s.Vb(2,"span",8),s.Jc(3,"left"),s.Ub(),s.Ub()),2&t){const t=s.gc();s.Db(1),s.Lc(" ",t.progress.eta," ")}}function Oe(t,e){1&t&&(s.Qb(0,"mat-icon",9),s.hc(1,"trans")),2&t&&s.nc("matTooltip",s.ic(1,1,e.ngIf))}function Ie(t,e){1&t&&(s.Vb(0,"span",8),s.Jc(1,"Upload complete."),s.Ub())}function De(t,e){1&t&&(s.Vb(0,"span",8),s.Jc(1,"We are processing your track for playback\u2026"),s.Ub())}function _e(t,e){if(1&t){const t=s.Wb();s.Vb(0,"span",12),s.cc("click",function(){return s.yc(t),s.gc(2).upload.cancel()}),s.Jc(1,"Cancel"),s.Ub()}}function Me(t,e){if(1&t&&(s.Hc(0,Ie,2,0,"span",10),s.Hc(1,De,2,0,"span",10),s.hc(2,"async"),s.Hc(3,_e,2,0,"span",11),s.hc(4,"async")),2&t){const t=s.gc();s.nc("ngIf",t.upload.completed),s.Db(1),s.nc("ngIf",s.ic(2,3,t.upload.processing$)),s.Db(2),s.nc("ngIf",!s.ic(4,5,t.upload.processing$)&&!t.upload.completed)}}let we=(()=>{class t{constructor(t){this.cd=t}ngOnChanges(){this.subscription&&this.subscription.unsubscribe(),this.subscription=this.upload.progress$.pipe(Object(Pe.a)(260,Ue.a,{leading:!0,trailing:!0})).subscribe(t=>{this.progress=t,this.cd.detectChanges()})}ngOnDestroy(){this.subscription.unsubscribe()}}return t.\u0275fac=function(e){return new(e||t)(s.Pb(s.h))},t.\u0275cmp=s.Jb({type:t,selectors:[["track-upload-header"]],inputs:{upload:"upload"},features:[s.Bb],decls:11,vars:10,consts:[[1,"meta"],[1,"name"],["class","time-left",4,"ngIf"],[1,"actions"],["class","error-icon action-icon","svgIcon","error-outline","matTooltipPosition","left",3,"matTooltip",4,"ngIf","ngIfElse"],["noError",""],["color","accent",3,"mode","value"],[1,"time-left"],["trans",""],["svgIcon","error-outline","matTooltipPosition","left",1,"error-icon","action-icon",3,"matTooltip"],["trans","",4,"ngIf"],["class","cancel-button","trans","",3,"click",4,"ngIf"],["trans","",1,"cancel-button",3,"click"]],template:function(t,e){if(1&t&&(s.Vb(0,"div",0),s.Vb(1,"div",1),s.Jc(2),s.Ub(),s.Hc(3,Ve,4,1,"div",2),s.Vb(4,"div",3),s.Hc(5,Oe,2,3,"mat-icon",4),s.hc(6,"async"),s.Hc(7,Me,5,7,"ng-template",null,5,s.Ic),s.Ub(),s.Ub(),s.Qb(9,"mat-progress-bar",6),s.hc(10,"async")),2&t){const t=s.vc(8);s.Db(2),s.Kc(e.upload.uploadedFile.name),s.Db(1),s.nc("ngIf",e.progress.percentage&&e.progress.percentage<100&&!e.upload.error$.value),s.Db(2),s.nc("ngIf",s.ic(6,6,e.upload.error$))("ngIfElse",t),s.Db(4),s.nc("mode",s.ic(10,8,e.upload.processing$)?"indeterminate":"determinate")("value",e.progress.percentage)}},directives:[i.o,Ce.a,f.a,y.a,Vt.a],pipes:[i.b,It.a],styles:["[_nghost-%COMP%]{display:block;color:var(--be-secondary-text);font-size:1.3rem}.meta[_ngcontent-%COMP%]{display:flex;align-items:center;margin-bottom:5px}.name[_ngcontent-%COMP%]{overflow:hidden;text-overflow:ellipsis}.name[_ngcontent-%COMP%], .time-left[_ngcontent-%COMP%]{white-space:nowrap}.actions[_ngcontent-%COMP%], .time-left[_ngcontent-%COMP%]{padding-left:20px}.actions[_ngcontent-%COMP%]{margin-left:auto}.action-icon[_ngcontent-%COMP%]{vertical-align:middle;width:22px;height:22px;margin-bottom:4px}.completed-icon[_ngcontent-%COMP%]{color:#43a047}.error-icon[_ngcontent-%COMP%]{color:#f44336}.cancel-button[_ngcontent-%COMP%]{color:var(--be-link);cursor:pointer;font-size:1.2rem;text-transform:uppercase;line-height:22px}.cancel-button[_ngcontent-%COMP%]:hover{text-decoration:underline}"],changeDetection:0}),t})();var Je=n("TCaE");const Ae=["searchInput"],Fe=["fakeInput"];function Qe(t,e){if(1&t&&(s.Tb(0),s.Qb(1,"media-image",23),s.Vb(2,"div",24),s.Jc(3),s.Ub(),s.Sb()),2&t){const t=e.ngIf;s.Db(1),s.nc("media",t),s.Db(2),s.Kc(t.name)}}function $e(t,e){1&t&&(s.Vb(0,"div",25),s.Jc(1,"None"),s.Ub())}function Te(t,e){if(1&t){const t=s.Wb();s.Vb(0,"button",26),s.cc("click",function(){return s.yc(t),s.gc().clearSearchInput()}),s.Qb(1,"mat-icon",27),s.Ub()}}function Se(t,e){if(1&t){const t=s.Wb();s.Vb(0,"button",17),s.cc("click",function(){s.yc(t);const n=e.$implicit;return s.gc().selectAlbum(n)}),s.Qb(1,"media-image",23),s.Vb(2,"div",28),s.Vb(3,"div",29),s.Jc(4),s.Ub(),s.Qb(5,"artists-links-list",30),s.Ub(),s.Ub()}if(2&t){const t=e.$implicit;s.Db(1),s.nc("media",t),s.Db(3),s.Kc(t.name),s.Db(1),s.nc("artists",t.artists)}}function He(t,e){1&t&&(s.Vb(0,"button",31),s.Jc(1,"No albums found."),s.Ub())}let qe=(()=>{class t{constructor(t,e){this.search=t,this.currentUser=e,this.searchFormControl=new u.g,this.loading$=new r.a(!1),this.results$=new r.a([]),this.selectedAlbum$=new r.a(null),this.searchedOnce=!1}ngOnInit(){this.bindToSearchControl()}writeValue(t){this.selectedAlbum$.next(t)}registerOnChange(t){this.propagateChange=t}registerOnTouched(){}bindToSearchControl(){this.searchFormControl.valueChanges.pipe(Object(U.a)(150),Object(C.a)(),Object(V.a)(t=>this.searchAlbums(t)),Object(O.a)(()=>Object(P.a)([]))).subscribe(t=>{this.searchedOnce=!0,this.results$.next(t)})}searchAlbums(t){return this.loading$.next(!0),this.search.suggestAlbums({query:t,limit:7}).pipe(Object(o.a)(()=>this.loading$.next(!1)),Object(I.a)(t=>t.albums))}onMenuOpened(){document.querySelector(".add-album-control-menu").style.width=this.fakeInput.nativeElement.getBoundingClientRect().width+"px",this.searchedOnce||this.clearSearchInput()}selectAlbum(t){this.selectedAlbum$.next(t),this.propagateChange(t)}clearSearchInput(){this.searchFormControl.setValue("")}onMenuClosed(){this.loading$.next(!1),this.clearSearchInput()}}return t.\u0275fac=function(e){return new(e||t)(s.Pb(D.a),s.Pb(xt.a))},t.\u0275cmp=s.Jb({type:t,selectors:[["album-control"]],viewQuery:function(t,e){if(1&t&&(s.Pc(Ae,3),s.Pc(Fe,1)),2&t){let t;s.uc(t=s.dc())&&(e.searchInput=t.first),s.uc(t=s.dc())&&(e.fakeInput=t.first)}},features:[s.Cb([{provide:u.q,useExisting:t,multi:!0}])],decls:30,vars:16,consts:[[1,"many-inputs"],[1,"input-container"],["trans","",1,"fake-label"],["tabindex","0",1,"fake-input",3,"matMenuTriggerFor","menuOpened","menuClosed"],["fakeInput",""],[4,"ngIf","ngIfElse"],["anyAlbum",""],[1,"arrow-container"],[1,"arrow"],[1,"add-album-control-menu"],["menu","matMenu"],[1,"input-container","search-input-container",3,"click"],[1,"search-input-wrapper"],["type","text","placeholder","Search...","mat-menu-item","","trans-placeholder","",3,"formControl","blur"],["searchInput",""],["class","clear-search-input-button","mat-icon-button","",3,"click",4,"ngIf"],[1,"small",3,"isVisible"],["mat-menu-item","",3,"click"],["default","album"],[1,"info","any-user-info"],["trans","",1,"name"],["mat-menu-item","",3,"click",4,"ngFor","ngForOf"],["mat-menu-item","","disabled","","trans","",4,"ngIf"],[3,"media"],[1,"title-name"],["trans","",1,"title-name"],["mat-icon-button","",1,"clear-search-input-button",3,"click"],["svgIcon","close"],[1,"user-info"],[1,"name"],[1,"email",3,"artists"],["mat-menu-item","","disabled","","trans",""]],template:function(t,e){if(1&t){const t=s.Wb();s.Vb(0,"div",0),s.Vb(1,"div",1),s.Vb(2,"div",2),s.Jc(3,"Album"),s.Ub(),s.Vb(4,"div",3,4),s.cc("menuOpened",function(){return e.onMenuOpened()})("menuClosed",function(){return e.onMenuClosed()}),s.Hc(6,Qe,4,2,"ng-container",5),s.hc(7,"async"),s.Hc(8,$e,2,0,"ng-template",null,6,s.Ic),s.Vb(10,"div",7),s.Qb(11,"div",8),s.Ub(),s.Ub(),s.Ub(),s.Ub(),s.Vb(12,"mat-menu",9,10),s.Vb(14,"div",11),s.cc("click",function(t){return t.stopPropagation()}),s.Vb(15,"div",12),s.Vb(16,"input",13,14),s.cc("blur",function(){return s.yc(t),s.vc(17).focus()}),s.Ub(),s.Hc(18,Te,2,0,"button",15),s.Qb(19,"loading-indicator",16),s.hc(20,"async"),s.Ub(),s.Ub(),s.Vb(21,"button",17),s.cc("click",function(){return e.selectAlbum(null)}),s.Qb(22,"media-image",18),s.Vb(23,"div",19),s.Vb(24,"div",20),s.Jc(25,"No Album"),s.Ub(),s.Ub(),s.Ub(),s.Hc(26,Se,6,3,"button",21),s.hc(27,"async"),s.Hc(28,He,2,0,"button",22),s.hc(29,"async"),s.Ub()}if(2&t){const t=s.vc(9),n=s.vc(13);s.Db(4),s.nc("matMenuTriggerFor",n),s.Db(2),s.nc("ngIf",s.ic(7,8,e.selectedAlbum$))("ngIfElse",t),s.Db(10),s.nc("formControl",e.searchFormControl),s.Db(2),s.nc("ngIf",e.searchFormControl.value),s.Db(1),s.nc("isVisible",s.ic(20,10,e.loading$)),s.Db(7),s.nc("ngForOf",s.ic(27,12,e.results$)),s.Db(2),s.nc("ngIf",e.searchedOnce&&!s.ic(29,14,e.results$).length)}},directives:[f.a,_.c,i.o,_.d,u.c,_.a,u.s,u.h,M.a,w.a,i.n,v.b,y.a,Je.a],pipes:[i.b],styles:["[_nghost-%COMP%]{display:block;min-width:280px;max-width:100%}.fake-input[_ngcontent-%COMP%]{display:flex;align-items:center}.fake-label[_ngcontent-%COMP%]{text-transform:capitalize}.title-name[_ngcontent-%COMP%]{white-space:nowrap;overflow:hidden;text-overflow:ellipsis}media-image[_ngcontent-%COMP%]{display:inline-block;margin-right:8px;width:35px;height:35px;flex-shrink:0;border-radius:4px;vertical-align:middle}.arrow-container[_ngcontent-%COMP%]{flex-shrink:0;padding-left:8px;margin-left:auto}.arrow[_ngcontent-%COMP%]{border-color:#000 transparent transparent;border-style:solid;border-width:5px 4px 0;height:0;width:0}  .mat-menu-panel.add-album-control-menu{max-width:none}.mat-menu-item[_ngcontent-%COMP%]:first-of-type{border-top:1px solid var(--be-divider-default)}.search-input-container[_ngcontent-%COMP%]{padding:2px 10px 10px}.search-input-wrapper[_ngcontent-%COMP%]{position:relative}.clear-search-input-button[_ngcontent-%COMP%]{position:absolute;top:4px;right:0;color:var(--be-secondary-text)}.mat-menu-item[_ngcontent-%COMP%]:not(input){display:flex;vertical-align:middle;height:65px;line-height:65px;align-items:center}.mat-menu-item[_ngcontent-%COMP%]:not(input).selected{background-color:var(--be-accent-emphasis)}.mat-menu-item[_ngcontent-%COMP%]:not(input)   media-image[_ngcontent-%COMP%]{width:45px;height:45px;margin-right:15px;border-radius:50%}.mat-menu-item[_ngcontent-%COMP%]:not(input)   .name[_ngcontent-%COMP%]{text-transform:capitalize;overflow:hidden;text-overflow:ellipsis}.mat-menu-item[_ngcontent-%COMP%]:not(input)   .email[_ngcontent-%COMP%]{color:var(--be-secondary-text);font-size:1.3rem;overflow:hidden;text-overflow:ellipsis}.user-info[_ngcontent-%COMP%]{line-height:normal}.any-user-info[_ngcontent-%COMP%]{line-height:35px}loading-indicator[_ngcontent-%COMP%]{position:absolute;top:12px;right:40px}.disabled[_ngcontent-%COMP%]{pointer-events:none;opacity:.7}"],changeDetection:0}),t})();function je(t,e){if(1&t&&s.Qb(0,"track-upload-header",23),2&t){const t=s.gc(2);s.nc("upload",t.uploadQueueItem)}}function ze(t,e){if(1&t){const t=s.Wb();s.Vb(0,"div",24),s.lc(1),s.Vb(2,"div",14),s.Vb(3,"label",25),s.Jc(4,"Title"),s.Ub(),s.Qb(5,"input",26),s.Ub(),s.Vb(6,"div",27),s.Vb(7,"button",28),s.cc("click",function(){return s.yc(t),s.gc(2).toggleExpandedState()}),s.Qb(8,"mat-icon",29),s.Ub(),s.Vb(9,"button",28),s.cc("click",function(){return s.yc(t),s.gc(2).maybeCancel()}),s.Qb(10,"mat-icon",30),s.Ub(),s.Ub(),s.Ub()}if(2&t){const t=s.gc(2);s.nc("formGroup",t.form),s.Db(3),s.nc("for","track-form-"+t.uniqueId+"-name"),s.Db(2),s.nc("id","track-form-"+t.uniqueId+"-name"),s.Db(2),s.Hb("active",t.expanded)}}function Ee(t,e){1&t&&(s.Vb(0,"span",31),s.Jc(1,"Replace File"),s.Ub())}function Ne(t,e){1&t&&(s.Vb(0,"span",31),s.Jc(1,"Upload Track"),s.Ub())}function Le(t,e){if(1&t&&(s.Vb(0,"div",32),s.Jc(1),s.Ub()),2&t){const t=s.gc(2).ngIf;s.Db(1),s.Kc(t.name)}}function Be(t,e){if(1&t&&(s.Vb(0,"div",14),s.Vb(1,"label",15),s.Jc(2,"Title"),s.Ub(),s.Qb(3,"input",26),s.Hc(4,Le,2,1,"div",17),s.Ub()),2&t){const t=s.gc().ngIf,e=s.gc();s.Db(1),s.nc("for","track-form-"+e.uniqueId+"-name"),s.Db(2),s.nc("id","track-form-"+e.uniqueId+"-name"),s.Db(1),s.nc("ngIf",t.name)}}function Ke(t,e){if(1&t&&s.Qb(0,"album-control",33),2&t){const t=s.gc(2);s.nc("id","track-form-"+t.uniqueId+"-album_id")}}function Ge(t,e){if(1&t&&(s.Vb(0,"div",32),s.Jc(1),s.Ub()),2&t){const t=s.gc().ngIf;s.Db(1),s.Kc(t.duration)}}function Re(t,e){if(1&t&&(s.Vb(0,"div",32),s.Jc(1),s.Ub()),2&t){const t=s.gc(2).ngIf;s.Db(1),s.Kc(t.youtube_id)}}function We(t,e){if(1&t&&(s.Vb(0,"div",14),s.Vb(1,"label",15),s.Jc(2,"Youtube Video ID"),s.Ub(),s.Qb(3,"input",34),s.Hc(4,Re,2,1,"div",17),s.Vb(5,"p"),s.Jc(6,"ID only. https://www.youtube.com/embed?v="),s.Vb(7,"strong"),s.Jc(8,"EPyh41zPg4Z"),s.Ub(),s.Ub(),s.Ub()),2&t){const t=s.gc().ngIf,e=s.gc();s.Db(1),s.nc("for","track-form-"+e.uniqueId+"-track-youtube-id"),s.Db(2),s.nc("id","track-form-"+e.uniqueId+"-track-youtube-id"),s.Db(1),s.nc("ngIf",t.youtube_id)}}function Ze(t,e){if(1&t&&(s.Vb(0,"div",32),s.Jc(1),s.Ub()),2&t){const t=s.gc(2).ngIf;s.Db(1),s.Kc(t.url)}}function Ye(t,e){if(1&t&&(s.Vb(0,"div",14),s.Vb(1,"label",15),s.Jc(2,"Track Url"),s.Ub(),s.Qb(3,"input",35),s.Hc(4,Ze,2,1,"div",17),s.Vb(5,"p"),s.Jc(6,"Remote or local url to music or video file for this track. If available, this will always play instead of youtube video."),s.Ub(),s.Ub()),2&t){const t=s.gc().ngIf,e=s.gc();s.Db(1),s.nc("for","track-form-"+e.uniqueId+"-track-url"),s.Db(2),s.nc("id","track-form-"+e.uniqueId+"-track-url"),s.Db(1),s.nc("ngIf",t.url)}}function Xe(t,e){1&t&&(s.Vb(0,"div",14),s.Vb(1,"label",36),s.Jc(2,"Spotify ID"),s.Ub(),s.Qb(3,"input",37),s.Ub())}function tn(t,e){if(1&t&&(s.Vb(0,"div",32),s.Jc(1),s.Ub()),2&t){const t=s.gc().ngIf;s.Db(1),s.Kc(t.genres)}}function en(t,e){if(1&t&&(s.Vb(0,"div",32),s.Jc(1),s.Ub()),2&t){const t=s.gc().ngIf;s.Db(1),s.Kc(t.tags)}}function nn(t,e){if(1&t&&(s.Vb(0,"button",38),s.hc(1,"async"),s.Jc(2,"Save"),s.Ub()),2&t){const t=s.gc(2);s.nc("disabled",s.ic(1,1,t.loading$)||t.uploadQueueItem&&!t.uploadQueueItem.completed)}}function an(t,e){if(1&t){const t=s.Wb();s.Vb(0,"button",39),s.cc("click",function(){return s.yc(t),s.gc(2).maybeCancel()}),s.Jc(1,"Cancel"),s.Ub()}}function rn(t,e){if(1&t){const t=s.Wb();s.Vb(0,"form",1),s.cc("ngSubmit",function(){return s.yc(t),s.gc().submit()}),s.Hc(1,je,1,1,"track-upload-header",2),s.Hc(2,ze,11,5,"div",3),s.Vb(3,"div",4),s.Vb(4,"div",5),s.Vb(5,"div",6),s.Qb(6,"upload-image-control",7),s.hc(7,"async"),s.Vb(8,"button",8),s.cc("click",function(){return s.yc(t),s.gc().openUploadMusicModal()}),s.Hc(9,Ee,2,0,"span",9),s.Hc(10,Ne,2,0,"span",9),s.Ub(),s.Ub(),s.Vb(11,"div",10),s.Hc(12,Be,5,3,"div",11),s.Hc(13,Ke,1,1,"album-control",12),s.Qb(14,"track-artist-control",13),s.Vb(15,"div",14),s.Vb(16,"label",15),s.Jc(17,"Duration (ms)"),s.Ub(),s.Qb(18,"input",16),s.Hc(19,Ge,2,1,"div",17),s.Ub(),s.Hc(20,We,9,3,"div",11),s.Hc(21,Ye,7,3,"div",11),s.Hc(22,Xe,4,0,"div",11),s.Vb(23,"div",14),s.Vb(24,"label",15),s.Jc(25,"Genres"),s.Ub(),s.Qb(26,"chip-input",18),s.Hc(27,tn,2,1,"div",17),s.Ub(),s.Vb(28,"div",14),s.Vb(29,"label",15),s.Jc(30,"Tags"),s.Ub(),s.Qb(31,"chip-input",19),s.Hc(32,en,2,1,"div",17),s.Ub(),s.Vb(33,"div",14),s.Vb(34,"label",15),s.Jc(35,"Description"),s.Ub(),s.Qb(36,"textarea",20),s.Ub(),s.Hc(37,nn,3,3,"button",21),s.Hc(38,an,2,0,"button",22),s.Ub(),s.Ub(),s.Ub(),s.Ub()}if(2&t){const t=e.ngIf,n=s.gc();s.nc("formGroup",n.form),s.Db(1),s.nc("ngIf",n.uploadQueueItem),s.Db(1),s.nc("ngIf",n.albumForm),s.Db(1),s.nc("@bodyExpansion",n.getExpandedState()),s.Db(1),s.Hb("inside-album",n.albumForm),s.Db(2),s.nc("defaultBackground",s.ic(7,31,n.defaultImage$)),s.Db(3),s.nc("ngIf",n.track),s.Db(1),s.nc("ngIf",!n.track),s.Db(2),s.nc("ngIf",!n.albumForm),s.Db(1),s.nc("ngIf",!n.albumForm),s.Db(1),s.nc("error",t.artists)("id","track-form-"+n.uniqueId+"-artists"),s.Db(2),s.nc("for","track-form-"+n.uniqueId+"-duration"),s.Db(2),s.nc("id","track-form-"+n.uniqueId+"-duration"),s.Db(1),s.nc("ngIf",t.duration),s.Db(1),s.nc("ngIf",n.insideAdmin()),s.Db(1),s.nc("ngIf",n.insideAdmin()),s.Db(1),s.nc("ngIf",n.insideAdmin&&n.settings.get("spotify_is_setup")),s.Db(2),s.nc("for","track-form-"+n.uniqueId+"-track-genres"),s.Db(2),s.nc("id","track-form-"+n.uniqueId+"-track-genres")("suggestFn",n.suggestGenreFn),s.Db(1),s.nc("ngIf",t.genres),s.Db(2),s.nc("for","track-form-"+n.uniqueId+"-track-tags"),s.Db(2),s.nc("id","track-form-"+n.uniqueId+"-track-tags")("suggestFn",n.suggestTagFn),s.Db(1),s.nc("ngIf",t.tags),s.Db(2),s.nc("for","track-form-"+n.uniqueId+"-track-description"),s.Db(2),s.nc("id","track-form-"+n.uniqueId+"-track-description"),s.Db(1),s.nc("ngIf",!n.albumForm),s.Db(1),s.nc("ngIf",!n.albumForm&&!n.track)}}const on=["*"];let cn=(()=>{class t{constructor(t,e,n,i,a,o,c,l,u,b,d,m){this.fb=t,this.currentUser=e,this.tracks=n,this.toast=i,this.modal=a,this.audioValidator=o,this.uploadQueue=c,this.waveGenerator=l,this.router=u,this.settings=b,this.cd=d,this.search=m,this.canceled=new s.n,this.saved=new s.n,this.errors$=new r.a({}),this.defaultImage$=new r.a(Zt.a.album),this.loading$=new r.a(!1),this.uniqueId=Object(ne.a)(5),this.form=this.fb.group({id:[null],name:[""],image:[""],description:[""],number:[1],tags:[[]],genres:[[]],duration:[null],url:[""],youtube_id:[""],spotify_id:[""],spotify_popularity:[""],album:[null],artists:[[]],waveData:[null],lyrics:[""]}),this.expanded=!1,this.suggestTagFn=t=>this.search.media(t,{types:["tag"],limit:5}).pipe(Object(I.a)(t=>t.results.tags.map(t=>t.name))),this.suggestGenreFn=t=>this.search.media(t,{types:[lt.a],limit:5}).pipe(Object(I.a)(t=>t.results.genres.map(t=>t.name)))}ngOnChanges(t){t.number&&null!=t.number.currentValue&&this.form.patchValue({number:t.number.currentValue})}ngOnInit(){if(this.expanded=!this.albumForm,this.track){const t=Object.assign({},this.track);t.tags=(this.track.tags||[]).map(t=>t.name),t.genres=(this.track.genres||[]).map(t=>t.display_name||t.name),this.form.patchValue(t),this.track.album&&this.defaultImage$.next(this.track.album.image||Zt.a.album)}else this.currentUser.canAttachMusicToAnyArtist()||this.form.get("artists").setValue([this.currentUser.get("artists")[0]||this.currentUser.artistPlaceholder()]);this.uploadQueueItem&&this.uploadQueueItem.uploadedResponse$.subscribe(t=>{this.patchFormUsingFileUpload(t)}),this.albumForm&&this.albumForm.get("image").valueChanges.subscribe(t=>{this.defaultImage$.next(t||Zt.a.album)})}getPayload(){const t=this.uploadQueueItem?this.uploadQueueItem.customData:{},e=Object.assign(Object.assign({},this.form.value),t);return e.artists=e.artists.map(t=>"number"!=typeof t?t.id:t),e}isUploading(){return this.uploadQueueItem&&!this.uploadQueueItem.completed}submit(){if(this.albumForm)return;this.loading$.next(!0);const t=this.getPayload();(this.track?this.tracks.update(this.track.id,t):this.tracks.create(t)).pipe(Object(o.a)(()=>this.loading$.next(!1))).subscribe(t=>{this.uploadQueueItem&&this.uploadQueue.remove(this.uploadQueueItem.id),this.toast.open("Track saved."),this.form.markAsPristine(),this.saved.emit(t.track)},t=>{this.errors$.next(t.errors),Object(ie.a)(this.errors$.value,`track-form-${this.uniqueId}`)})}toggleExpandedState(){this.expanded=!this.expanded}getExpandedState(){return this.expanded?"expanded":"collapsed"}maybeCancel(){this.modal.show(ht.a,{title:"Remove Track",body:"Are you sure you want to cancel the upload and remove this track?",ok:"Remove"}).beforeClosed().subscribe(t=>{t&&(this.uploadQueueItem?(this.uploadQueue.remove(this.uploadQueueItem.id),this.canceled.emit(this.uploadQueueItem),this.toast.open("Upload canceled.")):this.track&&this.tracks.delete([this.track.id]).subscribe(()=>{this.canceled.emit(this.track),this.toast.open("Track deleted.")}))})}openUploadMusicModal(){const t={uri:"uploads",validator:this.audioValidator,httpParams:{diskPrefix:"track_media",disk:"public"},willProcessFiles:!0};Object(Xt.a)({types:[te.a.audio,te.a.video]}).then(e=>{e&&(this.uploadQueue.start(this.uploadQueueItem?{[this.uploadQueueItem.id]:e[0]}:e,t).subscribe(t=>{const e=this.uploadQueue.find(t.queueItemId);this.waveGenerator.generate(e.uploadedFile.native).then(t=>{this.form.patchValue({waveData:t}),e.finishProcessing()}),this.patchFormUsingFileUpload(t),this.toast.open("Track uploaded.")},()=>this.toast.open("Could not upload track")),this.uploadQueueItem||(this.uploadQueueItem=this.uploadQueue.uploads$.value[0],this.cd.markForCheck()))})}patchFormUsingFileUpload(t){const e={name:t.metadata.title,duration:t.metadata.duration,url:t.fileEntry.url,genres:t.metadata.genres||[],description:t.metadata.comment,lyrics:t.metadata.lyrics};t.metadata.album&&(e.album=t.metadata.album),t.metadata.artist&&(e.artists=[t.metadata.artist],this.albumForm&&!this.albumForm.value.artist&&this.albumForm.patchValue({artist:t.metadata.artist})),t.metadata.image&&(e.image=t.metadata.image.url,this.albumForm&&!this.albumForm.value.image&&this.albumForm.patchValue({image:t.metadata.image.url})),t.metadata.release_date&&this.albumForm&&!this.albumForm.value.release_date&&this.albumForm.patchValue({release_date:t.metadata.release_date}),this.form.patchValue(e)}insideAdmin(){return this.router.url.indexOf("admin")>-1}shouldShowDurationField(){const t=this.form.get("url").value;return!t||Object(ee.a)(t)}}return t.\u0275fac=function(e){return new(e||t)(s.Pb(u.f),s.Pb(d.a),s.Pb(ae.a),s.Pb(bt.b),s.Pb(yt.a),s.Pb(le),s.Pb(p.a),s.Pb(be.c),s.Pb(a.e),s.Pb(b.a),s.Pb(s.h),s.Pb(D.a))},t.\u0275cmp=s.Jb({type:t,selectors:[["track-form"]],inputs:{track:"track",uploadQueueItem:"uploadQueueItem",albumForm:"albumForm",number:"number"},outputs:{canceled:"canceled",saved:"saved"},features:[s.Bb],ngContentSelectors:on,decls:2,vars:3,consts:[["class","many-inputs",3,"formGroup","ngSubmit",4,"ngIf"],[1,"many-inputs",3,"formGroup","ngSubmit"],[3,"upload",4,"ngIf"],["class","inline-form",3,"formGroup",4,"ngIf"],[1,"full-form"],[1,"full-form-container"],[1,"left-column"],["formControlName","image","diskPrefix","track_image",3,"defaultBackground"],["mat-flat-button","","color","accent","type","button",1,"left-column-action-button",3,"click"],["trans","",4,"ngIf"],[1,"many-inputs","fields-container"],["class","input-container",4,"ngIf"],["formControlName","album",3,"id",4,"ngIf"],["formControlName","artists",3,"error","id"],[1,"input-container"],["trans","",3,"for"],["type","number","formControlName","duration","min","1","required","",3,"id"],["class","error",4,"ngIf"],["placeholder","+Add genre","formControlName","genres",3,"id","suggestFn"],["placeholder","+Add tag","formControlName","tags",3,"id","suggestFn"],["type","text","formControlName","description","minlength","10","maxlength","999","rows","5",3,"id"],["type","submit","mat-raised-button","","color","accent","trans","",3,"disabled",4,"ngIf"],["type","button","mat-button","","trans","",3,"click",4,"ngIf"],[3,"upload"],[1,"inline-form",3,"formGroup"],["trans","",1,"hidden",3,"for"],["type","text","formControlName","name","required","",3,"id"],[1,"actions"],["type","button","mat-icon-button","",3,"click"],["svgIcon","edit"],["svgIcon","delete"],["trans",""],[1,"error"],["formControlName","album",3,"id"],["type","text","formControlName","youtube_id","minlength","1","maxlength","30",3,"id"],["type","url","formControlName","url","minlength","1","maxlength","191",3,"id"],["for","track-spotify-id","trans",""],["type","text","id","track-spotify-id","formControlName","spotify_id","minlength","22","maxlength","22"],["type","submit","mat-raised-button","","color","accent","trans","",3,"disabled"],["type","button","mat-button","","trans","",3,"click"]],template:function(t,e){1&t&&(s.mc(),s.Hc(0,rn,39,33,"form",0),s.hc(1,"async")),2&t&&s.nc("ngIf",s.ic(1,1,e.errors$))},directives:[i.o,u.D,u.t,u.k,h.a,u.s,u.i,v.b,xe,f.a,u.x,u.c,u.A,pt.a,u.o,u.n,we,y.a,qe],pipes:[i.b],styles:["[_nghost-%COMP%]{display:block}.inline-form[_ngcontent-%COMP%]{display:flex}.inline-form[_ngcontent-%COMP%]   .actions[_ngcontent-%COMP%]{flex-shrink:0;color:var(--be-secondary-text);margin-left:20px}.full-form[_ngcontent-%COMP%]{overflow:hidden}.full-form-container[_ngcontent-%COMP%]{display:flex}.full-form-container.inside-album[_ngcontent-%COMP%]{margin:25px 100px 0 60px}.fields-container[_ngcontent-%COMP%]{flex:1 1 auto;margin-left:20px;min-width:0}.cdk-drag-handle[_ngcontent-%COMP%]{flex-shrink:0;color:var(--be-secondary-text);margin-right:20px}.active[_ngcontent-%COMP%]{color:var(--be-accent-default)}track-upload-header[_ngcontent-%COMP%]{margin-bottom:15px}.drag-handle[_ngcontent-%COMP%]{cursor:move}.left-column-action-button[_ngcontent-%COMP%]{margin-top:15px;width:100%;line-height:40px}@media only screen and (max-width:768px){.full-form-container[_ngcontent-%COMP%]{display:block}.left-column[_ngcontent-%COMP%]{max-width:220px;margin:auto auto 25px}.fields-container[_ngcontent-%COMP%]{margin-left:0}}"],data:{animation:[Yt.g.bodyExpansion]},changeDetection:0}),t})();function sn(t,e){if(1&t&&(s.Vb(0,"div",24),s.Jc(1),s.Ub()),2&t){const t=s.gc();s.Db(1),s.Kc(t.errors.name)}}function ln(t,e){if(1&t&&(s.Vb(0,"div",24),s.Jc(1),s.Ub()),2&t){const t=s.gc();s.Db(1),s.Kc(t.errors.release_date)}}function un(t,e){if(1&t&&(s.Vb(0,"div",24),s.Jc(1),s.Ub()),2&t){const t=s.gc();s.Db(1),s.Kc(t.errors.description)}}function bn(t,e){if(1&t&&(s.Vb(0,"div",24),s.Jc(1),s.Ub()),2&t){const t=s.gc();s.Db(1),s.Kc(t.errors.genres)}}function dn(t,e){if(1&t&&(s.Vb(0,"div",24),s.Jc(1),s.Ub()),2&t){const t=s.gc();s.Db(1),s.Kc(t.errors.tags)}}function mn(t,e){1&t&&(s.Vb(0,"div",6),s.Vb(1,"label",25),s.Jc(2,"Spotify ID"),s.Ub(),s.Qb(3,"input",26),s.Ub())}function pn(t,e){if(1&t){const t=s.Wb();s.Vb(0,"track-form",30),s.cc("canceled",function(){s.yc(t);const e=s.gc().$implicit;return s.gc().trackRemoved(e)}),s.Vb(1,"button",31),s.Qb(2,"mat-icon",32),s.Ub(),s.Ub()}if(2&t){const t=s.gc(),e=t.$implicit,n=t.index,i=s.gc();s.nc("albumForm",i.form)("track",e)("number",n+1)}}function gn(t,e){if(1&t){const t=s.Wb();s.Vb(0,"track-form",33),s.cc("canceled",function(){s.yc(t);const e=s.gc().$implicit;return s.gc().trackRemoved(e)}),s.Vb(1,"button",31),s.Qb(2,"mat-icon",32),s.Ub(),s.Ub()}if(2&t){const t=s.gc(),e=t.$implicit,n=t.index,i=s.gc();s.nc("albumForm",i.form)("uploadQueueItem",e)("number",n+1)}}function fn(t,e){if(1&t&&(s.Vb(0,"li",27),s.Hc(1,pn,3,3,"track-form",28),s.Hc(2,gn,3,3,"track-form",29),s.Ub()),2&t){const t=e.$implicit;s.Db(1),s.nc("ngIf",t.model_type),s.Db(1),s.nc("ngIf",!t.model_type)}}const hn=function(){return["music.update"]};let vn=(()=>{class t{constructor(t,e,n,i,a,o,c,l,u,b,d,m){this.fb=t,this.uploadQueue=e,this.albums=n,this.cd=i,this.currentUser=a,this.modal=o,this.toast=c,this.audioValidator=l,this.settings=u,this.search=b,this.router=d,this.waveform=m,this.uploadButtonConfig={multiple:!0,types:[te.a.audio,te.a.video]},this.confirmCancel=!0,this.canceled=new s.n,this.saved=new s.n,this.errors={},this.loading$=new r.a(!1),this.allTracks$=new r.a([]),this.form=this.fb.group({name:[""],image:[""],artists:[[]],release_date:[(new Date).toISOString().slice(0,10)],description:[""],spotify_id:[""],tags:[[]],genres:[[]]}),this.trackByFn=(t,e)=>e.id,this.suggestTagFn=t=>this.search.media(t,{types:["tag"],limit:5}).pipe(Object(I.a)(t=>t.results.tags.map(t=>t.name))),this.suggestGenreFn=t=>this.search.media(t,{types:[lt.a],limit:5}).pipe(Object(I.a)(t=>t.results.genres.map(t=>t.name)))}ngOnInit(){if(this.insideAdmin=this.router.url.includes("admin"),this.allTracks$=new r.a([...this.album?this.album.tracks:[],...this.onlyValidUploads(this.uploadQueue.uploads$.value)]),this.uploadQueue.uploadsAdded$.subscribe(t=>{this.allTracks$.next([...this.allTracks$.value,...this.onlyValidUploads(t)])}),this.album){const t=Object.assign(Object.assign({},this.album),{tags:this.album.tags.map(t=>t.name),genres:this.album.genres.map(t=>t.display_name||t.name)});this.form.patchValue(t)}else this.artist?this.form.get("artists").setValue([this.artist]):this.currentUser.canAttachMusicToAnyArtist()||this.form.get("artists").setValue([this.currentUser.get("artists")[0]||this.currentUser.artistPlaceholder()])}onlyValidUploads(t){return t.filter(t=>!t.error$.value)}reorderTracks(t){const e=this.allTracks$.value;Object(Wt.g)(e,t.previousIndex,t.currentIndex),this.allTracks$.next(e)}submit(){if(this.trackForms.some(t=>t.isUploading()))return void this.toast.open("Some tracks are still uploading or failed to upload.");this.loading$.next(!0);const t=Object.assign(Object.assign({},this.form.value),{tracks:this.trackForms.map(t=>t.getPayload())});t.artists=t.artists.map(t=>"number"!=typeof t?t.id:t),(this.album?this.albums.update(this.album.id,t):this.albums.create(t)).pipe(Object(o.a)(()=>this.loading$.next(!1))).subscribe(t=>{this.form.markAsPristine(),this.trackForms.forEach(t=>t.form.markAsPristine()),this.toast.open("Album saved."),this.uploadQueue.reset(),this.saved.emit(t.album)},t=>{this.errors=t.errors,Object(ie.a)(this.errors,"track-form"),this.cd.markForCheck()})}maybeCancel(){this.confirmCancel?this.modal.show(ht.a,{title:"Delete Album",body:"Are you sure you want to cancel all uploads and delete this album?",ok:"Delete"}).beforeClosed().subscribe(t=>{t&&(this.form.reset(),this.uploadQueue.reset(),this.canceled.emit())}):this.canceled.emit()}uploadFiles(t){this.uploadQueue.start(t,{uri:"uploads",httpParams:{autoMatchAlbum:!1,diskPrefix:"track_media",disk:"public"},validator:this.audioValidator}).subscribe(t=>{const e=this.uploadQueue.find(t.queueItemId),n=this.trackForms.find(e=>{var n;return(null===(n=e.uploadQueueItem)||void 0===n?void 0:n.id)===t.queueItemId}).form;this.waveform.generate(e.uploadedFile.native).then(t=>{n.patchValue({waveData:t}),e.finishProcessing()}),n.markAsDirty()},()=>this.toast.open("Could not upload tracks."))}trackRemoved(t){const e=this.allTracks$.value.filter(e=>e.id!==t.id);this.allTracks$.next(e)}}return t.\u0275fac=function(e){return new(e||t)(s.Pb(u.f),s.Pb(p.a),s.Pb(kt.a),s.Pb(s.h),s.Pb(d.a),s.Pb(yt.a),s.Pb(bt.b),s.Pb(le),s.Pb(b.a),s.Pb(D.a),s.Pb(a.e),s.Pb(be.c))},t.\u0275cmp=s.Jb({type:t,selectors:[["album-form"]],viewQuery:function(t,e){if(1&t&&s.Pc(cn,1),2&t){let t;s.uc(t=s.dc())&&(e.trackForms=t)}},inputs:{album:"album",artist:"artist",confirmCancel:"confirmCancel"},outputs:{canceled:"canceled",saved:"saved"},decls:42,vars:20,consts:[[3,"formGroup","ngSubmit"],[1,"main-info-fields"],[1,"left-column"],["formControlName","image","diskPrefix","album"],["mat-flat-button","","color","accent","type","button","trans","",1,"upload-tracks-button",3,"uploadButton","filesSelected"],[1,"text-fields-container","many-inputs"],[1,"input-container"],["for","album-form-name","trans",""],["type","text","id","album-form-name","formControlName","name","required","",3,"readOnly"],["class","error",4,"ngIf"],["for","album-form-release_date","trans",""],["type","date","placeholder","YYYY-MM-DD","id","album-form-release_date","formControlName","release_date","required",""],["id","album-form-artists","formControlName","artists",3,"error"],["for","album-form-description","trans",""],["type","text","id","album-form-description","formControlName","description","minlength","10","maxlength","250","rows","5"],["for","album-form-genres","trans",""],["placeholder","+Add genre","id","album-form-genres","formControlName","genres",3,"suggestFn"],["for","album-form-tags","trans",""],["placeholder","+Add tag","id","album-form-tags","formControlName","tags",3,"suggestFn"],["class","input-container",4,"ngIf"],["type","submit","mat-raised-button","","color","accent","trans","",3,"disabled"],["type","button","mat-button","","trans","",3,"click"],["cdkDropList","",1,"track-list","unstyled-list",3,"cdkDropListDropped"],["class","track-list-item","cdkDrag","",4,"ngFor","ngForOf","ngForTrackBy"],[1,"error"],["for","album-spotify-id","trans",""],["type","text","id","album-spotify-id","formControlName","spotify_id","minlength","22","maxlength","22"],["cdkDrag","",1,"track-list-item"],[3,"albumForm","track","number","canceled",4,"ngIf"],[3,"albumForm","uploadQueueItem","number","canceled",4,"ngIf"],[3,"albumForm","track","number","canceled"],["mat-icon-button","","cdkDragHandle","","type","button"],["svgIcon","drag-handle"],[3,"albumForm","uploadQueueItem","number","canceled"]],template:function(t,e){1&t&&(s.Vb(0,"form",0),s.cc("ngSubmit",function(){return e.submit()}),s.Vb(1,"div",1),s.Vb(2,"div",2),s.Qb(3,"upload-image-control",3),s.Vb(4,"button",4),s.cc("filesSelected",function(t){return e.uploadFiles(t)}),s.Jc(5,"Upload Tracks"),s.Ub(),s.Ub(),s.Vb(6,"div",5),s.Vb(7,"div",6),s.Vb(8,"label",7),s.Jc(9,"Name"),s.Ub(),s.Qb(10,"input",8),s.Hc(11,sn,2,1,"div",9),s.Ub(),s.Vb(12,"div",6),s.Vb(13,"label",10),s.Jc(14,"Release Date"),s.Ub(),s.Qb(15,"input",11),s.Hc(16,ln,2,1,"div",9),s.Ub(),s.Qb(17,"track-artist-control",12),s.Vb(18,"div",6),s.Vb(19,"label",13),s.Jc(20,"Description"),s.Ub(),s.Qb(21,"textarea",14),s.Hc(22,un,2,1,"div",9),s.Ub(),s.Vb(23,"div",6),s.Vb(24,"label",15),s.Jc(25,"Genres"),s.Ub(),s.Qb(26,"chip-input",16),s.Hc(27,bn,2,1,"div",9),s.Ub(),s.Vb(28,"div",6),s.Vb(29,"label",17),s.Jc(30,"Tags"),s.Ub(),s.Qb(31,"chip-input",18),s.Hc(32,dn,2,1,"div",9),s.Ub(),s.Hc(33,mn,4,0,"div",19),s.Vb(34,"button",20),s.hc(35,"async"),s.Jc(36,"Save"),s.Ub(),s.Vb(37,"button",21),s.cc("click",function(){return e.maybeCancel()}),s.Jc(38,"Cancel"),s.Ub(),s.Ub(),s.Ub(),s.Ub(),s.Vb(39,"ul",22),s.cc("cdkDropListDropped",function(t){return e.reorderTracks(t)}),s.Hc(40,fn,3,2,"li",23),s.hc(41,"async"),s.Ub()),2&t&&(s.nc("formGroup",e.form),s.Db(4),s.nc("uploadButton",e.uploadButtonConfig),s.Db(6),s.nc("readOnly",e.album&&!e.currentUser.hasPermissions(s.qc(19,hn))),s.Db(1),s.nc("ngIf",e.errors.name),s.Db(5),s.nc("ngIf",e.errors.release_date),s.Db(1),s.nc("error",e.errors.artists),s.Db(5),s.nc("ngIf",e.errors.description),s.Db(4),s.nc("suggestFn",e.suggestGenreFn),s.Db(1),s.nc("ngIf",e.errors.genres),s.Db(4),s.nc("suggestFn",e.suggestTagFn),s.Db(1),s.nc("ngIf",e.errors.tags),s.Db(1),s.nc("ngIf",e.insideAdmin&&e.settings.get("spotify_is_setup")),s.Db(1),s.nc("disabled",s.ic(35,15,e.loading$)),s.Db(6),s.nc("ngForOf",s.ic(41,17,e.allTracks$))("ngForTrackBy",e.trackByFn))},directives:[u.D,u.t,u.k,h.a,u.s,u.i,v.b,f.a,k.a,u.c,u.A,i.o,xe,u.o,u.n,pt.a,Wt.d,i.n,Wt.a,cn,Wt.b,y.a],pipes:[i.b],styles:["[_nghost-%COMP%]{display:block;padding:25px}.main-info-fields[_ngcontent-%COMP%]{display:flex}.text-fields-container[_ngcontent-%COMP%]{flex:1 1 auto;margin-left:20px}.track-list[_ngcontent-%COMP%]{margin-top:30px;padding:0 15px}.track-list-item[_ngcontent-%COMP%]:not(.cdk-drag-preview){border-bottom:1px solid var(--be-divider-lighter);padding-bottom:15px;margin-bottom:15px}.upload-tracks-button[_ngcontent-%COMP%]{margin-top:15px;width:100%;line-height:40px}@media only screen and (max-width:768px){[_nghost-%COMP%]{padding:10px}.track-list[_ngcontent-%COMP%]{padding:0}.main-info-fields[_ngcontent-%COMP%]{display:block}.left-column[_ngcontent-%COMP%]{max-width:220px;margin:auto auto 25px}.text-fields-container[_ngcontent-%COMP%]{margin-left:0}}"],changeDetection:0}),t})(),yn=(()=>{class t{constructor(t,e,n,i){this.route=t,this.router=e,this.settings=n,this.urls=i}ngOnInit(){this.route.data.subscribe(t=>{t.api&&(this.album=t.api.album)}),this.route.queryParams.subscribe(t=>{t.artist&&(this.artist=JSON.parse(atob(t.artist)))})}toAlbumsPage(){this.router.url.includes("admin")?this.router.navigate(this.artist?this.urls.editArtist(this.artist.id,!0):["/admin/albums"]):this.router.navigate(["/"])}canDeactivate(){return!this.albumForm.form.dirty&&!this.albumForm.trackForms.some(t=>t.form.dirty)}}return t.\u0275fac=function(e){return new(e||t)(s.Pb(a.a),s.Pb(a.e),s.Pb(b.a),s.Pb(dt.a))},t.\u0275cmp=s.Jb({type:t,selectors:[["crupdate-album-page"]],viewQuery:function(t,e){if(1&t&&s.Pc(vn,3),2&t){let t;s.uc(t=s.dc())&&(e.albumForm=t.first)}},features:[s.Cb([p.a])],decls:1,vars:3,consts:[[1,"material-panel",3,"album","artist","confirmCancel","canceled","saved"]],template:function(t,e){1&t&&(s.Vb(0,"album-form",0),s.cc("canceled",function(){return e.toAlbumsPage()})("saved",function(){return e.toAlbumsPage()}),s.Ub()),2&t&&s.nc("album",e.album)("artist",e.artist)("confirmCancel",!1)},directives:[vn],styles:[""],changeDetection:0}),t})(),kn=(()=>{class t{constructor(t){this.modal=t}canDeactivate(t){return!!t.canDeactivate()||this.modal.show(ht.a,{title:"Unsaved Changes",body:"You have unsaved changes. Do you want to discard them?",ok:"Discard"}).beforeClosed()}}return t.\u0275fac=function(e){return new(e||t)(s.Zb(yt.a))},t.\u0275prov=s.Lb({token:t,factory:t.\u0275fac,providedIn:"root"}),t})(),xn=(()=>{class t{constructor(t,e,n){this.route=t,this.router=e,this.settings=n}ngOnInit(){this.route.data.subscribe(t=>{t.api&&(this.track=t.api.track)})}toTracksPage(){this.insideAdmin()?this.router.navigate(["/admin/tracks"]):this.router.navigate(["/"])}canDeactivate(){return!this.trackForm.form.dirty}insideAdmin(){return this.router.url.includes("admin")}}return t.\u0275fac=function(e){return new(e||t)(s.Pb(a.a),s.Pb(a.e),s.Pb(b.a))},t.\u0275cmp=s.Jb({type:t,selectors:[["crupdate-track-page"]],viewQuery:function(t,e){if(1&t&&s.Pc(cn,3),2&t){let t;s.uc(t=s.dc())&&(e.trackForm=t.first)}},decls:1,vars:1,consts:[[1,"material-panel",3,"track","canceled","saved"]],template:function(t,e){1&t&&(s.Vb(0,"track-form",0),s.cc("canceled",function(){return e.toTracksPage()})("saved",function(){return e.toTracksPage()}),s.Ub()),2&t&&s.nc("track",e.track)},directives:[cn],styles:[""],changeDetection:0}),t})();var Pn=n("MFV3"),Un=n("sgCb");function Cn(t,e=[]){return Object(ft.a)(this,void 0,void 0,function*(){const n=yield(i=t,new Promise(t=>{Vn(i.createReader(),t)}));var i;for(const t in n){const i=n[t];i.isDirectory?yield Cn(i,e):e.push(yield On(i))}return e})}function Vn(t,e,n=[]){t.readEntries(i=>{i.length?(n=n.concat(i),Vn(t,e,n)):e(n)})}function On(t){return new Promise(e=>{t.file(n=>{e(new Un.a(n,t.fullPath))})})}let In=(()=>{class t{constructor(t){this.el=t,this.disableDropzoneClick=!1,this.disableDropzone=!1,this.uploadConfig={},this.filesDropped=new s.n}ngOnInit(){const t=this.el.nativeElement;t.addEventListener("dragenter",t=>this.handleDragEnter(t)),t.addEventListener("dragover",t=>this.handleDragOver(t)),t.addEventListener("dragleave",t=>this.handleDragLeave(t)),t.addEventListener("drop",t=>this.handleDrop(t)),this.disableDropzoneClick||(this.clickButton?this.clickButton.nativeElement:t).addEventListener("click",()=>this.handleClick())}ngOnDestroy(){this.removeClassesFromDropzone()}handleClick(){this.disableDropzone||Object(Xt.a)(this.uploadConfig).then(t=>{this.emitUploadEvent(t)})}handleDragEnter(t){this.dropzoneDisabled(t)||this.el.nativeElement.classList.add("file-over-dropzone")}handleDragOver(t){return t.preventDefault&&t.preventDefault(),t.dataTransfer.dropEffect=this.dropzoneDisabled(t)?"none":"move",!1}handleDragLeave(t){const e=document.elementFromPoint(t.clientX,t.clientY);this.el.nativeElement.contains(e)||this.removeClassesFromDropzone()}handleDrop(t){return Object(ft.a)(this,void 0,void 0,function*(){if(t.stopPropagation(),t.preventDefault(),this.removeClassesFromDropzone(),this.dropzoneDisabled(t)||!t.dataTransfer.items)return;const e=Array.from(t.dataTransfer.items).filter(t=>"file"===t.kind).map(t=>t.webkitGetAsEntry());e.length&&this.emitUploadEvent(yield function(t){return Object(ft.a)(this,void 0,void 0,function*(){let e=[];for(const n in t){const i=t[n];i.isDirectory?e=e.concat(yield Cn(i)):e.push(yield On(i))}return e})}(e))})}emitUploadEvent(t){this.filesDropped.emit(t)}removeClassesFromDropzone(){this.el.nativeElement.classList.remove("file-over-dropzone")}dropzoneDisabled(t){const e=t.dataTransfer.types.find(t=>"files"===t.toLowerCase());return this.disableDropzone||!e}}return t.\u0275fac=function(e){return new(e||t)(s.Pb(s.l))},t.\u0275dir=s.Kb({type:t,selectors:[["","fileDropzone",""]],inputs:{disableDropzoneClick:"disableDropzoneClick",disableDropzone:"disableDropzone",clickButton:"clickButton",uploadConfig:["fileDropzone","uploadConfig"]},outputs:{filesDropped:"filesDropped"}}),t})();var Dn=n("IvAZ"),_n=n("EO6T");const Mn=["trackLinkInput"];function wn(t,e){if(1&t&&(s.Vb(0,"mat-chip",23),s.Jc(1),s.Ub()),2&t){const t=s.gc();s.Db(1),s.Kc(t.media.genres[0].name)}}let Jn=(()=>{class t{constructor(t,e){this.settings=t,this.urls=e}ngOnInit(){setTimeout(()=>{this.trackLinkInput.nativeElement.focus(),this.trackLinkInput.nativeElement.select()})}mediaLink(){return this.isTrack(this.media)?this.urls.track(this.media):this.urls.album(this.media)}mediaUrl(){return this.urls.routerLinkToUrl(this.mediaLink())}shareUsing(t){Object(_n.a)(t,this.mediaUrl())}isTrack(t){return t.model_type===Dn.a}}return t.\u0275fac=function(e){return new(e||t)(s.Pb(b.a),s.Pb(dt.a))},t.\u0275cmp=s.Jb({type:t,selectors:[["uploaded-media-preview"]],viewQuery:function(t,e){if(1&t&&s.Pc(Mn,3),2&t){let t;s.uc(t=s.dc())&&(e.trackLinkInput=t.first)}},hostAttrs:[1,"material-panel"],inputs:{media:"media"},decls:32,vars:14,consts:[[1,"media-image-container"],[3,"media"],["alt","album border image",1,"album-border-image",3,"src"],[1,"middle-column"],[1,"artist-name"],[1,"track-name"],[1,"genre-row"],["class","track-genre",4,"ngIf"],[1,"message"],["trans",""],["trans","",3,"routerLink"],[1,"right-column"],["trans","",1,"title"],[1,"share-icons"],["mat-icon-button","",3,"click"],["alt","facebook-icon",3,"src"],["alt","twitter-icon",3,"src"],["alt","tumblr-icon",3,"src"],["alt","blogger-icon",3,"src"],[1,"track-link-input","input-container"],["for","media-item-link","trans","",1,"hidden"],["id","media-item-link","type","text","readonly","",3,"value","click"],["trackLinkInput",""],[1,"track-genre"]],template:function(t,e){1&t&&(s.Vb(0,"div",0),s.Qb(1,"media-image",1),s.Qb(2,"img",2),s.Ub(),s.Vb(3,"div",3),s.Vb(4,"div",4),s.Jc(5),s.Ub(),s.Vb(6,"div",5),s.Jc(7),s.Ub(),s.Vb(8,"div",6),s.Hc(9,wn,2,1,"mat-chip",7),s.Ub(),s.Vb(10,"div",8),s.Vb(11,"span",9),s.Jc(12,"Upload complete."),s.Ub(),s.Vb(13,"a",10),s.Jc(14," View now."),s.Ub(),s.Ub(),s.Ub(),s.Vb(15,"div",11),s.Vb(16,"div",12),s.Jc(17),s.Ub(),s.Vb(18,"div",13),s.Vb(19,"button",14),s.cc("click",function(){return e.shareUsing("facebook")}),s.Qb(20,"img",15),s.Ub(),s.Vb(21,"button",14),s.cc("click",function(){return e.shareUsing("twitter")}),s.Qb(22,"img",16),s.Ub(),s.Vb(23,"button",14),s.cc("click",function(){return e.shareUsing("tumblr")}),s.Qb(24,"img",17),s.Ub(),s.Vb(25,"button",14),s.cc("click",function(){return e.shareUsing("blogger")}),s.Qb(26,"img",18),s.Ub(),s.Ub(),s.Vb(27,"div",19),s.Vb(28,"label",20),s.Jc(29,"Media link"),s.Ub(),s.Vb(30,"input",21,22),s.cc("click",function(t){return t.target.select()}),s.Ub(),s.Ub(),s.Ub()),2&t&&(s.Hb("show-album-border",!e.isTrack(e.media)),s.Db(1),s.nc("media",e.media),s.Db(1),s.nc("src",e.settings.getAssetUrl("images/album-border.png"),s.Bc),s.Db(3),s.Kc(e.media.artists[0].name),s.Db(2),s.Kc(e.media.name),s.Db(2),s.nc("ngIf",e.media.genres.length),s.Db(4),s.nc("routerLink",e.mediaLink()),s.Db(4),s.Lc("Share your new ",e.isTrack(e.media)?"track":"album",""),s.Db(3),s.oc("src",e.settings.getAssetUrl("images/social-icons/facebook.png"),s.Bc),s.Db(2),s.oc("src",e.settings.getAssetUrl("images/social-icons/twitter.png"),s.Bc),s.Db(2),s.oc("src",e.settings.getAssetUrl("images/social-icons/tumblr.png"),s.Bc),s.Db(2),s.oc("src",e.settings.getAssetUrl("images/social-icons/bloggr.png"),s.Bc),s.Db(4),s.nc("value",e.mediaUrl()))},directives:[w.a,i.o,f.a,a.h,v.b,ge.a],styles:["[_nghost-%COMP%]{display:flex;align-items:center;min-width:800px;max-width:100%}.media-image-container[_ngcontent-%COMP%]{flex-shrink:0;width:130px;height:130px}.media-image-container.show-album-border[_ngcontent-%COMP%]{position:relative;margin:15px 15px 15px 20px}.media-image-container.show-album-border[_ngcontent-%COMP%]   .album-border-image[_ngcontent-%COMP%]{display:block}media-image[_ngcontent-%COMP%]     img{position:relative;z-index:2}.album-border-image[_ngcontent-%COMP%]{display:none;position:absolute;width:160px;height:160px;top:-15px;left:-15px;z-index:1}.middle-column[_ngcontent-%COMP%], .right-column[_ngcontent-%COMP%]{flex:1 1 auto}.middle-column[_ngcontent-%COMP%]{padding:0 20px}.artist-name[_ngcontent-%COMP%]{color:var(--be-secondary-text)}.track-name[_ngcontent-%COMP%]{font-weight:500}.genre-row[_ngcontent-%COMP%]{margin:10px 0 20px}.right-column[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{color:var(--be-secondary-text);margin-bottom:5px}.right-column[_ngcontent-%COMP%]   .share-icons[_ngcontent-%COMP%]{margin-bottom:30px}.right-column[_ngcontent-%COMP%]   .mat-icon-button[_ngcontent-%COMP%]{margin-right:5px;width:32px;height:32px;line-height:32px}.right-column[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:100%;height:100%}.input-container[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{height:35px}"],changeDetection:0}),t})();const An=["clickMatButton"];function Fn(t,e){if(1&t){const t=s.Wb();s.Vb(0,"div",10),s.Vb(1,"mat-slide-toggle",11),s.cc("change",function(e){return s.yc(t),s.gc().createAlbum$.next(e.checked)}),s.Jc(2,"Make an album when multiple files are selected"),s.Ub(),s.Ub()}}function Qn(t,e){if(1&t&&(s.Vb(0,"div",12),s.Vb(1,"span"),s.Jc(2),s.Vb(3,"a",13),s.Jc(4,"Pro accounts"),s.Ub(),s.Jc(5," to get more time and access to advanced features."),s.Ub(),s.Ub()),2&t){const t=e.ngIf;s.Db(2),s.Lc("You have ",t," minutes left. Try ")}}function $n(t,e){if(1&t){const t=s.Wb();s.Vb(0,"album-form",18),s.cc("saved",function(e){return s.yc(t),s.gc(3).addSavedMedia(e)}),s.Ub()}}function Tn(t,e){if(1&t){const t=s.Wb();s.Vb(0,"div",20),s.Vb(1,"track-form",21),s.cc("saved",function(e){return s.yc(t),s.gc(5).addSavedMedia(e)}),s.Ub(),s.Ub()}if(2&t){const t=e.$implicit;s.Db(1),s.nc("uploadQueueItem",t)}}function Sn(t,e){if(1&t&&(s.Tb(0),s.Hc(1,Tn,2,1,"div",19),s.Sb()),2&t){const t=s.gc(3).ngIf,e=s.gc();s.Db(1),s.nc("ngForOf",t)("ngForTrackBy",e.trackByFn)}}function Hn(t,e){if(1&t&&(s.Hc(0,Sn,2,2,"ng-container",15),s.hc(1,"async")),2&t){const t=s.gc(3);s.nc("ngIf",s.ic(1,1,t.errors$))}}function qn(t,e){if(1&t&&(s.Tb(0),s.Hc(1,$n,1,0,"album-form",16),s.hc(2,"async"),s.Hc(3,Hn,2,3,"ng-template",null,17,s.Ic),s.Sb()),2&t){const t=s.vc(4),e=s.gc(2);s.Db(1),s.nc("ngIf",s.ic(2,2,e.createAlbum$))("ngIfElse",t)}}function jn(t,e){if(1&t&&(s.Vb(0,"div",14),s.Hc(1,qn,5,4,"ng-container",15),s.Ub()),2&t){const t=e.ngIf;s.Db(1),s.nc("ngIf",t.length)}}function zn(t,e){1&t&&s.Qb(0,"uploaded-media-preview",22),2&t&&s.nc("media",e.$implicit)}const En=[{path:"",redirectTo:"/",pathMatch:"full"},{path:"requests",component:st},{path:"requests/verify-artist",component:nt},{path:"requests/become-artist",component:nt},{path:"requests/claim-artist",component:nt},{path:"requests/:requestId/request-submitted",component:it},{path:"upload",component:(()=>{class t{constructor(t,e,n,i,a,o,c,s){this.track=t,this.currentUser=e,this.uploadQueue=n,this.settings=i,this.tracks=a,this.toast=o,this.audioValidator=c,this.waveGenerator=s,this.errors$=new r.a({}),this.uploadConfig={types:[te.a.video,te.a.audio],multiple:!0},this.savedMedia$=new r.a([]),this.createAlbum$=new r.a(!1),this.trackByFn=(t,e)=>e.id}uploadTracks(t){this.uploadQueue.start(t,{uri:"uploads",httpParams:{diskPrefix:"track_media",disk:"public"},validator:this.audioValidator,willProcessFiles:!0,autoMatchAlbum:!this.createAlbum$.value}).subscribe(t=>{const e=this.uploadQueue.find(t.queueItemId);this.waveGenerator.generate(e.uploadedFile.native).then(t=>{e.customData={waveData:t},e.finishProcessing()}),this.albumForm&&!this.albumForm.form.get("name").value&&t.metadata.album_name&&this.albumForm.form.patchValue({name:t.metadata.album_name})})}addSavedMedia(t){this.savedMedia$.next([...this.savedMedia$.value,t])}}return t.\u0275fac=function(e){return new(e||t)(s.Pb(ae.a),s.Pb(xt.a),s.Pb(p.a),s.Pb(b.a),s.Pb(ae.a),s.Pb(bt.b),s.Pb(le),s.Pb(be.c))},t.\u0275cmp=s.Jb({type:t,selectors:[["upload-page"]],viewQuery:function(t,e){if(1&t&&(s.Pc(An,3,s.l),s.Pc(vn,1),s.Pc(cn,1)),2&t){let t;s.uc(t=s.dc())&&(e.clickButton=t.first),s.uc(t=s.dc())&&(e.albumForm=t.first),s.uc(t=s.dc())&&(e.trackForms=t)}},features:[s.Cb([p.a])],decls:14,vars:10,consts:[[1,"dropzone",3,"fileDropzone","clickButton","filesDropped"],["trans","",1,"title"],[1,"action-button"],["mat-flat-button","","color","accent","type","button","trans","",1,"upload-button"],["clickMatButton",""],["class","setting-toggle-container",4,"ngIf"],["class","minutes-container",4,"ngIf"],["class","track-upload-queue",4,"ngIf"],[1,"saved-tracks"],[3,"media",4,"ngFor","ngForOf"],[1,"setting-toggle-container"],["trans","",3,"change"],[1,"minutes-container"],["routerLink","/billing/upgrade","target","_blank",1,"hover-underline"],[1,"track-upload-queue"],[4,"ngIf"],["class","material-panel",3,"saved",4,"ngIf","ngIfElse"],["createTracks",""],[1,"material-panel",3,"saved"],["class","track-panel material-panel",4,"ngFor","ngForOf","ngForTrackBy"],[1,"track-panel","material-panel"],[3,"uploadQueueItem","saved"],[3,"media"]],template:function(t,e){1&t&&(s.Vb(0,"div",0),s.cc("filesDropped",function(t){return e.uploadTracks(t)}),s.Vb(1,"div",1),s.Jc(2,"Drag and drop your tracks, videos & albums here."),s.Ub(),s.Vb(3,"div",2),s.Vb(4,"button",3,4),s.Jc(6," or choose files to upload "),s.Ub(),s.Ub(),s.Hc(7,Fn,3,0,"div",5),s.Ub(),s.Hc(8,Qn,6,1,"div",6),s.Hc(9,jn,2,1,"div",7),s.hc(10,"async"),s.Vb(11,"div",8),s.Hc(12,zn,1,1,"uploaded-media-preview",9),s.hc(13,"async"),s.Ub()),2&t&&(s.nc("fileDropzone",e.uploadConfig)("clickButton",e.clickButton),s.Db(7),s.nc("ngIf",e.uploadQueue.isEmpty()),s.Db(1),s.nc("ngIf",e.currentUser.getRestrictionValue("tracks.create","minutes")),s.Db(1),s.nc("ngIf",s.ic(10,6,e.uploadQueue.uploads$)),s.Db(3),s.nc("ngForOf",s.ic(13,8,e.savedMedia$)))},directives:[In,f.a,v.b,i.o,i.n,Qt.a,a.h,vn,cn,Jn],pipes:[i.b],styles:["admin[_nghost-%COMP%], admin   [_nghost-%COMP%]{min-height:calc(100vh - 120px)}[_nghost-%COMP%]{display:flex;align-items:center;justify-content:center;flex-direction:column;min-height:100%}.dropzone[_ngcontent-%COMP%]{background:var(--be-background);padding:50px;border-radius:4px;text-align:center;border:1px solid var(--be-divider-default);min-width:520px;max-width:90%}.dropzone[_ngcontent-%COMP%]   .action-button[_ngcontent-%COMP%]{margin-top:20px}.dropzone[_ngcontent-%COMP%]   .setting-toggle-container[_ngcontent-%COMP%]{margin-top:20px;padding-top:20px;border-top:1px solid var(--be-divider-lighter);font-size:1.3rem}.dropzone[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{font-size:1.8rem}.dropzone[_ngcontent-%COMP%]   .setting-toggle-container[_ngcontent-%COMP%], .dropzone[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin-bottom:0}.dropzone.file-over-dropzone[_ngcontent-%COMP%]{border-color:var(--be-accent-default);background-color:var(--be-accent-emphasis)}.create-artists-toggle[_ngcontent-%COMP%]{margin-top:20px;min-width:520px;text-align:center}.minutes-container[_ngcontent-%COMP%]{color:var(--be-secondary-text);font-size:1.5rem;margin-top:20px}.minutes-container[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{color:var(--be-accent-default)}.track-upload-queue[_ngcontent-%COMP%]{width:100%;margin-top:40px}.track-panel[_ngcontent-%COMP%]{margin-bottom:20px;padding:20px 25px}uploaded-media-preview[_ngcontent-%COMP%]{margin-bottom:15px}"],changeDetection:0}),t})()},{path:"artists/new",component:Bt},{path:"artists/:id/edit",component:Bt,resolve:{api:Rt},canDeactivate:[kn]},{path:"albums/:id/edit",component:yn,resolve:{api:(()=>{class t{constructor(t,e){this.albums=t,this.router=e}resolve(t,e){const n=+t.paramMap.get("id");return this.albums.get(n,{with:["tags","genres","artists","fullTracks"],albumsPerPage:50,forEditing:!0}).pipe(Object(O.a)(()=>(this.router.navigate(["/"]),Gt.a)),Object(Kt.a)(t=>t.album?Object(P.a)(t):(this.router.navigate(["/"]),Gt.a)))}}return t.\u0275fac=function(e){return new(e||t)(s.Zb(kt.a),s.Zb(a.e))},t.\u0275prov=s.Lb({token:t,factory:t.\u0275fac,providedIn:"root"}),t})()},canDeactivate:[kn]},{path:"albums/new",component:yn,canDeactivate:[kn]},{path:"tracks/:id/edit",component:xn,resolve:{api:Pn.a},canDeactivate:[kn]},{path:"tracks/new",component:xn,canDeactivate:[kn]}];let Nn=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=s.Nb({type:t}),t.\u0275inj=s.Mb({imports:[[a.i.forChild(En)],a.i]}),t})();var Ln=n("gFpt"),Bn=n("6rvT"),Kn=n("fo0W"),Gn=n("GSRO"),Rn=n("k3xQ"),Wn=n("mhcW"),Zn=n("X3pI");let Yn=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=s.Nb({type:t}),t.\u0275inj=s.Mb({imports:[[i.c,_.b,Wn.a,Bn.a,u.m,u.z,y.b,Zn.a,v.c]]}),t})();var Xn=n("0Gur"),ti=n("1ImS"),ei=n("zWu1"),ni=n("5ZHN");let ii=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=s.Nb({type:t}),t.\u0275inj=s.Mb({imports:[[i.c,a.i,Wn.a,Yn,y.b,Ce.b,Bn.a,Gn.a,u.z,u.m,v.c,Xn.a,ge.e,Qt.b,Vt.b,Kn.a,Wt.f,pe.b,_.b,Zn.a,ni.a]]}),t})();var ai=n("0IaG");let ri=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=s.Nb({type:t}),t.\u0275inj=s.Mb({imports:[[i.c,Nn,ii,u.z,u.m,Yn,Bn.a,Ln.a,v.c,y.b,Qt.b,Gn.a,Kn.a,Rn.a,ei.a,Zn.a,ai.f,mt.c,Xn.a,ti.a,Wn.a,Vt.b]]}),t})()}}]);
//# sourceMappingURL=12-es2015.d9cf26bcf62e4e8c3f36.js.map