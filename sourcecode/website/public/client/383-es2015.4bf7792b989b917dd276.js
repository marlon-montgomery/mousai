"use strict";(self.webpackChunkclient=self.webpackChunkclient||[]).push([[383,170],{1625:function(t,e,n){n.d(e,{pp:function(){return L},To:function(){return H},ib:function(){return $},VG:function(){return S},yz:function(){return D},yK:function(){return E},FX:function(){return Q}});var i=n(2316),a=n(20657),o=n(79441),r=n(11318),s=n(62604);let c=0;const l=new i.OlP("CdkAccordion");let u=(()=>{class t{constructor(){this._stateChanges=new o.xQ,this._openCloseAllActions=new o.xQ,this.id="cdk-accordion-"+c++,this._multi=!1}get multi(){return this._multi}set multi(t){this._multi=(0,a.Ig)(t)}openAll(){this._openCloseAll(!0)}closeAll(){this._openCloseAll(!1)}ngOnChanges(t){this._stateChanges.next(t)}ngOnDestroy(){this._stateChanges.complete()}_openCloseAll(t){this.multi&&this._openCloseAllActions.next(t)}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275dir=i.lG2({type:t,selectors:[["cdk-accordion"],["","cdkAccordion",""]],inputs:{multi:"multi"},exportAs:["cdkAccordion"],features:[i._Bn([{provide:l,useExisting:t}]),i.TTD]}),t})(),d=0,p=(()=>{class t{constructor(t,e,n){this.accordion=t,this._changeDetectorRef=e,this._expansionDispatcher=n,this._openCloseAllSubscription=r.w.EMPTY,this.closed=new i.vpe,this.opened=new i.vpe,this.destroyed=new i.vpe,this.expandedChange=new i.vpe,this.id="cdk-accordion-child-"+d++,this._expanded=!1,this._disabled=!1,this._removeUniqueSelectionListener=()=>{},this._removeUniqueSelectionListener=n.listen((t,e)=>{this.accordion&&!this.accordion.multi&&this.accordion.id===e&&this.id!==t&&(this.expanded=!1)}),this.accordion&&(this._openCloseAllSubscription=this._subscribeToOpenCloseAllActions())}get expanded(){return this._expanded}set expanded(t){t=(0,a.Ig)(t),this._expanded!==t&&(this._expanded=t,this.expandedChange.emit(t),t?(this.opened.emit(),this._expansionDispatcher.notify(this.id,this.accordion?this.accordion.id:this.id)):this.closed.emit(),this._changeDetectorRef.markForCheck())}get disabled(){return this._disabled}set disabled(t){this._disabled=(0,a.Ig)(t)}ngOnDestroy(){this.opened.complete(),this.closed.complete(),this.destroyed.emit(),this.destroyed.complete(),this._removeUniqueSelectionListener(),this._openCloseAllSubscription.unsubscribe()}toggle(){this.disabled||(this.expanded=!this.expanded)}close(){this.disabled||(this.expanded=!1)}open(){this.disabled||(this.expanded=!0)}_subscribeToOpenCloseAllActions(){return this.accordion._openCloseAllActions.subscribe(t=>{this.disabled||(this.expanded=t)})}}return t.\u0275fac=function(e){return new(e||t)(i.Y36(l,12),i.Y36(i.sBO),i.Y36(s.A8))},t.\u0275dir=i.lG2({type:t,selectors:[["cdk-accordion-item"],["","cdkAccordionItem",""]],inputs:{expanded:"expanded",disabled:"disabled"},outputs:{closed:"closed",opened:"opened",destroyed:"destroyed",expandedChange:"expandedChange"},exportAs:["cdkAccordionItem"],features:[i._Bn([{provide:l,useValue:void 0}])]}),t})(),m=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=i.oAB({type:t}),t.\u0275inj=i.cJS({}),t})();var g=n(40912),h=n(54364),f=n(51606),b=n(83720),x=n(1143),v=n(9170),Z=n(53466),_=n(90084),A=n(71918),y=n(8117),C=n(89919),k=n(97175);const w=["body"];function T(t,e){}const q=[[["mat-expansion-panel-header"]],"*",[["mat-action-row"]]],O=["mat-expansion-panel-header","*","mat-action-row"];function I(t,e){if(1&t&&i._UZ(0,"span",2),2&t){const t=i.oxw();i.Q6J("@indicatorRotate",t._getExpandedState())}}const P=[[["mat-panel-title"]],[["mat-panel-description"]],"*"],M=["mat-panel-title","mat-panel-description","*"],U=new i.OlP("MAT_ACCORDION"),J="225ms cubic-bezier(0.4,0.0,0.2,1)",Q={indicatorRotate:(0,k.X$)("indicatorRotate",[(0,k.SB)("collapsed, void",(0,k.oB)({transform:"rotate(0deg)"})),(0,k.SB)("expanded",(0,k.oB)({transform:"rotate(180deg)"})),(0,k.eR)("expanded <=> collapsed, void => collapsed",(0,k.jt)(J))]),bodyExpansion:(0,k.X$)("bodyExpansion",[(0,k.SB)("collapsed, void",(0,k.oB)({height:"0px",visibility:"hidden"})),(0,k.SB)("expanded",(0,k.oB)({height:"*",visibility:"visible"})),(0,k.eR)("expanded <=> collapsed, void => collapsed",(0,k.jt)(J))])};let F=(()=>{class t{constructor(t){this._template=t}}return t.\u0275fac=function(e){return new(e||t)(i.Y36(i.Rgc))},t.\u0275dir=i.lG2({type:t,selectors:[["ng-template","matExpansionPanelContent",""]]}),t})(),N=0;const Y=new i.OlP("MAT_EXPANSION_PANEL_DEFAULT_OPTIONS");let $=(()=>{class t extends p{constructor(t,e,n,a,r,s,c){super(t,e,n),this._viewContainerRef=a,this._animationMode=s,this._hideToggle=!1,this.afterExpand=new i.vpe,this.afterCollapse=new i.vpe,this._inputChanges=new o.xQ,this._headerId="mat-expansion-panel-header-"+N++,this._bodyAnimationDone=new o.xQ,this.accordion=t,this._document=r,this._bodyAnimationDone.pipe((0,b.x)((t,e)=>t.fromState===e.fromState&&t.toState===e.toState)).subscribe(t=>{"void"!==t.fromState&&("expanded"===t.toState?this.afterExpand.emit():"collapsed"===t.toState&&this.afterCollapse.emit())}),c&&(this.hideToggle=c.hideToggle)}get hideToggle(){return this._hideToggle||this.accordion&&this.accordion.hideToggle}set hideToggle(t){this._hideToggle=(0,a.Ig)(t)}get togglePosition(){return this._togglePosition||this.accordion&&this.accordion.togglePosition}set togglePosition(t){this._togglePosition=t}_hasSpacing(){return!!this.accordion&&this.expanded&&"default"===this.accordion.displayMode}_getExpandedState(){return this.expanded?"expanded":"collapsed"}toggle(){this.expanded=!this.expanded}close(){this.expanded=!1}open(){this.expanded=!0}ngAfterContentInit(){this._lazyContent&&this.opened.pipe((0,x.O)(null),(0,v.h)(()=>this.expanded&&!this._portal),(0,Z.q)(1)).subscribe(()=>{this._portal=new g.UE(this._lazyContent._template,this._viewContainerRef)})}ngOnChanges(t){this._inputChanges.next(t)}ngOnDestroy(){super.ngOnDestroy(),this._bodyAnimationDone.complete(),this._inputChanges.complete()}_containsFocus(){if(this._body){const t=this._document.activeElement,e=this._body.nativeElement;return t===e||e.contains(t)}return!1}}return t.\u0275fac=function(e){return new(e||t)(i.Y36(U,12),i.Y36(i.sBO),i.Y36(s.A8),i.Y36(i.s_b),i.Y36(h.K0),i.Y36(A.Qb,8),i.Y36(Y,8))},t.\u0275cmp=i.Xpm({type:t,selectors:[["mat-expansion-panel"]],contentQueries:function(t,e,n){if(1&t&&i.Suo(n,F,5),2&t){let t;i.iGM(t=i.CRH())&&(e._lazyContent=t.first)}},viewQuery:function(t,e){if(1&t&&i.Gf(w,5),2&t){let t;i.iGM(t=i.CRH())&&(e._body=t.first)}},hostAttrs:[1,"mat-expansion-panel"],hostVars:6,hostBindings:function(t,e){2&t&&i.ekj("mat-expanded",e.expanded)("_mat-animation-noopable","NoopAnimations"===e._animationMode)("mat-expansion-panel-spacing",e._hasSpacing())},inputs:{disabled:"disabled",expanded:"expanded",hideToggle:"hideToggle",togglePosition:"togglePosition"},outputs:{opened:"opened",closed:"closed",expandedChange:"expandedChange",afterExpand:"afterExpand",afterCollapse:"afterCollapse"},exportAs:["matExpansionPanel"],features:[i._Bn([{provide:U,useValue:void 0}]),i.qOj,i.TTD],ngContentSelectors:O,decls:7,vars:4,consts:[["role","region",1,"mat-expansion-panel-content",3,"id"],["body",""],[1,"mat-expansion-panel-body"],[3,"cdkPortalOutlet"]],template:function(t,e){1&t&&(i.F$t(q),i.Hsn(0),i.TgZ(1,"div",0,1),i.NdJ("@bodyExpansion.done",function(t){return e._bodyAnimationDone.next(t)}),i.TgZ(3,"div",2),i.Hsn(4,1),i.YNc(5,T,0,0,"ng-template",3),i.qZA(),i.Hsn(6,2),i.qZA()),2&t&&(i.xp6(1),i.Q6J("@bodyExpansion",e._getExpandedState())("id",e.id),i.uIk("aria-labelledby",e._headerId),i.xp6(4),i.Q6J("cdkPortalOutlet",e._portal))},directives:[g.Pl],styles:[".mat-expansion-panel{box-sizing:content-box;display:block;margin:0;border-radius:4px;overflow:hidden;transition:margin 225ms cubic-bezier(0.4, 0, 0.2, 1),box-shadow 280ms cubic-bezier(0.4, 0, 0.2, 1);position:relative}.mat-accordion .mat-expansion-panel:not(.mat-expanded),.mat-accordion .mat-expansion-panel:not(.mat-expansion-panel-spacing){border-radius:0}.mat-accordion .mat-expansion-panel:first-of-type{border-top-right-radius:4px;border-top-left-radius:4px}.mat-accordion .mat-expansion-panel:last-of-type{border-bottom-right-radius:4px;border-bottom-left-radius:4px}.cdk-high-contrast-active .mat-expansion-panel{outline:solid 1px}.mat-expansion-panel.ng-animate-disabled,.ng-animate-disabled .mat-expansion-panel,.mat-expansion-panel._mat-animation-noopable{transition:none}.mat-expansion-panel-content{display:flex;flex-direction:column;overflow:visible}.mat-expansion-panel-body{padding:0 24px 16px}.mat-expansion-panel-spacing{margin:16px 0}.mat-accordion>.mat-expansion-panel-spacing:first-child,.mat-accordion>*:first-child:not(.mat-expansion-panel) .mat-expansion-panel-spacing{margin-top:0}.mat-accordion>.mat-expansion-panel-spacing:last-child,.mat-accordion>*:last-child:not(.mat-expansion-panel) .mat-expansion-panel-spacing{margin-bottom:0}.mat-action-row{border-top-style:solid;border-top-width:1px;display:flex;flex-direction:row;justify-content:flex-end;padding:16px 8px 16px 24px}.mat-action-row button.mat-button-base,.mat-action-row button.mat-mdc-button-base{margin-left:8px}[dir=rtl] .mat-action-row button.mat-button-base,[dir=rtl] .mat-action-row button.mat-mdc-button-base{margin-left:0;margin-right:8px}\n"],encapsulation:2,data:{animation:[Q.bodyExpansion]},changeDetection:0}),t})(),S=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275dir=i.lG2({type:t,selectors:[["mat-action-row"]],hostAttrs:[1,"mat-action-row"]}),t})(),D=(()=>{class t{constructor(t,e,n,i,a,o){this.panel=t,this._element=e,this._focusMonitor=n,this._changeDetectorRef=i,this._animationMode=o,this._parentChangeSubscription=r.w.EMPTY;const s=t.accordion?t.accordion._stateChanges.pipe((0,v.h)(t=>!(!t.hideToggle&&!t.togglePosition))):y.E;this._parentChangeSubscription=(0,C.T)(t.opened,t.closed,s,t._inputChanges.pipe((0,v.h)(t=>!!(t.hideToggle||t.disabled||t.togglePosition)))).subscribe(()=>this._changeDetectorRef.markForCheck()),t.closed.pipe((0,v.h)(()=>t._containsFocus())).subscribe(()=>n.focusVia(e,"program")),a&&(this.expandedHeight=a.expandedHeight,this.collapsedHeight=a.collapsedHeight)}get disabled(){return this.panel.disabled}_toggle(){this.disabled||this.panel.toggle()}_isExpanded(){return this.panel.expanded}_getExpandedState(){return this.panel._getExpandedState()}_getPanelId(){return this.panel.id}_getTogglePosition(){return this.panel.togglePosition}_showToggle(){return!this.panel.hideToggle&&!this.panel.disabled}_getHeaderHeight(){const t=this._isExpanded();return t&&this.expandedHeight?this.expandedHeight:!t&&this.collapsedHeight?this.collapsedHeight:null}_keydown(t){switch(t.keyCode){case _.L_:case _.K5:(0,_.Vb)(t)||(t.preventDefault(),this._toggle());break;default:return void(this.panel.accordion&&this.panel.accordion._handleHeaderKeydown(t))}}focus(t="program",e){this._focusMonitor.focusVia(this._element,t,e)}ngAfterViewInit(){this._focusMonitor.monitor(this._element).subscribe(t=>{t&&this.panel.accordion&&this.panel.accordion._handleHeaderFocus(this)})}ngOnDestroy(){this._parentChangeSubscription.unsubscribe(),this._focusMonitor.stopMonitoring(this._element)}}return t.\u0275fac=function(e){return new(e||t)(i.Y36($,1),i.Y36(i.SBq),i.Y36(f.tE),i.Y36(i.sBO),i.Y36(Y,8),i.Y36(A.Qb,8))},t.\u0275cmp=i.Xpm({type:t,selectors:[["mat-expansion-panel-header"]],hostAttrs:["role","button",1,"mat-expansion-panel-header","mat-focus-indicator"],hostVars:15,hostBindings:function(t,e){1&t&&i.NdJ("click",function(){return e._toggle()})("keydown",function(t){return e._keydown(t)}),2&t&&(i.uIk("id",e.panel._headerId)("tabindex",e.disabled?-1:0)("aria-controls",e._getPanelId())("aria-expanded",e._isExpanded())("aria-disabled",e.panel.disabled),i.Udp("height",e._getHeaderHeight()),i.ekj("mat-expanded",e._isExpanded())("mat-expansion-toggle-indicator-after","after"===e._getTogglePosition())("mat-expansion-toggle-indicator-before","before"===e._getTogglePosition())("_mat-animation-noopable","NoopAnimations"===e._animationMode))},inputs:{expandedHeight:"expandedHeight",collapsedHeight:"collapsedHeight"},ngContentSelectors:M,decls:5,vars:1,consts:[[1,"mat-content"],["class","mat-expansion-indicator",4,"ngIf"],[1,"mat-expansion-indicator"]],template:function(t,e){1&t&&(i.F$t(P),i.TgZ(0,"span",0),i.Hsn(1),i.Hsn(2,1),i.Hsn(3,2),i.qZA(),i.YNc(4,I,1,1,"span",1)),2&t&&(i.xp6(4),i.Q6J("ngIf",e._showToggle()))},directives:[h.O5],styles:['.mat-expansion-panel-header{display:flex;flex-direction:row;align-items:center;padding:0 24px;border-radius:inherit;transition:height 225ms cubic-bezier(0.4, 0, 0.2, 1)}.mat-expansion-panel-header._mat-animation-noopable{transition:none}.mat-expansion-panel-header:focus,.mat-expansion-panel-header:hover{outline:none}.mat-expansion-panel-header.mat-expanded:focus,.mat-expansion-panel-header.mat-expanded:hover{background:inherit}.mat-expansion-panel-header:not([aria-disabled=true]){cursor:pointer}.mat-expansion-panel-header.mat-expansion-toggle-indicator-before{flex-direction:row-reverse}.mat-expansion-panel-header.mat-expansion-toggle-indicator-before .mat-expansion-indicator{margin:0 16px 0 0}[dir=rtl] .mat-expansion-panel-header.mat-expansion-toggle-indicator-before .mat-expansion-indicator{margin:0 0 0 16px}.mat-content{display:flex;flex:1;flex-direction:row;overflow:hidden}.mat-expansion-panel-header-title,.mat-expansion-panel-header-description{display:flex;flex-grow:1;margin-right:16px}[dir=rtl] .mat-expansion-panel-header-title,[dir=rtl] .mat-expansion-panel-header-description{margin-right:0;margin-left:16px}.mat-expansion-panel-header-description{flex-grow:2}.mat-expansion-indicator::after{border-style:solid;border-width:0 2px 2px 0;content:"";display:inline-block;padding:3px;transform:rotate(45deg);vertical-align:middle}\n'],encapsulation:2,data:{animation:[Q.indicatorRotate]},changeDetection:0}),t})(),E=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275dir=i.lG2({type:t,selectors:[["mat-panel-title"]],hostAttrs:[1,"mat-expansion-panel-header-title"]}),t})(),L=(()=>{class t extends u{constructor(){super(...arguments),this._ownHeaders=new i.n_E,this._hideToggle=!1,this.displayMode="default",this.togglePosition="after"}get hideToggle(){return this._hideToggle}set hideToggle(t){this._hideToggle=(0,a.Ig)(t)}ngAfterContentInit(){this._headers.changes.pipe((0,x.O)(this._headers)).subscribe(t=>{this._ownHeaders.reset(t.filter(t=>t.panel.accordion===this)),this._ownHeaders.notifyOnChanges()}),this._keyManager=new f.Em(this._ownHeaders).withWrap().withHomeAndEnd()}_handleHeaderKeydown(t){this._keyManager.onKeydown(t)}_handleHeaderFocus(t){this._keyManager.updateActiveItem(t)}}return t.\u0275fac=function(){let e;return function(n){return(e||(e=i.n5z(t)))(n||t)}}(),t.\u0275dir=i.lG2({type:t,selectors:[["mat-accordion"]],contentQueries:function(t,e,n){if(1&t&&i.Suo(n,D,5),2&t){let t;i.iGM(t=i.CRH())&&(e._headers=t)}},hostAttrs:[1,"mat-accordion"],hostVars:2,hostBindings:function(t,e){2&t&&i.ekj("mat-accordion-multi",e.multi)},inputs:{multi:"multi",displayMode:"displayMode",togglePosition:"togglePosition",hideToggle:"hideToggle"},exportAs:["matAccordion"],features:[i._Bn([{provide:U,useExisting:t}]),i.qOj]}),t})(),H=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=i.oAB({type:t}),t.\u0275inj=i.cJS({imports:[[h.ez,m,g.eL]]}),t})()},56383:function(t,e,n){n.r(e),n.d(e,{BackstageModule:function(){return ai}});var i=n(54364),a=n(47532),o=n(76491),r=n(71435),s=n(56297),c=n(2316),l=n(81371),u=n(1707),d=n(34673),p=n(76177),m=n(21270),g=n(9141),h=n(56432),f=n(15515),b=n(94315),x=n(70781),v=n(52529),Z=n(52781),_=n(91015),A=n(81134),y=n(80639),C=n(83720),k=n(79902),w=n(18293),T=n(33927),q=n(96185),O=n(80221),I=n(20616),P=n(39820);const M=["searchInput"],U=["fakeInput"];function J(t,e){if(1&t&&(c.TgZ(0,"span"),c._UZ(1,"media-image",16),c._uU(2),c.qZA()),2&t){const t=e.ngIf;c.xp6(1),c.Q6J("media",t),c.xp6(1),c.hij(" ",t.name," ")}}function Q(t,e){1&t&&(c.TgZ(0,"span",17),c._uU(1,"Select an artist"),c.qZA())}function F(t,e){if(1&t){const t=c.EpF();c.TgZ(0,"button",18),c.NdJ("click",function(){return c.CHM(t),c.oxw().clearSearchInput()}),c._UZ(1,"mat-icon",19),c.qZA()}}function N(t,e){if(1&t){const t=c.EpF();c.TgZ(0,"button",20),c.NdJ("click",function(){const e=c.CHM(t).$implicit;return c.oxw().selectArtist(e)}),c._UZ(1,"media-image",16),c.TgZ(2,"div",21),c.TgZ(3,"div",22),c._uU(4),c.qZA(),c.TgZ(5,"div",23),c._uU(6,"Artist"),c.qZA(),c.qZA(),c.qZA()}if(2&t){const t=e.$implicit;c.xp6(1),c.Q6J("media",t),c.xp6(3),c.Oqu(t.name)}}function Y(t,e){1&t&&(c.TgZ(0,"div",24),c._uU(1,"No artists found."),c.qZA())}let $=(()=>{class t{constructor(t){this.search=t,this.listAll=!1,this.isDisabled$=new o.X(!1),this.searchFormControl=new u.NI,this.loading$=new o.X(!1),this.artists$=new o.X([]),this.selectedArtist$=new o.X(null),this.searchedOnce=!1}ngOnInit(){this.bindToSearchControl()}writeValue(t){this.selectedArtist$.next(t)}registerOnChange(t){this.propagateChange=t}registerOnTouched(){}setDisabledState(t){this.isDisabled$.next(t)}bindToSearchControl(){this.searchFormControl.valueChanges.pipe((0,y.b)(150),(0,C.x)(),(0,k.w)(t=>this.searchArtists(t)),(0,w.K)(()=>(0,A.of)([]))).subscribe(t=>{this.searchedOnce=!0,this.artists$.next(t)})}searchArtists(t){return this.loading$.next(!0),this.search.suggestArtists({query:t,limit:7,listAll:this.listAll}).pipe((0,r.x)(()=>this.loading$.next(!1)),(0,T.U)(t=>t.artists))}onMenuOpened(){document.querySelector(".select-artist-control-menu").style.width=this.fakeInput.nativeElement.getBoundingClientRect().width+"px",this.searchedOnce||this.clearSearchInput()}selectArtist(t){this.selectedArtist$.next(t),this.propagateChange(t)}clearSearchInput(){this.searchFormControl.setValue("")}onMenuClosed(){this.loading$.next(!1),this.clearSearchInput()}}return t.\u0275fac=function(e){return new(e||t)(c.Y36(q.o))},t.\u0275cmp=c.Xpm({type:t,selectors:[["select-artist-control"]],viewQuery:function(t,e){if(1&t&&(c.Gf(M,5),c.Gf(U,5)),2&t){let t;c.iGM(t=c.CRH())&&(e.searchInput=t.first),c.iGM(t=c.CRH())&&(e.fakeInput=t.first)}},hostAttrs:["tabindex","0"],inputs:{listAll:"listAll"},features:[c._Bn([{provide:u.JU,useExisting:t,multi:!0}])],decls:22,vars:20,consts:[[1,"fake-input",3,"matMenuTriggerFor","menuOpened","menuClosed"],["fakeInput",""],[4,"ngIf","ngIfElse"],["anyArtist",""],[1,"arrow-container"],[1,"arrow"],[1,"select-artist-control-menu"],["menu","matMenu"],[1,"input-container","search-input-container",3,"click"],[1,"search-input-wrapper"],["type","text","placeholder","Search...","mat-menu-item","","trans-placeholder","",3,"formControl"],["searchInput",""],["class","clear-search-input-button","mat-icon-button","",3,"click",4,"ngIf"],[1,"small",3,"isVisible"],["type","button","mat-menu-item","",3,"click",4,"ngFor","ngForOf"],["mat-menu-item","","disabled","","trans","",4,"ngIf"],[1,"result-image",3,"media"],["trans",""],["mat-icon-button","",1,"clear-search-input-button",3,"click"],["svgIcon","close"],["type","button","mat-menu-item","",3,"click"],[1,"user-info"],[1,"name"],["trans","",1,"email"],["mat-menu-item","","disabled","","trans",""]],template:function(t,e){if(1&t&&(c.TgZ(0,"div",0,1),c.NdJ("menuOpened",function(){return e.onMenuOpened()})("menuClosed",function(){return e.onMenuClosed()}),c.ALo(2,"async"),c.YNc(3,J,3,2,"span",2),c.ALo(4,"async"),c.YNc(5,Q,2,0,"ng-template",null,3,c.W1O),c.TgZ(7,"div",4),c._UZ(8,"div",5),c.qZA(),c.qZA(),c.TgZ(9,"mat-menu",6,7),c.TgZ(11,"div",8),c.NdJ("click",function(t){return t.stopPropagation()}),c.TgZ(12,"div",9),c._UZ(13,"input",10,11),c.YNc(15,F,2,0,"button",12),c._UZ(16,"loading-indicator",13),c.ALo(17,"async"),c.qZA(),c.qZA(),c.YNc(18,N,7,2,"button",14),c.ALo(19,"async"),c.YNc(20,Y,2,0,"div",15),c.ALo(21,"async"),c.qZA()),2&t){const t=c.MAs(6),n=c.MAs(10);c.ekj("disabled",c.lcZ(2,10,e.isDisabled$)),c.Q6J("matMenuTriggerFor",n),c.xp6(3),c.Q6J("ngIf",c.lcZ(4,12,e.selectedArtist$))("ngIfElse",t),c.xp6(10),c.Q6J("formControl",e.searchFormControl),c.xp6(2),c.Q6J("ngIf",e.searchFormControl.value),c.xp6(1),c.Q6J("isVisible",c.lcZ(17,14,e.loading$)),c.xp6(2),c.Q6J("ngForOf",c.lcZ(19,16,e.artists$)),c.xp6(2),c.Q6J("ngIf",e.searchedOnce&&!c.lcZ(21,18,e.artists$).length)}},directives:[O.p6,i.O5,O.yF,u.Fj,O.OP,f.P,u.JJ,u.oH,I.Q,i.sg,P.P,x.lW,v.Hw],pipes:[i.Ov],styles:["[_nghost-%COMP%]{display:block;min-width:280px;max-width:100%}.fake-input[_ngcontent-%COMP%]{position:relative;display:flex;align-items:center;cursor:pointer}.fake-input.disabled[_ngcontent-%COMP%]{pointer-events:none;opacity:.7}.result-image[_ngcontent-%COMP%]{display:inline-block;margin-right:5px;width:25px;height:25px;border-radius:4px;vertical-align:middle}.placeholder[_ngcontent-%COMP%]{opacity:.6}.arrow-container[_ngcontent-%COMP%]{height:100%;position:absolute;top:1px;right:1px;width:20px}.arrow[_ngcontent-%COMP%]{position:absolute;border-color:#000 transparent transparent transparent;border-style:solid;border-width:5px 4px 0 4px;height:0;width:0;left:50%;top:50%;margin-left:-4px;margin-top:-2px}  .select-artist-control-menu{max-width:none!important}.mat-menu-item[_ngcontent-%COMP%]:first-of-type{border-top:1px solid var(--be-divider-default)}.search-input-container[_ngcontent-%COMP%]{padding:7px 15px 15px}.search-input-wrapper[_ngcontent-%COMP%]{position:relative}.clear-search-input-button[_ngcontent-%COMP%]{position:absolute;top:4px;right:0;color:var(--be-secondary-text)}.mat-menu-item[_ngcontent-%COMP%]:not(input){display:flex;align-items:center;height:65px;line-height:65px}.mat-menu-item[_ngcontent-%COMP%]:not(input).selected{background-color:var(--be-accent-emphasis)}.mat-menu-item[_ngcontent-%COMP%]:not(input)   .result-image[_ngcontent-%COMP%]{width:45px;height:45px;margin-right:15px;border-radius:50%}.mat-menu-item[_ngcontent-%COMP%]:not(input)   .name[_ngcontent-%COMP%]{text-transform:capitalize;overflow:hidden;text-overflow:ellipsis}.mat-menu-item[_ngcontent-%COMP%]:not(input)   .email[_ngcontent-%COMP%]{color:var(--be-secondary-text);font-size:1.3rem;overflow:hidden;text-overflow:ellipsis}.user-info[_ngcontent-%COMP%]{line-height:normal;line-height:initial}.any-user-info[_ngcontent-%COMP%]{line-height:35px}loading-indicator[_ngcontent-%COMP%]{position:absolute;top:12px;right:40px}"],changeDetection:0}),t})();var S=n(52644);function D(t,e){if(1&t&&(c.TgZ(0,"div",32),c._uU(1),c.qZA()),2&t){const t=c.oxw(3).ngIf;c.xp6(1),c.Oqu(t.artist_id)}}function E(t,e){if(1&t&&(c.TgZ(0,"div",7),c.TgZ(1,"label",30),c._uU(2,"Select Artist"),c.qZA(),c._UZ(3,"select-artist-control",31),c.YNc(4,D,2,1,"div",10),c.qZA()),2&t){const t=c.oxw(2).ngIf;c.xp6(3),c.Q6J("listAll",!0),c.xp6(1),c.Q6J("ngIf",t.artist_id)}}function L(t,e){if(1&t&&(c.TgZ(0,"div",32),c._uU(1),c.qZA()),2&t){const t=c.oxw(3).ngIf;c.xp6(1),c.Oqu(t.name)}}function H(t,e){if(1&t&&(c.TgZ(0,"div",7),c.TgZ(1,"label",33),c._uU(2,"Your artist name"),c.qZA(),c._UZ(3,"input",34),c.YNc(4,L,2,1,"div",10),c.qZA()),2&t){const t=c.oxw(2).ngIf;c.xp6(4),c.Q6J("ngIf",t.name)}}function z(t,e){if(1&t&&(c.TgZ(0,"div",32),c._uU(1),c.qZA()),2&t){const t=c.oxw(2).ngIf;c.xp6(1),c.Oqu(t.first_name)}}function B(t,e){if(1&t&&(c.TgZ(0,"div",32),c._uU(1),c.qZA()),2&t){const t=c.oxw(2).ngIf;c.xp6(1),c.Oqu(t.last_name)}}function R(t,e){if(1&t&&(c.TgZ(0,"div",32),c._uU(1),c.qZA()),2&t){const t=c.oxw(3).ngIf;c.xp6(1),c.Oqu(t.role)}}function V(t,e){if(1&t&&(c.TgZ(0,"div",7),c.TgZ(1,"label",35),c._uU(2,"Role"),c.qZA(),c.TgZ(3,"select",36),c.TgZ(4,"option",37),c._uU(5,"Select role"),c.qZA(),c.TgZ(6,"option",38),c._uU(7,"Artist"),c.qZA(),c.TgZ(8,"option",39),c._uU(9,"Agent"),c.qZA(),c.TgZ(10,"option",40),c._uU(11,"Composer"),c.qZA(),c.TgZ(12,"option",41),c._uU(13,"Label"),c.qZA(),c.TgZ(14,"option",42),c._uU(15,"Manager"),c.qZA(),c.TgZ(16,"option",43),c._uU(17,"Musician"),c.qZA(),c.TgZ(18,"option",44),c._uU(19,"Producer"),c.qZA(),c.TgZ(20,"option",45),c._uU(21,"Publisher"),c.qZA(),c.TgZ(22,"option",46),c._uU(23,"Songwriter"),c.qZA(),c.qZA(),c.YNc(24,R,2,1,"div",10),c.qZA()),2&t){const t=c.oxw(2).ngIf;c.xp6(4),c.Q6J("value",null),c.xp6(20),c.Q6J("ngIf",t.role)}}function G(t,e){if(1&t&&(c.TgZ(0,"div",32),c._uU(1),c.qZA()),2&t){const t=c.oxw(2).ngIf;c.xp6(1),c.Oqu(t.company)}}function j(t,e){if(1&t){const t=c.EpF();c.TgZ(0,"div",47),c._UZ(1,"img",48),c.TgZ(2,"div",49),c.TgZ(3,"div",50),c._uU(4),c.qZA(),c.TgZ(5,"a",51),c._uU(6),c.qZA(),c.qZA(),c.TgZ(7,"button",52),c.NdJ("click",function(){const e=c.CHM(t).$implicit;return c.oxw(3).removeSocialProfile(e.key)}),c._UZ(8,"mat-icon",53),c.qZA(),c.qZA()}if(2&t){const t=e.$implicit;c.xp6(1),c.Q6J("src",t.value.avatar,c.LSH),c.xp6(3),c.hij("",t.key," Profile"),c.xp6(1),c.Q6J("href",t.value.profileUrl,c.LSH),c.xp6(1),c.Oqu(t.value.profileUrl)}}function X(t,e){if(1&t){const t=c.EpF();c.TgZ(0,"div",54),c._UZ(1,"mat-icon",55),c.TgZ(2,"div",49),c.TgZ(3,"div",50),c._uU(4,"Passport Scan"),c.qZA(),c.TgZ(5,"div"),c._uU(6),c.ALo(7,"formattedFileSize"),c.qZA(),c.qZA(),c.TgZ(8,"button",52),c.NdJ("click",function(){return c.CHM(t),c.oxw(3).removePassportUpload()}),c._UZ(9,"mat-icon",53),c.qZA(),c.qZA()}if(2&t){const t=e.ngIf;c.xp6(6),c.AsE("",t.name," (",c.lcZ(7,2,t.file_size),")")}}const W=function(){return["image/*"]},K=function(t){return{types:t}};function tt(t,e){if(1&t){const t=c.EpF();c.ynx(0),c._UZ(1,"upload-image-control",4),c.YNc(2,E,5,2,"div",5),c.YNc(3,H,5,1,"div",5),c.TgZ(4,"div",6),c.TgZ(5,"div",7),c.TgZ(6,"label",8),c._uU(7,"First name"),c.qZA(),c._UZ(8,"input",9),c.YNc(9,z,2,1,"div",10),c.qZA(),c.TgZ(10,"div",7),c.TgZ(11,"label",11),c._uU(12,"Last name"),c.qZA(),c._UZ(13,"input",12),c.YNc(14,B,2,1,"div",10),c.qZA(),c.qZA(),c.YNc(15,V,25,2,"div",5),c.TgZ(16,"div",7),c.TgZ(17,"label",13),c._uU(18,"Company (optional)"),c.qZA(),c._UZ(19,"input",14),c.YNc(20,G,2,1,"div",10),c.qZA(),c.TgZ(21,"div",15),c.TgZ(22,"div",16),c._uU(23,"Speed up the process by connecting artist social media accounts or uploading your passport scan."),c.qZA(),c.TgZ(24,"div",17),c.TgZ(25,"button",18),c.NdJ("click",function(){return c.CHM(t),c.oxw(2).retrieveSocialProfile("twitter")}),c._UZ(26,"mat-icon",19),c.TgZ(27,"span",0),c._uU(28,"Connect to Twitter"),c.qZA(),c.qZA(),c.TgZ(29,"button",20),c.NdJ("click",function(){return c.CHM(t),c.oxw(2).retrieveSocialProfile("facebook")}),c._UZ(30,"mat-icon",21),c.TgZ(31,"span",0),c._uU(32,"Connect to Facebook"),c.qZA(),c.qZA(),c.TgZ(33,"button",22),c.NdJ("filesSelected",function(e){return c.CHM(t),c.oxw(2).uploadPassportScan(e)}),c._UZ(34,"mat-icon",23),c.TgZ(35,"span",0),c._uU(36,"Upload Passport Scan"),c.qZA(),c.qZA(),c.qZA(),c.TgZ(37,"div",24),c.YNc(38,j,9,4,"div",25),c.ALo(39,"keyvalue"),c.ALo(40,"async"),c.YNc(41,X,10,4,"div",26),c.ALo(42,"async"),c._UZ(43,"upload-progress-bar"),c.qZA(),c.qZA(),c.TgZ(44,"div",27),c.TgZ(45,"a",28),c._uU(46,"Go Back"),c.qZA(),c.TgZ(47,"button",29),c.ALo(48,"async"),c._uU(49,"Submit Request"),c.qZA(),c.qZA(),c.BQk()}if(2&t){const t=e.ngIf,n=c.oxw().ngIf,i=c.oxw();c.xp6(1),c.Q6J("compact",!0),c.xp6(1),c.Q6J("ngIf","become-artist"!==t),c.xp6(1),c.Q6J("ngIf","become-artist"===t),c.xp6(6),c.Q6J("ngIf",n.first_name),c.xp6(5),c.Q6J("ngIf",n.last_name),c.xp6(1),c.Q6J("ngIf","claim-artist"===t),c.xp6(5),c.Q6J("ngIf",n.company),c.xp6(13),c.Q6J("uploadButton",c.VKq(20,K,c.DdM(19,W))),c.xp6(5),c.Q6J("ngForOf",c.lcZ(39,11,c.lcZ(40,13,i.socialProfiles$))),c.xp6(3),c.Q6J("ngIf",c.lcZ(42,15,i.uploadedPassportEntry$)),c.xp6(6),c.Q6J("disabled",c.lcZ(48,17,i.loading$))}}function et(t,e){if(1&t){const t=c.EpF();c.TgZ(0,"form",2),c.NdJ("ngSubmit",function(){return c.CHM(t),c.oxw().requestAccess()}),c.YNc(1,tt,50,22,"ng-container",3),c.ALo(2,"async"),c.qZA()}if(2&t){const t=c.oxw();c.Q6J("formGroup",t.form),c.xp6(1),c.Q6J("ngIf",c.lcZ(2,2,t.requestType$))}}let nt=(()=>{class t{constructor(t,e,n,i,a,r,c,l,u){var d;this.backstage=t,this.fb=e,this.settings=n,this.currentUser=i,this.socialAuth=a,this.uploadQueue=r,this.imageValidator=c,this.router=l,this.route=u,this.uploadedPassportEntry$=new o.X(null),this.socialProfiles$=new o.X(null),this.errors$=new o.X({}),this.loading$=new o.X(!1),this.requestType$=new o.X(null),this.form=this.fb.group({artist:[],artist_name:[this.currentUser.get("display_name")],image:[(null===(d=this.currentUser.primaryArtist())||void 0===d?void 0:d.image_small)||this.currentUser.get("avatar")],first_name:[this.currentUser.get("first_name")],last_name:[this.currentUser.get("last_name")],role:[],company:[""]}),this.requestType$.next(this.route.routeConfig.path.replace("requests/","")),this.requestType$.value===s.n.verifyArtist&&(this.form.get("artist").setValue(this.currentUser.primaryArtist()),this.form.get("artist").disable()),this.requestType$.value===s.n.becomeArtist&&(this.form.get("artist").setValue(this.currentUser.artistPlaceholder()),this.form.get("artist").disable()),this.requestType$.value!==s.n.claimArtist&&this.form.get("role").setValue("artist"),this.requestType$.value!==s.n.becomeArtist&&this.form.get("image").disable()}requestAccess(){var t,e;this.loading$.next(!0);const n={artist_name:this.form.value.artist_name,artist_id:null===(t=this.form.value.artist)||void 0===t?void 0:t.id,type:this.requestType$.value,data:Object.assign(Object.assign({},this.form.value),{passportScanEntryId:null===(e=this.uploadedPassportEntry$.value)||void 0===e?void 0:e.id,socialProfiles:this.socialProfiles$.value})};this.backstage.submitRequest(n).pipe((0,r.x)(()=>this.loading$.next(!1))).subscribe(t=>{this.router.navigate(["/backstage/requests",t.request.id,"request-submitted"],{replaceUrl:!0})},t=>this.errors$.next(t.errors))}retrieveSocialProfile(t){this.socialAuth.retrieveProfile(t).then(e=>{this.socialProfiles$.next(Object.assign(Object.assign({},this.socialProfiles$.value),{[t]:e}))})}uploadPassportScan(t){this.uploadQueue.start(t,{uri:"uploads/images",httpParams:{diskPrefix:"test",disk:"private"},validator:this.imageValidator}).subscribe(t=>{this.uploadedPassportEntry$.next(t.fileEntry)})}removePassportUpload(){this.uploadedPassportEntry$.next(null)}removeSocialProfile(t){const e=Object.assign({},this.socialProfiles$.value);delete e[t],this.socialProfiles$.next(e)}}return t.\u0275fac=function(e){return new(e||t)(c.Y36(l.T),c.Y36(u.qu),c.Y36(d.Z),c.Y36(p.z),c.Y36(m.x),c.Y36(g.A),c.Y36(h.v),c.Y36(a.F0),c.Y36(a.gz))},t.\u0275cmp=c.Xpm({type:t,selectors:[["backstage-request-form"]],decls:4,vars:3,consts:[["trans",""],["ngNativeValidate","","class","many-inputs",3,"formGroup","ngSubmit",4,"ngIf"],["ngNativeValidate","",1,"many-inputs",3,"formGroup","ngSubmit"],[4,"ngIf"],["formControlName","image",3,"compact"],["class","input-container",4,"ngIf"],[1,"inline-inputs-container","many-inputs"],[1,"input-container"],["for","backstage-first-name","trans",""],["type","text","id","backstage-first-name","formControlName","first_name","required",""],["class","error",4,"ngIf"],["for","backstage-last-name","trans",""],["type","text","id","backstage-last-name","formControlName","last_name","required",""],["for","backstage-company","trans",""],["type","text","id","backstage-company","formControlName","company"],[1,"speed-up-container"],["trans","",1,"speed-up-title"],[1,"speed-up-buttons"],["type","button","mat-flat-button","","color","accent",1,"twitter-btn","speed-up-button",3,"click"],["svgIcon","twitter",1,"social-icon"],["type","button","mat-flat-button","","color","accent",1,"facebook-btn","speed-up-button",3,"click"],["svgIcon","facebook",1,"social-icon"],["type","button","mat-flat-button","","color","accent",1,"passport-btn","speed-up-button",3,"uploadButton","filesSelected"],["svgIcon","document-scanner",1,"social-icon"],[1,"attached-verifications"],["class","facebook-profile verification",4,"ngFor","ngForOf"],["class","passport-attachment verification",4,"ngIf"],[1,"backstage-action-buttons"],["type","button","routerLink","/backstage/requests","mat-raised-button","","trans","",1,"backstage-action-button"],["type","submit","mat-raised-button","","color","accent","trans","",1,"backstage-action-button",3,"disabled"],["for","backstage-artist","trans",""],["id","backstage-artist","formControlName","artist",3,"listAll"],[1,"error"],["for","backstage-name","trans",""],["type","text","id","backstage-name","formControlName","artist_name","required",""],["for","backstage-role","trans",""],["type","text","id","backstage-role","formControlName","role","required",""],["disabled","","trans","",3,"value"],["value","artist","trans",""],["value","agent","trans",""],["value","composer","trans",""],["value","label","trans",""],["value","manager","trans",""],["value","musician","trans",""],["value","producer","trans",""],["value","publisher","trans",""],["value","songwriter","trans",""],[1,"facebook-profile","verification"],["alt","",1,"verification-img",3,"src"],[1,"verification-details"],["trans","",1,"verification-name"],["target","_blank",1,"verification-url",3,"href"],["type","button","mat-icon-button","",1,"remove-verification",3,"click"],["svgIcon","close"],[1,"passport-attachment","verification"],["svgIcon","document-scanner",1,"verification-img"]],template:function(t,e){1&t&&(c.TgZ(0,"h1",0),c._uU(1,"Tell us about yourself"),c.qZA(),c.YNc(2,et,3,4,"form",1),c.ALo(3,"async")),2&t&&(c.xp6(2),c.Q6J("ngIf",c.lcZ(3,1,e.errors$)))},directives:[f.P,i.O5,u.JL,u.sg,b.V,u.JJ,u.u,u.Fj,u.Q7,x.lW,v.Hw,Z.c,i.sg,_.o,a.yS,x.zs,$,u.EJ,u.YN,u.Kr],pipes:[i.Ov,i.Nd,S.y],styles:["[_nghost-%COMP%]{display:block;max-width:800px;margin:auto}h1[_ngcontent-%COMP%]{text-align:center}upload-image-control[_ngcontent-%COMP%]{margin:15px auto;width:160px;height:160px;border-radius:50%}.input-container[_ngcontent-%COMP%]   input[_ngcontent-%COMP%], .input-container[_ngcontent-%COMP%]   select[_ngcontent-%COMP%], .input-container[_ngcontent-%COMP%]     .fake-input{height:55px}.speed-up-container[_ngcontent-%COMP%]{padding:15px 0 30px;border-bottom:1px solid var(--be-divider-lighter)}.speed-up-title[_ngcontent-%COMP%]{font-size:1.5rem;margin-bottom:15px}.speed-up-button[_ngcontent-%COMP%]{margin-right:10px}.facebook-btn[_ngcontent-%COMP%]{background:#3b5998}.twitter-btn[_ngcontent-%COMP%]{background:#1da1f2}.social-icon[_ngcontent-%COMP%]{margin-right:5px}upload-progress-bar[_ngcontent-%COMP%]{position:absolute;bottom:0;width:100%}.attached-verifications[_ngcontent-%COMP%]:not(:empty){position:relative}.attached-verifications[_ngcontent-%COMP%]:not(:empty):not(:empty){margin-top:20px}.verification[_ngcontent-%COMP%]{display:flex;align-items:center;border:1px solid var(--be-divider-default);border-radius:4px;padding:10px;margin-bottom:10px}.verification-details[_ngcontent-%COMP%]{overflow:hidden}.verification-url[_ngcontent-%COMP%]{display:block;overflow:hidden;text-overflow:ellipsis}.verification-img[_ngcontent-%COMP%]{height:35px;width:35px;-o-object-fit:cover;object-fit:cover;flex-shrink:0;margin-right:10px}.verification-name[_ngcontent-%COMP%]{font-size:1.3rem;color:var(--be-secondary-text);text-transform:capitalize}.remove-verification[_ngcontent-%COMP%]{margin-left:auto}"],changeDetection:0}),t})(),it=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=c.Xpm({type:t,selectors:[["backstage-request-submitted"]],decls:14,vars:0,consts:[[1,"text-align-center"],["svgIcon","check",1,"check-icon"],["trans",""],[1,"backstage-action-buttons"],["routerLink","/","mat-flat-button","","color","accent","trans","",1,"backstage-action-button"]],template:function(t,e){1&t&&(c.TgZ(0,"div",0),c._UZ(1,"mat-icon",1),c.qZA(),c.TgZ(2,"h1",2),c._uU(3,"We've got your request"),c.qZA(),c.TgZ(4,"ul"),c.TgZ(5,"li"),c._uU(6,"Our support team will review it and send you an email within 3 days!"),c.qZA(),c.TgZ(7,"li"),c._uU(8,"Don't submit another request until you hear from us."),c.qZA(),c.TgZ(9,"li"),c._uU(10,"If this artist profile is already claimed, ask an admin on your team to invite you."),c.qZA(),c.qZA(),c.TgZ(11,"div",3),c.TgZ(12,"a",4),c._uU(13,"Got It"),c.qZA(),c.qZA())},directives:[v.Hw,f.P,a.yS,x.zs],styles:["[_nghost-%COMP%]{display:block;margin:auto;max-width:800px}.check-icon[_ngcontent-%COMP%]{width:64px;height:64px;line-height:64px;margin-bottom:25px}h1[_ngcontent-%COMP%]{text-align:center;margin-bottom:25px}ul[_ngcontent-%COMP%]{font-size:1.6rem;line-height:28px}.text-align-center[_ngcontent-%COMP%]{text-align:center}.action-buttons[_ngcontent-%COMP%]{margin-top:70px;justify-content:center}.backstage-action-buttons[_ngcontent-%COMP%]{justify-content:center}"],changeDetection:0}),t})();function at(t,e){1&t&&(c.ynx(0),c._uU(1,"Get verified"),c.BQk())}function ot(t,e){1&t&&(c.ynx(0),c._uU(1,"Become an artist"),c.BQk())}const rt=function(t){return{sitename:t}},st=function(t){return[t]};let ct=(()=>{class t{constructor(t,e){this.settings=t,this.currentUser=e,this.currentUserIsArtist=!1,this.currentUserIsArtist=!!this.currentUser.primaryArtist()}}return t.\u0275fac=function(e){return new(e||t)(c.Y36(d.Z),c.Y36(p.z))},t.\u0275cmp=c.Xpm({type:t,selectors:[["backstage-type-selector"]],decls:14,vars:8,consts:[["trans","",3,"transValues"],["trans",""],[1,"claim-row"],[1,"claim-col",3,"routerLink"],["trans","",1,"title"],[4,"ngIf"],["src","client/assets/images/backstage/claim-artist.jpg","alt",""],["routerLink","claim-artist",1,"claim-col"],["src","client/assets/images/backstage/claim-label.jpg","alt",""]],template:function(t,e){1&t&&(c.TgZ(0,"h1",0),c._uU(1,"Get Access to :sitename for Artists"),c.qZA(),c.TgZ(2,"h2",1),c._uU(3,"First, select the type of your request."),c.qZA(),c.TgZ(4,"div",2),c.TgZ(5,"a",3),c.TgZ(6,"div",4),c.YNc(7,at,2,0,"ng-container",5),c.YNc(8,ot,2,0,"ng-container",5),c.qZA(),c._UZ(9,"img",6),c.qZA(),c.TgZ(10,"a",7),c.TgZ(11,"div",4),c._uU(12,"Claim existing artist"),c.qZA(),c._UZ(13,"img",8),c.qZA(),c.qZA()),2&t&&(c.Q6J("transValues",c.VKq(4,rt,e.settings.get("branding.site_name"))),c.xp6(5),c.Q6J("routerLink",c.VKq(6,st,e.currentUserIsArtist?"verify-artist":"become-artist")),c.xp6(2),c.Q6J("ngIf",e.currentUserIsArtist),c.xp6(1),c.Q6J("ngIf",!e.currentUserIsArtist))},directives:[f.P,a.yS,i.O5],styles:["[_nghost-%COMP%]{display:block;max-width:800px;margin:auto}.claim-row[_ngcontent-%COMP%]{display:flex;justify-content:space-between;margin-top:25px}.claim-col[_ngcontent-%COMP%]{display:flex;align-items:center;flex-direction:column;border:2px solid var(--be-divider-default);border-radius:10px;width:calc(50% - 30px);padding:35px 25px;transition:box-shadow .2s ease 0s;color:inherit}.claim-col[_ngcontent-%COMP%]:hover{box-shadow:0 7px 9px -4px rgba(0,0,0,.2),0 14px 21px 2px rgba(0,0,0,.141),0 5px 26px 4px rgba(0,0,0,.122);background:var(--be-background)}.claim-col[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:132px;height:132px;border-radius:50%;-o-object-fit:cover;object-fit:cover}.claim-col[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{font-size:1.8rem;font-weight:500;margin-bottom:10px}"],changeDetection:0}),t})();var lt=n(69407),ut=n(44434),dt=n(35718),pt=n(60983),mt=n(9348),gt=n(44666),ht=n(85408),ft=n(3786),bt=n(8208),xt=n(66142),vt=n(15381),Zt=n(10685),_t=n(24688),At=n(90436),yt=n(70236),Ct=n(1303),kt=n(50298),wt=n(76403),Tt=n(63297);const qt=function(t){return{artist:t}};function Ot(t,e){if(1&t&&(c.TgZ(0,"a",13),c._uU(1,"New Album"),c.qZA()),2&t){const t=c.oxw();c.Q6J("routerLink",t.urls.createAlbum(t.insideAdmin))("queryParams",c.VKq(3,qt,t.encodedArtist))("disabled",!t.artist)}}function It(t,e){1&t&&(c.TgZ(0,"p",14),c._UZ(1,"mat-icon",15),c.TgZ(2,"span",16),c._uU(3,"Save artist first to enable album creation."),c.qZA(),c.qZA())}function Pt(t,e){if(1&t){const t=c.EpF();c.TgZ(0,"button",26),c.NdJ("click",function(){c.CHM(t);const e=c.oxw().$implicit;return c.oxw().maybeDeleteAlbum(e)}),c.ALo(1,"trans"),c._UZ(2,"mat-icon",27),c.qZA()}2&t&&c.Q6J("matTooltip",c.lcZ(1,1,"Delete album"))}function Mt(t,e){if(1&t&&(c.TgZ(0,"tr"),c.TgZ(1,"td"),c.TgZ(2,"div",17),c._UZ(3,"media-image",18),c.TgZ(4,"span"),c._uU(5),c.qZA(),c.qZA(),c.qZA(),c.TgZ(6,"td",19),c._uU(7),c.qZA(),c.TgZ(8,"td",20),c._uU(9),c.qZA(),c.TgZ(10,"td",21),c._uU(11),c.qZA(),c.TgZ(12,"td",22),c.TgZ(13,"a",23),c.ALo(14,"trans"),c._UZ(15,"mat-icon",24),c.qZA(),c.YNc(16,Pt,3,3,"button",25),c.qZA(),c.qZA()),2&t){const t=e.$implicit,n=c.oxw();c.xp6(3),c.Q6J("media",t),c.xp6(2),c.Oqu(t.name),c.xp6(2),c.Oqu(t.release_date?t.release_date:"\u2013"),c.xp6(2),c.Oqu(t.views),c.xp6(2),c.Oqu(t.tracks_count?t.tracks_count:"\u2013"),c.xp6(2),c.Q6J("routerLink",n.urls.editAlbum(t,n.insideAdmin))("queryParams",c.VKq(11,qt,n.encodedArtist))("matTooltip",c.lcZ(14,9,"Edit album")),c.xp6(3),c.Q6J("ngIf",n.currentUser.hasPermission("albums.delete"))}}function Ut(t,e){1&t&&(c.TgZ(0,"no-results-message",28),c.TgZ(1,"span",29),c._uU(2,"This artist has no albums yet"),c.qZA(),c.qZA())}let Jt=(()=>{class t{constructor(t,e,n,i,a,o,r){this.modal=t,this.albumsApi=e,this.currentUser=n,this.images=i,this.datatable=a,this.urls=o,this.router=r,this.albums=[],this.albums$=this.datatable.data$}ngOnChanges(t){this.artist&&(this.encodedArtist=btoa(JSON.stringify({id:this.artist.id,name:this.artist.name,image_small:this.artist.image_small})))}ngOnInit(){this.insideAdmin=this.router.url.includes("admin"),this.datatable.init({initialData:this.albums?this.albums:[]})}maybeDeleteAlbum(t){this.modal.show(bt.z,{title:"Delete Album",body:"Are you sure you want to delete this album?",ok:"Delete"}).beforeClosed().subscribe(e=>(0,ft.mG)(this,void 0,void 0,function*(){!e||this.albumsApi.delete([t.id]).subscribe(()=>{this.datatable.data=this.datatable.data.filter(e=>e.id!==t.id)})}))}}return t.\u0275fac=function(e){return new(e||t)(c.Y36(vt.u),c.Y36(Zt.R),c.Y36(_t.I),c.Y36(At.v),c.Y36(xt.x),c.Y36(pt.J),c.Y36(a.F0))},t.\u0275cmp=c.Xpm({type:t,selectors:[["artist-albums-table"]],inputs:{artist:"artist",albums:"albums"},features:[c._Bn([xt.x]),c.TTD],decls:22,vars:6,consts:[[1,"datatable"],["pluralResourceName","albums"],["leftContent",""],[1,"new-album-container"],["mat-raised-button","","color","accent","trans","",3,"routerLink","queryParams","disabled",4,"ngIf"],["class","save-message",4,"ngIf"],[1,"material-table"],["table-sort-header","name","trans",""],["table-sort-header","","trans",""],["table-sort-header","views","trans",""],["table-sort-header","tracks_count","trans",""],[4,"ngFor","ngForOf"],["svgImage","music.svg",4,"ngIf"],["mat-raised-button","","color","accent","trans","",3,"routerLink","queryParams","disabled"],[1,"save-message"],["svgIcon","warning"],["trans",""],[1,"column-with-image"],["default","album",3,"media"],["data-label","Release Date"],["data-label","Views"],["data-label","Number of Tracks"],[1,"edit-column"],["mat-icon-button","",3,"routerLink","queryParams","matTooltip"],["svgIcon","edit"],["mat-icon-button","","trans","",3,"matTooltip","click",4,"ngIf"],["mat-icon-button","","trans","",3,"matTooltip","click"],["svgIcon","delete"],["svgImage","music.svg"],["primary-text","","trans",""]],template:function(t,e){1&t&&(c.TgZ(0,"div",0),c.TgZ(1,"datatable-header",1),c.ynx(2,2),c.TgZ(3,"div",3),c.YNc(4,Ot,2,5,"a",4),c.YNc(5,It,4,0,"p",5),c.qZA(),c.BQk(),c.qZA(),c.TgZ(6,"table",6),c.TgZ(7,"thead"),c.TgZ(8,"tr"),c.TgZ(9,"th",7),c._uU(10,"Album"),c.qZA(),c.TgZ(11,"th",8),c._uU(12,"Release Date"),c.qZA(),c.TgZ(13,"th",9),c._uU(14,"Views"),c.qZA(),c.TgZ(15,"th",10),c._uU(16,"Number Of Tracks"),c.qZA(),c._UZ(17,"th"),c.qZA(),c.qZA(),c.TgZ(18,"tbody"),c.YNc(19,Mt,17,13,"tr",11),c.ALo(20,"async"),c.qZA(),c.qZA(),c.YNc(21,Ut,3,0,"no-results-message",12),c.qZA()),2&t&&(c.xp6(4),c.Q6J("ngIf",e.currentUser.hasPermission("music.create")),c.xp6(1),c.Q6J("ngIf",!e.artist),c.xp6(14),c.Q6J("ngForOf",c.lcZ(20,4,e.albums$)),c.xp6(2),c.Q6J("ngIf",!e.datatable.data.length))},directives:[yt.G,i.O5,Ct.p,f.P,i.sg,x.zs,a.yS,v.Hw,P.P,kt.gM,x.lW,wt.U],pipes:[i.Ov,Tt.R],styles:["artist-albums-table{display:block}artist-albums-table .new-album-container{display:flex;align-items:center}artist-albums-table .no-results-message{margin-top:35px}artist-albums-table .save-message{color:var(--be-secondary-text);font-size:1.3rem;margin-left:25px}artist-albums-table .save-message .mat-icon{vertical-align:middle;margin-right:5px;width:18px;height:18px;line-height:18px}\n"],encapsulation:2}),t})();var Qt=n(32080);function Ft(t,e){1&t&&(c.TgZ(0,"button",28),c._uU(1,"Update"),c.qZA())}function Nt(t,e){1&t&&(c.TgZ(0,"button",28),c._uU(1,"Create"),c.qZA())}function Yt(t,e){if(1&t&&(c.TgZ(0,"div",29),c._uU(1),c.qZA()),2&t){const t=c.oxw();c.xp6(1),c.Oqu(t.errors.name)}}function $t(t,e){if(1&t&&(c.TgZ(0,"div",29),c._uU(1),c.qZA()),2&t){const t=c.oxw();c.xp6(1),c.Oqu(t.errors.genres)}}function St(t,e){1&t&&(c.TgZ(0,"div",9),c.TgZ(1,"label",33),c._uU(2,"Spotify ID"),c.qZA(),c._UZ(3,"input",34),c.qZA())}function Dt(t,e){if(1&t&&(c.TgZ(0,"div",29),c._uU(1),c.qZA()),2&t){const t=c.oxw(2);c.xp6(1),c.Oqu(t.errors.verified)}}function Et(t,e){if(1&t&&(c.ynx(0),c.YNc(1,St,4,0,"div",30),c.TgZ(2,"div",31),c.TgZ(3,"mat-slide-toggle",32),c._uU(4,"Verified"),c.qZA(),c.YNc(5,Dt,2,1,"div",12),c.qZA(),c.BQk()),2&t){const t=c.oxw();c.xp6(1),c.Q6J("ngIf",t.settings.get("spotify_is_setup")),c.xp6(4),c.Q6J("ngIf",t.errors.verified)}}const Lt=function(){return{diskPrefix:"bio"}},Ht=function(t){return{httpParams:t}};function zt(t,e){if(1&t){const t=c.EpF();c.TgZ(0,"upload-image-control",35),c.NdJ("fileDeleted",function(){const e=c.CHM(t).index;return c.oxw().removeProfileImage(e)}),c.qZA()}if(2&t){const t=e.$implicit;c.Q6J("formControlName",e.index)("uploadConfig",c.VKq(4,Ht,c.DdM(3,Lt)))("buttonText",t.value?"Replace Image":"Upload Image")}}let Bt=(()=>{class t{constructor(t,e,n,i,a,o,r,s,c,l){this.settings=t,this.uploadQueue=e,this.artists=n,this.route=i,this.toast=a,this.router=o,this.fb=r,this.cd=s,this.search=c,this.urls=l,this.insideAdmin=!1,this.errors={},this.albums=[],this.form=this.fb.group({name:[""],verified:[""],image_small:[""],spotify_id:[""],genres:[[]],description:[""],country:[""],city:[""],profile_images:this.fb.array([]),links:[[]]}),this.suggestGenreFn=t=>this.search.media(t,{types:[lt.J],limit:5}).pipe((0,T.U)(t=>t.results.genres.map(t=>t.name)))}ngOnInit(){this.bindToRouteData(),this.insideAdmin=this.router.url.includes("admin")}createOrUpdate(){this.artist?this.update():this.create()}create(){return this.artists.create(this.form.value).subscribe(t=>{this.form.markAsPristine(),this.artist=t.artist,this.toast.open("Artist created."),this.router.navigate(this.urls.editArtist(this.artist.id,!0),{replaceUrl:!0}),this.errors={}},t=>{this.errors=t.errors,this.cd.detectChanges()})}update(){return this.artists.update(this.artist.id,this.form.value).subscribe(()=>{this.form.markAsPristine(),this.toast.open("Artist updated."),this.router.navigate(["/admin/artists"])},t=>{this.errors=t.errors,this.cd.detectChanges()})}profileImagesArray(){return this.form.get("profile_images")}bindToRouteData(){this.route.data.subscribe(t=>{var e,n,i;t.api&&(this.artist=t.api.artist,this.albums=t.api.albums,this.form.patchValue({name:t.api.artist.name,verified:t.api.artist.verified,image_small:t.api.artist.image_small,spotify_id:t.api.artist.spotify_id,genres:(t.api.artist.genres||[]).map(t=>t.name),description:null===(e=t.api.artist.profile)||void 0===e?void 0:e.description,country:null===(n=t.api.artist.profile)||void 0===n?void 0:n.country,city:null===(i=t.api.artist.profile)||void 0===i?void 0:i.city,profile_images:[],links:t.api.artist.links}),(t.api.artist.profile_images||[]).forEach(t=>{this.addProfileImage(t.url)}))}),this.addProfileImage()}addProfileImage(t=""){this.profileImagesArray().push(new u.NI(t))}removeProfileImage(t){this.profileImagesArray().removeAt(t)}canDeactivate(){return!this.form.dirty}}return t.\u0275fac=function(e){return new(e||t)(c.Y36(d.Z),c.Y36(g.A),c.Y36(ut.c),c.Y36(a.gz),c.Y36(dt.F),c.Y36(a.F0),c.Y36(u.qu),c.Y36(c.sBO),c.Y36(q.o),c.Y36(pt.J))},t.\u0275cmp=c.Xpm({type:t,selectors:[["crupdate-artist-page"]],features:[c._Bn([g.A])],decls:46,vars:20,consts:[[1,"material-panel"],["ngNativeValidate","",1,"edit-main-info",3,"formGroup","ngSubmit"],[1,"left-col"],["formControlName","image_small","diskPrefix","artist"],["type","submit","mat-raised-button","","color","accent","class","main-button","trans","",4,"ngIf"],[1,"right-col","many-inputs","admin-artist-edit-inputs"],["color","accent","animationDuration","0ms"],[3,"label"],[1,"many-inputs","tab"],[1,"input-container"],["for","artist-name","trans",""],["type","text","formControlName","name","id","artist-name","required","",3,"readOnly"],["class","error",4,"ngIf"],["for","artist-genres","trans",""],["placeholder","+Add genre","id","artist-genres","formControlName","genres",3,"suggestFn"],[4,"ngIf"],["formControlName","links"],["for","artist-country","trans",""],["formControlName","country","id","artist-country"],["for","artist-city","trans",""],["formControlName","city","id","artist-city"],["for","artist-bio","trans",""],["formControlName","description","id","artist-bio","rows","8"],[1,"profile-images"],["trans","",1,"profile-images-title"],["formArrayName","profile_images",1,"profile-images-wrapper"],[3,"formControlName","uploadConfig","buttonText","fileDeleted",4,"ngFor","ngForOf"],[3,"albums","artist"],["type","submit","mat-raised-button","","color","accent","trans","",1,"main-button"],[1,"error"],["class","input-container",4,"ngIf"],[1,"setting-toggle-container"],["formControlName","verified","trans",""],["for","artist-spotify-id","trans",""],["type","text","id","artist-spotify-id","formControlName","spotify_id","minlength","22","maxlength","22"],[3,"formControlName","uploadConfig","buttonText","fileDeleted"]],template:function(t,e){1&t&&(c.TgZ(0,"div",0),c.TgZ(1,"form",1),c.NdJ("ngSubmit",function(){return e.createOrUpdate()}),c.TgZ(2,"div",2),c._UZ(3,"upload-image-control",3),c.YNc(4,Ft,2,0,"button",4),c.YNc(5,Nt,2,0,"button",4),c.qZA(),c.TgZ(6,"div",5),c.TgZ(7,"mat-tab-group",6),c.TgZ(8,"mat-tab",7),c.ALo(9,"trans"),c.TgZ(10,"div",8),c.TgZ(11,"div",9),c.TgZ(12,"label",10),c._uU(13,"Name"),c.qZA(),c._UZ(14,"input",11),c.YNc(15,Yt,2,1,"div",12),c.qZA(),c.TgZ(16,"div",9),c.TgZ(17,"label",13),c._uU(18,"Genres"),c.qZA(),c._UZ(19,"chip-input",14),c.YNc(20,$t,2,1,"div",12),c.qZA(),c.YNc(21,Et,6,2,"ng-container",15),c.qZA(),c.qZA(),c.TgZ(22,"mat-tab",7),c.ALo(23,"trans"),c._UZ(24,"profile-links-form-control",16),c.qZA(),c.TgZ(25,"mat-tab",7),c.ALo(26,"trans"),c.TgZ(27,"div",8),c.TgZ(28,"div",9),c.TgZ(29,"label",17),c._uU(30,"Country"),c.qZA(),c._UZ(31,"input",18),c.qZA(),c.TgZ(32,"div",9),c.TgZ(33,"label",19),c._uU(34,"City"),c.qZA(),c._UZ(35,"input",20),c.qZA(),c.TgZ(36,"div",9),c.TgZ(37,"label",21),c._uU(38,"Biography"),c.qZA(),c._UZ(39,"textarea",22),c.qZA(),c.TgZ(40,"div",23),c.TgZ(41,"div",24),c._uU(42,"Biography Images"),c.qZA(),c.TgZ(43,"div",25),c.YNc(44,zt,1,6,"upload-image-control",26),c.qZA(),c.qZA(),c.qZA(),c.qZA(),c.qZA(),c.qZA(),c.qZA(),c._UZ(45,"artist-albums-table",27),c.qZA()),2&t&&(c.xp6(1),c.Q6J("formGroup",e.form),c.xp6(3),c.Q6J("ngIf",e.artist),c.xp6(1),c.Q6J("ngIf",!e.artist),c.xp6(3),c.Q6J("label",c.lcZ(9,14,"Details")),c.xp6(6),c.Q6J("readOnly",!e.insideAdmin),c.xp6(1),c.Q6J("ngIf",e.errors.name),c.xp6(4),c.Q6J("suggestFn",e.suggestGenreFn),c.xp6(1),c.Q6J("ngIf",e.errors.genres),c.xp6(1),c.Q6J("ngIf",e.insideAdmin),c.xp6(1),c.Q6J("label",c.lcZ(23,16,"Links")),c.xp6(3),c.Q6J("label",c.lcZ(26,18,"Biography")),c.xp6(19),c.Q6J("ngForOf",e.profileImagesArray().controls),c.xp6(1),c.Q6J("albums",e.albums)("artist",e.artist))},directives:[u.JL,u.sg,b.V,u.JJ,u.u,i.O5,mt.SP,mt.uX,f.P,u.Fj,u.Q7,gt.S,ht.z,u.CE,i.sg,Jt,x.lW,Qt.Rr,u.wO,u.nD],pipes:[Tt.R],styles:[".edit-main-info[_ngcontent-%COMP%]{display:flex}.edit-main-info[_ngcontent-%COMP%]   .left-col[_ngcontent-%COMP%]{width:220px;flex-shrink:0;margin-right:25px}.edit-main-info[_ngcontent-%COMP%]   .left-col[_ngcontent-%COMP%]   .main-button[_ngcontent-%COMP%]{display:block;margin-top:8px;width:100%;line-height:42px}.edit-main-info[_ngcontent-%COMP%]   .left-col[_ngcontent-%COMP%]   .main-button[_ngcontent-%COMP%]   .mat-icon[_ngcontent-%COMP%]{display:inline-block;vertical-align:middle}.edit-main-info[_ngcontent-%COMP%]   .right-col[_ngcontent-%COMP%]{flex:1 1 auto;min-width:0}@media only screen and (max-width: 768px){.edit-main-info[_ngcontent-%COMP%]{display:block}.edit-main-info[_ngcontent-%COMP%]   .left-col[_ngcontent-%COMP%]{max-width:220px;margin:auto auto 25px}}.tab[_ngcontent-%COMP%]{padding-top:20px}.profile-images[_ngcontent-%COMP%]{padding-top:20px;margin-top:30px;border-top:1px solid var(--be-divider-lighter)}.profile-images-title[_ngcontent-%COMP%]{font-size:1.5rem;margin-bottom:10px}.profile-images-wrapper[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap}.profile-images-wrapper[_ngcontent-%COMP%]   upload-image-control[_ngcontent-%COMP%]{margin:0 15px 15px 0}artist-albums-table[_ngcontent-%COMP%]{padding-top:35px;margin-top:35px;border-top:1px solid var(--be-divider-lighter)}"],changeDetection:0}),t})();var Rt=n(85816),Vt=n(8117);let Gt=(()=>{class t{constructor(t,e){this.artists=t,this.router=e}resolve(t,e){const n=+t.paramMap.get("id");return this.artists.get(n,{with:["simplifiedAlbums","genres","profile"],albumsPerPage:50,forEditing:!0}).pipe((0,w.K)(()=>(this.router.navigate(["/"]),Vt.E)),(0,Rt.zg)(t=>t.artist?(0,A.of)(t):(this.router.navigate(["/"]),Vt.E)))}}return t.\u0275fac=function(e){return new(e||t)(c.LFG(ut.c),c.LFG(a.F0))},t.\u0275prov=c.Yz7({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();var jt=n(75766),Xt=n(39698),Wt=n(1625),Kt=n(41880),te=n(53534),ee=n(24890),ne=n(58480),ie=n(47332),ae=n(65718),oe=n(18715),re=n(68756),se=n(16850),ce=n(82655);let le=(()=>{class t extends oe.c{constructor(){super(...arguments),this.DEFAULT_MAX_SIZE_MB=50,this.showToast=!0}initValidations(){const t=[new re.p({maxSize:this.getMaxFileSize()},this.i18n),new ce.p({types:["audio","video"]},this.i18n)];this.validations.push(...t)}getMaxFileSize(){return this.settings.get("uploads.max_size",(0,se.F)(this.DEFAULT_MAX_SIZE_MB,"MB"))}}return t.\u0275fac=function(){let e;return function(n){return(e||(e=c.n5z(t)))(n||t)}}(),t.\u0275prov=c.Yz7({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();var ue=n(38182),de=n(82516),pe=n(53466),me=n(65924),ge=n(79243),he=n(24298);const fe=["searchInput"];function be(t,e){if(1&t){const t=c.EpF();c.TgZ(0,"mat-chip",10),c.NdJ("removed",function(){const e=c.CHM(t).$implicit;return c.oxw().deselectArtist(e)}),c._UZ(1,"img",11),c._uU(2),c._UZ(3,"mat-icon",12),c.qZA()}if(2&t){const t=e.$implicit;c.Q6J("removable",!0),c.xp6(1),c.Q6J("src",t.image_small,c.LSH)("alt",t.name),c.xp6(1),c.hij(" ",t.name," ")}}function xe(t,e){if(1&t&&(c.TgZ(0,"mat-option",13),c._UZ(1,"img",11),c.TgZ(2,"span"),c._uU(3),c.qZA(),c.qZA()),2&t){const t=e.$implicit;c.Q6J("value",t),c.xp6(1),c.Q6J("src",t.image_small,c.LSH)("alt",t.name+" image"),c.xp6(2),c.Oqu(t.name)}}function ve(t,e){if(1&t&&(c.TgZ(0,"div",14),c._uU(1),c.qZA()),2&t){const t=c.oxw();c.xp6(1),c.Oqu(t.error)}}let Ze=(()=>{class t{constructor(t,e){this.search=t,this.currentUser=e,this.searchControl=new u.NI,this.value$=new o.X([]),this.searchResults$=new o.X([])}ngOnInit(){this.bindSearchControl()}ngAfterViewInit(){(0,de.R)(this.searchInput.nativeElement,"focus").pipe((0,pe.q)(1)).subscribe(()=>{this.findMatches()})}writeValue(t){this.value$.next(t)}registerOnChange(t){this.propagateChange=t}registerOnTouched(){}deselectArtist(t){const e=this.value$.value.filter(e=>e.id!==t.id);this.value$.next(e),this.propagateChange(this.value$.value)}selectArtist(t){-1===this.value$.value.findIndex(e=>e.id===t.id)&&(this.value$.next([...this.value$.value,t]),this.propagateChange(this.value$.value)),this.searchInput.nativeElement.blur()}bindSearchControl(){this.searchControl.valueChanges.pipe((0,C.x)(),(0,y.b)(250)).subscribe(t=>{if("string"!=typeof t)return(0,A.of)([]);this.findMatches(t)})}findMatches(t){this.search.suggestArtists({query:t,limit:7}).subscribe(t=>this.searchResults$.next(t.artists))}displayFn(t){return null}}return t.\u0275fac=function(e){return new(e||t)(c.Y36(q.o),c.Y36(_t.I))},t.\u0275cmp=c.Xpm({type:t,selectors:[["track-artist-control"]],viewQuery:function(t,e){if(1&t&&c.Gf(fe,5),2&t){let t;c.iGM(t=c.CRH())&&(e.searchInput=t.first)}},hostAttrs:[1,"custom-control"],inputs:{error:"error",id:"id"},features:[c._Bn([g.A,{provide:u.JU,useExisting:t,multi:!0}])],decls:13,vars:13,consts:[[1,"input-container"],["trans","",3,"for"],["type","text","placeholder","Search artists...","trans-placeholder","",3,"id","formControl","matAutocomplete"],["searchInput",""],[3,"selectable"],["class","chip-with-image",3,"removable","removed",4,"ngFor","ngForOf"],[1,"media-autocomplete-panel",3,"displayWith","optionSelected"],["artistAuto","matAutocomplete"],[3,"value",4,"ngFor","ngForOf"],["class","error",4,"ngIf"],[1,"chip-with-image",3,"removable","removed"],[3,"src","alt"],["svgIcon","cancel","matChipRemove",""],[3,"value"],[1,"error"]],template:function(t,e){if(1&t&&(c.TgZ(0,"div",0),c.TgZ(1,"label",1),c._uU(2,"Artists"),c.qZA(),c._UZ(3,"input",2,3),c.TgZ(5,"mat-chip-list",4),c.YNc(6,be,4,4,"mat-chip",5),c.ALo(7,"async"),c.qZA(),c.TgZ(8,"mat-autocomplete",6,7),c.NdJ("optionSelected",function(t){return e.selectArtist(t.option.value)}),c.YNc(10,xe,4,4,"mat-option",8),c.ALo(11,"async"),c.qZA(),c.YNc(12,ve,2,1,"div",9),c.qZA()),2&t){const t=c.MAs(9);c.xp6(1),c.Q6J("for",e.id),c.xp6(2),c.Q6J("id",e.id)("formControl",e.searchControl)("matAutocomplete",t),c.xp6(2),c.Q6J("selectable",!1),c.xp6(1),c.Q6J("ngForOf",c.lcZ(7,9,e.value$)),c.xp6(2),c.Q6J("displayWith",e.displayFn),c.xp6(2),c.Q6J("ngForOf",c.lcZ(11,11,e.searchResults$)),c.xp6(2),c.Q6J("ngIf",e.error)}},directives:[f.P,u.Fj,me.ZL,u.JJ,u.oH,ge.qn,i.sg,me.XC,i.O5,ge.HS,v.Hw,ge.qH,he.ey],pipes:[i.Ov],styles:["[_nghost-%COMP%]{display:block}.mat-chip-list[_ngcontent-%COMP%]{display:block;margin-top:15px}.mat-standard-chip.chip-with-image[_ngcontent-%COMP%]{padding-left:0}.mat-standard-chip.chip-with-image[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:32px;height:32px;-o-object-fit:cover;object-fit:cover;border-radius:16px;margin-right:8px}"],changeDetection:0}),t})();var _e=n(8095),Ae=n(15565),ye=n(365);function Ce(t,e){if(1&t&&(c.TgZ(0,"div",7),c._uU(1),c.TgZ(2,"span",8),c._uU(3,"left"),c.qZA(),c.qZA()),2&t){const t=c.oxw();c.xp6(1),c.hij(" ",t.progress.eta," ")}}function ke(t,e){1&t&&(c._UZ(0,"mat-icon",9),c.ALo(1,"trans")),2&t&&c.Q6J("matTooltip",c.lcZ(1,1,e.ngIf))}function we(t,e){1&t&&(c.TgZ(0,"span",8),c._uU(1,"Upload complete."),c.qZA())}function Te(t,e){1&t&&(c.TgZ(0,"span",8),c._uU(1,"We are processing your track for playback\u2026"),c.qZA())}function qe(t,e){if(1&t){const t=c.EpF();c.TgZ(0,"span",12),c.NdJ("click",function(){return c.CHM(t),c.oxw(2).upload.cancel()}),c._uU(1,"Cancel"),c.qZA()}}function Oe(t,e){if(1&t&&(c.YNc(0,we,2,0,"span",10),c.YNc(1,Te,2,0,"span",10),c.ALo(2,"async"),c.YNc(3,qe,2,0,"span",11),c.ALo(4,"async")),2&t){const t=c.oxw();c.Q6J("ngIf",t.upload.completed),c.xp6(1),c.Q6J("ngIf",c.lcZ(2,3,t.upload.processing$)),c.xp6(2),c.Q6J("ngIf",!c.lcZ(4,5,t.upload.processing$)&&!t.upload.completed)}}let Ie=(()=>{class t{constructor(t){this.cd=t}ngOnChanges(){this.subscription&&this.subscription.unsubscribe(),this.subscription=this.upload.progress$.pipe((0,_e.p)(260,Ae.Z,{leading:!0,trailing:!0})).subscribe(t=>{this.progress=t,this.cd.detectChanges()})}ngOnDestroy(){this.subscription.unsubscribe()}}return t.\u0275fac=function(e){return new(e||t)(c.Y36(c.sBO))},t.\u0275cmp=c.Xpm({type:t,selectors:[["track-upload-header"]],inputs:{upload:"upload"},features:[c.TTD],decls:11,vars:10,consts:[[1,"meta"],[1,"name"],["class","time-left",4,"ngIf"],[1,"actions"],["class","error-icon action-icon","svgIcon","error-outline","matTooltipPosition","left",3,"matTooltip",4,"ngIf","ngIfElse"],["noError",""],["color","accent",3,"mode","value"],[1,"time-left"],["trans",""],["svgIcon","error-outline","matTooltipPosition","left",1,"error-icon","action-icon",3,"matTooltip"],["trans","",4,"ngIf"],["class","cancel-button","trans","",3,"click",4,"ngIf"],["trans","",1,"cancel-button",3,"click"]],template:function(t,e){if(1&t&&(c.TgZ(0,"div",0),c.TgZ(1,"div",1),c._uU(2),c.qZA(),c.YNc(3,Ce,4,1,"div",2),c.TgZ(4,"div",3),c.YNc(5,ke,2,3,"mat-icon",4),c.ALo(6,"async"),c.YNc(7,Oe,5,7,"ng-template",null,5,c.W1O),c.qZA(),c.qZA(),c._UZ(9,"mat-progress-bar",6),c.ALo(10,"async")),2&t){const t=c.MAs(8);c.xp6(2),c.Oqu(e.upload.uploadedFile.name),c.xp6(1),c.Q6J("ngIf",e.progress.percentage&&e.progress.percentage<100&&!e.upload.error$.value),c.xp6(2),c.Q6J("ngIf",c.lcZ(6,6,e.upload.error$))("ngIfElse",t),c.xp6(4),c.Q6J("mode",c.lcZ(10,8,e.upload.processing$)?"indeterminate":"determinate")("value",e.progress.percentage)}},directives:[i.O5,ye.pW,f.P,v.Hw,kt.gM],pipes:[i.Ov,Tt.R],styles:["[_nghost-%COMP%]{display:block;color:var(--be-secondary-text);font-size:1.3rem}.meta[_ngcontent-%COMP%]{display:flex;align-items:center;margin-bottom:5px}.name[_ngcontent-%COMP%]{white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.time-left[_ngcontent-%COMP%]{padding-left:20px;white-space:nowrap}.actions[_ngcontent-%COMP%]{margin-left:auto;padding-left:20px}.action-icon[_ngcontent-%COMP%]{vertical-align:middle;width:22px;height:22px;margin-bottom:4px}.completed-icon[_ngcontent-%COMP%]{color:#43a047}.error-icon[_ngcontent-%COMP%]{color:#f44336}.cancel-button[_ngcontent-%COMP%]{color:var(--be-link);cursor:pointer;font-size:1.2rem;text-transform:uppercase;line-height:22px}.cancel-button[_ngcontent-%COMP%]:hover{text-decoration:underline}"],changeDetection:0}),t})();var Pe=n(38172);const Me=["searchInput"],Ue=["fakeInput"];function Je(t,e){if(1&t&&(c.ynx(0),c._UZ(1,"media-image",23),c.TgZ(2,"div",24),c._uU(3),c.qZA(),c.BQk()),2&t){const t=e.ngIf;c.xp6(1),c.Q6J("media",t),c.xp6(2),c.Oqu(t.name)}}function Qe(t,e){1&t&&(c.TgZ(0,"div",25),c._uU(1,"None"),c.qZA())}function Fe(t,e){if(1&t){const t=c.EpF();c.TgZ(0,"button",26),c.NdJ("click",function(){return c.CHM(t),c.oxw().clearSearchInput()}),c._UZ(1,"mat-icon",27),c.qZA()}}function Ne(t,e){if(1&t){const t=c.EpF();c.TgZ(0,"button",17),c.NdJ("click",function(){const e=c.CHM(t).$implicit;return c.oxw().selectAlbum(e)}),c._UZ(1,"media-image",23),c.TgZ(2,"div",28),c.TgZ(3,"div",29),c._uU(4),c.qZA(),c._UZ(5,"artists-links-list",30),c.qZA(),c.qZA()}if(2&t){const t=e.$implicit;c.xp6(1),c.Q6J("media",t),c.xp6(3),c.Oqu(t.name),c.xp6(1),c.Q6J("artists",t.artists)}}function Ye(t,e){1&t&&(c.TgZ(0,"button",31),c._uU(1,"No albums found."),c.qZA())}let $e=(()=>{class t{constructor(t,e){this.search=t,this.currentUser=e,this.searchFormControl=new u.NI,this.loading$=new o.X(!1),this.results$=new o.X([]),this.selectedAlbum$=new o.X(null),this.searchedOnce=!1}ngOnInit(){this.bindToSearchControl()}writeValue(t){this.selectedAlbum$.next(t)}registerOnChange(t){this.propagateChange=t}registerOnTouched(){}bindToSearchControl(){this.searchFormControl.valueChanges.pipe((0,y.b)(150),(0,C.x)(),(0,k.w)(t=>this.searchAlbums(t)),(0,w.K)(()=>(0,A.of)([]))).subscribe(t=>{this.searchedOnce=!0,this.results$.next(t)})}searchAlbums(t){return this.loading$.next(!0),this.search.suggestAlbums({query:t,limit:7}).pipe((0,r.x)(()=>this.loading$.next(!1)),(0,T.U)(t=>t.albums))}onMenuOpened(){document.querySelector(".add-album-control-menu").style.width=this.fakeInput.nativeElement.getBoundingClientRect().width+"px",this.searchedOnce||this.clearSearchInput()}selectAlbum(t){this.selectedAlbum$.next(t),this.propagateChange(t)}clearSearchInput(){this.searchFormControl.setValue("")}onMenuClosed(){this.loading$.next(!1),this.clearSearchInput()}}return t.\u0275fac=function(e){return new(e||t)(c.Y36(q.o),c.Y36(_t.I))},t.\u0275cmp=c.Xpm({type:t,selectors:[["album-control"]],viewQuery:function(t,e){if(1&t&&(c.Gf(Me,7),c.Gf(Ue,5)),2&t){let t;c.iGM(t=c.CRH())&&(e.searchInput=t.first),c.iGM(t=c.CRH())&&(e.fakeInput=t.first)}},features:[c._Bn([{provide:u.JU,useExisting:t,multi:!0}])],decls:30,vars:16,consts:[[1,"many-inputs"],[1,"input-container"],["trans","",1,"fake-label"],["tabindex","0",1,"fake-input",3,"matMenuTriggerFor","menuOpened","menuClosed"],["fakeInput",""],[4,"ngIf","ngIfElse"],["anyAlbum",""],[1,"arrow-container"],[1,"arrow"],[1,"add-album-control-menu"],["menu","matMenu"],[1,"input-container","search-input-container",3,"click"],[1,"search-input-wrapper"],["type","text","placeholder","Search...","mat-menu-item","","trans-placeholder","",3,"formControl","blur"],["searchInput",""],["class","clear-search-input-button","mat-icon-button","",3,"click",4,"ngIf"],[1,"small",3,"isVisible"],["mat-menu-item","",3,"click"],["default","album"],[1,"info","any-user-info"],["trans","",1,"name"],["mat-menu-item","",3,"click",4,"ngFor","ngForOf"],["mat-menu-item","","disabled","","trans","",4,"ngIf"],[3,"media"],[1,"title-name"],["trans","",1,"title-name"],["mat-icon-button","",1,"clear-search-input-button",3,"click"],["svgIcon","close"],[1,"user-info"],[1,"name"],[1,"email",3,"artists"],["mat-menu-item","","disabled","","trans",""]],template:function(t,e){if(1&t){const t=c.EpF();c.TgZ(0,"div",0),c.TgZ(1,"div",1),c.TgZ(2,"div",2),c._uU(3,"Album"),c.qZA(),c.TgZ(4,"div",3,4),c.NdJ("menuOpened",function(){return e.onMenuOpened()})("menuClosed",function(){return e.onMenuClosed()}),c.YNc(6,Je,4,2,"ng-container",5),c.ALo(7,"async"),c.YNc(8,Qe,2,0,"ng-template",null,6,c.W1O),c.TgZ(10,"div",7),c._UZ(11,"div",8),c.qZA(),c.qZA(),c.qZA(),c.qZA(),c.TgZ(12,"mat-menu",9,10),c.TgZ(14,"div",11),c.NdJ("click",function(t){return t.stopPropagation()}),c.TgZ(15,"div",12),c.TgZ(16,"input",13,14),c.NdJ("blur",function(){return c.CHM(t),c.MAs(17).focus()}),c.qZA(),c.YNc(18,Fe,2,0,"button",15),c._UZ(19,"loading-indicator",16),c.ALo(20,"async"),c.qZA(),c.qZA(),c.TgZ(21,"button",17),c.NdJ("click",function(){return e.selectAlbum(null)}),c._UZ(22,"media-image",18),c.TgZ(23,"div",19),c.TgZ(24,"div",20),c._uU(25,"No Album"),c.qZA(),c.qZA(),c.qZA(),c.YNc(26,Ne,6,3,"button",21),c.ALo(27,"async"),c.YNc(28,Ye,2,0,"button",22),c.ALo(29,"async"),c.qZA()}if(2&t){const t=c.MAs(9),n=c.MAs(13);c.xp6(4),c.Q6J("matMenuTriggerFor",n),c.xp6(2),c.Q6J("ngIf",c.lcZ(7,8,e.selectedAlbum$))("ngIfElse",t),c.xp6(10),c.Q6J("formControl",e.searchFormControl),c.xp6(2),c.Q6J("ngIf",e.searchFormControl.value),c.xp6(1),c.Q6J("isVisible",c.lcZ(20,10,e.loading$)),c.xp6(7),c.Q6J("ngForOf",c.lcZ(27,12,e.results$)),c.xp6(2),c.Q6J("ngIf",e.searchedOnce&&!c.lcZ(29,14,e.results$).length)}},directives:[f.P,O.p6,i.O5,O.yF,u.Fj,O.OP,u.JJ,u.oH,I.Q,P.P,i.sg,x.lW,v.Hw,Pe.t],pipes:[i.Ov],styles:["[_nghost-%COMP%]{display:block;min-width:280px;max-width:100%}.fake-input[_ngcontent-%COMP%]{display:flex;align-items:center}.fake-label[_ngcontent-%COMP%]{text-transform:capitalize}.title-name[_ngcontent-%COMP%]{white-space:nowrap;overflow:hidden;text-overflow:ellipsis}media-image[_ngcontent-%COMP%]{display:inline-block;margin-right:8px;width:35px;height:35px;flex-shrink:0;border-radius:4px;vertical-align:middle}.arrow-container[_ngcontent-%COMP%]{flex-shrink:0;padding-left:8px;margin-left:auto}.arrow[_ngcontent-%COMP%]{border-color:#000 transparent transparent transparent;border-style:solid;border-width:5px 4px 0 4px;height:0;width:0}  .mat-menu-panel.add-album-control-menu{max-width:none}.mat-menu-item[_ngcontent-%COMP%]:first-of-type{border-top:1px solid var(--be-divider-default)}.search-input-container[_ngcontent-%COMP%]{padding:2px 10px 10px}.search-input-wrapper[_ngcontent-%COMP%]{position:relative}.clear-search-input-button[_ngcontent-%COMP%]{position:absolute;top:4px;right:0;color:var(--be-secondary-text)}.mat-menu-item[_ngcontent-%COMP%]:not(input){display:flex;vertical-align:middle;height:65px;line-height:65px;align-items:center}.mat-menu-item[_ngcontent-%COMP%]:not(input).selected{background-color:var(--be-accent-emphasis)}.mat-menu-item[_ngcontent-%COMP%]:not(input)   media-image[_ngcontent-%COMP%]{width:45px;height:45px;margin-right:15px;border-radius:50%}.mat-menu-item[_ngcontent-%COMP%]:not(input)   .name[_ngcontent-%COMP%]{text-transform:capitalize;overflow:hidden;text-overflow:ellipsis}.mat-menu-item[_ngcontent-%COMP%]:not(input)   .email[_ngcontent-%COMP%]{color:var(--be-secondary-text);font-size:1.3rem;overflow:hidden;text-overflow:ellipsis}.user-info[_ngcontent-%COMP%]{line-height:normal;line-height:initial}.any-user-info[_ngcontent-%COMP%]{line-height:35px}loading-indicator[_ngcontent-%COMP%]{position:absolute;top:12px;right:40px}.disabled[_ngcontent-%COMP%]{pointer-events:none;opacity:.7}"],changeDetection:0}),t})();function Se(t,e){if(1&t&&c._UZ(0,"track-upload-header",23),2&t){const t=c.oxw(2);c.Q6J("upload",t.uploadQueueItem)}}function De(t,e){if(1&t){const t=c.EpF();c.TgZ(0,"div",24),c.Hsn(1),c.TgZ(2,"div",14),c.TgZ(3,"label",25),c._uU(4,"Title"),c.qZA(),c._UZ(5,"input",26),c.qZA(),c.TgZ(6,"div",27),c.TgZ(7,"button",28),c.NdJ("click",function(){return c.CHM(t),c.oxw(2).toggleExpandedState()}),c._UZ(8,"mat-icon",29),c.qZA(),c.TgZ(9,"button",28),c.NdJ("click",function(){return c.CHM(t),c.oxw(2).maybeCancel()}),c._UZ(10,"mat-icon",30),c.qZA(),c.qZA(),c.qZA()}if(2&t){const t=c.oxw(2);c.Q6J("formGroup",t.form),c.xp6(3),c.Q6J("for","track-form-"+t.uniqueId+"-name"),c.xp6(2),c.Q6J("id","track-form-"+t.uniqueId+"-name"),c.xp6(2),c.ekj("active",t.expanded)}}function Ee(t,e){1&t&&(c.TgZ(0,"span",31),c._uU(1,"Replace File"),c.qZA())}function Le(t,e){1&t&&(c.TgZ(0,"span",31),c._uU(1,"Upload Track"),c.qZA())}function He(t,e){if(1&t&&(c.TgZ(0,"div",32),c._uU(1),c.qZA()),2&t){const t=c.oxw(2).ngIf;c.xp6(1),c.Oqu(t.name)}}function ze(t,e){if(1&t&&(c.TgZ(0,"div",14),c.TgZ(1,"label",15),c._uU(2,"Title"),c.qZA(),c._UZ(3,"input",26),c.YNc(4,He,2,1,"div",17),c.qZA()),2&t){const t=c.oxw().ngIf,e=c.oxw();c.xp6(1),c.Q6J("for","track-form-"+e.uniqueId+"-name"),c.xp6(2),c.Q6J("id","track-form-"+e.uniqueId+"-name"),c.xp6(1),c.Q6J("ngIf",t.name)}}function Be(t,e){if(1&t&&c._UZ(0,"album-control",33),2&t){const t=c.oxw(2);c.Q6J("id","track-form-"+t.uniqueId+"-album_id")}}function Re(t,e){if(1&t&&(c.TgZ(0,"div",32),c._uU(1),c.qZA()),2&t){const t=c.oxw().ngIf;c.xp6(1),c.Oqu(t.duration)}}function Ve(t,e){if(1&t&&(c.TgZ(0,"div",32),c._uU(1),c.qZA()),2&t){const t=c.oxw(2).ngIf;c.xp6(1),c.Oqu(t.youtube_id)}}function Ge(t,e){if(1&t&&(c.TgZ(0,"div",14),c.TgZ(1,"label",15),c._uU(2,"Youtube Video ID"),c.qZA(),c._UZ(3,"input",34),c.YNc(4,Ve,2,1,"div",17),c.TgZ(5,"p"),c._uU(6,"ID only. https://www.youtube.com/embed?v="),c.TgZ(7,"strong"),c._uU(8,"EPyh41zPg4Z"),c.qZA(),c.qZA(),c.qZA()),2&t){const t=c.oxw().ngIf,e=c.oxw();c.xp6(1),c.Q6J("for","track-form-"+e.uniqueId+"-track-youtube-id"),c.xp6(2),c.Q6J("id","track-form-"+e.uniqueId+"-track-youtube-id"),c.xp6(1),c.Q6J("ngIf",t.youtube_id)}}function je(t,e){if(1&t&&(c.TgZ(0,"div",32),c._uU(1),c.qZA()),2&t){const t=c.oxw(2).ngIf;c.xp6(1),c.Oqu(t.url)}}function Xe(t,e){if(1&t&&(c.TgZ(0,"div",14),c.TgZ(1,"label",15),c._uU(2,"Track Url"),c.qZA(),c._UZ(3,"input",35),c.YNc(4,je,2,1,"div",17),c.TgZ(5,"p"),c._uU(6,"Remote or local url to music or video file for this track. If available, this will always play instead of youtube video."),c.qZA(),c.qZA()),2&t){const t=c.oxw().ngIf,e=c.oxw();c.xp6(1),c.Q6J("for","track-form-"+e.uniqueId+"-track-url"),c.xp6(2),c.Q6J("id","track-form-"+e.uniqueId+"-track-url"),c.xp6(1),c.Q6J("ngIf",t.url)}}function We(t,e){1&t&&(c.TgZ(0,"div",14),c.TgZ(1,"label",36),c._uU(2,"Spotify ID"),c.qZA(),c._UZ(3,"input",37),c.qZA())}function Ke(t,e){if(1&t&&(c.TgZ(0,"div",32),c._uU(1),c.qZA()),2&t){const t=c.oxw().ngIf;c.xp6(1),c.Oqu(t.genres)}}function tn(t,e){if(1&t&&(c.TgZ(0,"div",32),c._uU(1),c.qZA()),2&t){const t=c.oxw().ngIf;c.xp6(1),c.Oqu(t.tags)}}function en(t,e){if(1&t&&(c.TgZ(0,"button",38),c.ALo(1,"async"),c._uU(2,"Save"),c.qZA()),2&t){const t=c.oxw(2);c.Q6J("disabled",c.lcZ(1,1,t.loading$)||t.uploadQueueItem&&!t.uploadQueueItem.completed)}}function nn(t,e){if(1&t){const t=c.EpF();c.TgZ(0,"button",39),c.NdJ("click",function(){return c.CHM(t),c.oxw(2).maybeCancel()}),c._uU(1,"Cancel"),c.qZA()}}function an(t,e){if(1&t){const t=c.EpF();c.TgZ(0,"form",1),c.NdJ("ngSubmit",function(){return c.CHM(t),c.oxw().submit()}),c.YNc(1,Se,1,1,"track-upload-header",2),c.YNc(2,De,11,5,"div",3),c.TgZ(3,"div",4),c.TgZ(4,"div",5),c.TgZ(5,"div",6),c._UZ(6,"upload-image-control",7),c.ALo(7,"async"),c.TgZ(8,"button",8),c.NdJ("click",function(){return c.CHM(t),c.oxw().openUploadMusicModal()}),c.YNc(9,Ee,2,0,"span",9),c.YNc(10,Le,2,0,"span",9),c.qZA(),c.qZA(),c.TgZ(11,"div",10),c.YNc(12,ze,5,3,"div",11),c.YNc(13,Be,1,1,"album-control",12),c._UZ(14,"track-artist-control",13),c.TgZ(15,"div",14),c.TgZ(16,"label",15),c._uU(17,"Duration (ms)"),c.qZA(),c._UZ(18,"input",16),c.YNc(19,Re,2,1,"div",17),c.qZA(),c.YNc(20,Ge,9,3,"div",11),c.YNc(21,Xe,7,3,"div",11),c.YNc(22,We,4,0,"div",11),c.TgZ(23,"div",14),c.TgZ(24,"label",15),c._uU(25,"Genres"),c.qZA(),c._UZ(26,"chip-input",18),c.YNc(27,Ke,2,1,"div",17),c.qZA(),c.TgZ(28,"div",14),c.TgZ(29,"label",15),c._uU(30,"Tags"),c.qZA(),c._UZ(31,"chip-input",19),c.YNc(32,tn,2,1,"div",17),c.qZA(),c.TgZ(33,"div",14),c.TgZ(34,"label",15),c._uU(35,"Description"),c.qZA(),c._UZ(36,"textarea",20),c.qZA(),c.YNc(37,en,3,3,"button",21),c.YNc(38,nn,2,0,"button",22),c.qZA(),c.qZA(),c.qZA(),c.qZA()}if(2&t){const t=e.ngIf,n=c.oxw();c.Q6J("formGroup",n.form),c.xp6(1),c.Q6J("ngIf",n.uploadQueueItem),c.xp6(1),c.Q6J("ngIf",n.albumForm),c.xp6(1),c.Q6J("@bodyExpansion",n.getExpandedState()),c.xp6(1),c.ekj("inside-album",n.albumForm),c.xp6(2),c.Q6J("defaultBackground",c.lcZ(7,31,n.defaultImage$)),c.xp6(3),c.Q6J("ngIf",n.track),c.xp6(1),c.Q6J("ngIf",!n.track),c.xp6(2),c.Q6J("ngIf",!n.albumForm),c.xp6(1),c.Q6J("ngIf",!n.albumForm),c.xp6(1),c.Q6J("error",t.artists)("id","track-form-"+n.uniqueId+"-artists"),c.xp6(2),c.Q6J("for","track-form-"+n.uniqueId+"-duration"),c.xp6(2),c.Q6J("id","track-form-"+n.uniqueId+"-duration"),c.xp6(1),c.Q6J("ngIf",t.duration),c.xp6(1),c.Q6J("ngIf",n.insideAdmin()),c.xp6(1),c.Q6J("ngIf",n.insideAdmin()),c.xp6(1),c.Q6J("ngIf",n.insideAdmin&&n.settings.get("spotify_is_setup")),c.xp6(2),c.Q6J("for","track-form-"+n.uniqueId+"-track-genres"),c.xp6(2),c.Q6J("id","track-form-"+n.uniqueId+"-track-genres")("suggestFn",n.suggestGenreFn),c.xp6(1),c.Q6J("ngIf",t.genres),c.xp6(2),c.Q6J("for","track-form-"+n.uniqueId+"-track-tags"),c.xp6(2),c.Q6J("id","track-form-"+n.uniqueId+"-track-tags")("suggestFn",n.suggestTagFn),c.xp6(1),c.Q6J("ngIf",t.tags),c.xp6(2),c.Q6J("for","track-form-"+n.uniqueId+"-track-description"),c.xp6(2),c.Q6J("id","track-form-"+n.uniqueId+"-track-description"),c.xp6(1),c.Q6J("ngIf",!n.albumForm),c.xp6(1),c.Q6J("ngIf",!n.albumForm&&!n.track)}}const on=["*"];let rn=(()=>{class t{constructor(t,e,n,i,a,r,s,l,u,d,p,m){this.fb=t,this.currentUser=e,this.tracks=n,this.toast=i,this.modal=a,this.audioValidator=r,this.uploadQueue=s,this.waveGenerator=l,this.router=u,this.settings=d,this.cd=p,this.search=m,this.canceled=new c.vpe,this.saved=new c.vpe,this.errors$=new o.X({}),this.defaultImage$=new o.X(Xt.e.album),this.loading$=new o.X(!1),this.uniqueId=(0,ne.O)(5),this.form=this.fb.group({id:[null],name:[""],image:[""],description:[""],number:[1],tags:[[]],genres:[[]],duration:[null],url:[""],youtube_id:[""],spotify_id:[""],spotify_popularity:[""],album:[null],artists:[[]],waveData:[null],lyrics:[""]}),this.expanded=!1,this.suggestTagFn=t=>this.search.media(t,{types:["tag"],limit:5}).pipe((0,T.U)(t=>t.results.tags.map(t=>t.name))),this.suggestGenreFn=t=>this.search.media(t,{types:[lt.J],limit:5}).pipe((0,T.U)(t=>t.results.genres.map(t=>t.name)))}ngOnChanges(t){t.number&&null!=t.number.currentValue&&this.form.patchValue({number:t.number.currentValue})}ngOnInit(){if(this.expanded=!this.albumForm,this.track){const t=Object.assign({},this.track);t.tags=(this.track.tags||[]).map(t=>t.name),t.genres=(this.track.genres||[]).map(t=>t.display_name||t.name),this.form.patchValue(t),this.track.album&&this.defaultImage$.next(this.track.album.image||Xt.e.album)}else this.currentUser.canAttachMusicToAnyArtist()||this.form.get("artists").setValue([this.currentUser.get("artists")[0]||this.currentUser.artistPlaceholder()]);this.uploadQueueItem&&this.uploadQueueItem.uploadedResponse$.subscribe(t=>{this.patchFormUsingFileUpload(t)}),this.albumForm&&this.albumForm.get("image").valueChanges.subscribe(t=>{this.defaultImage$.next(t||Xt.e.album)})}getPayload(){const t=this.uploadQueueItem?this.uploadQueueItem.customData:{},e=Object.assign(Object.assign({},this.form.value),t);return e.artists=e.artists.map(t=>"number"!=typeof t?t.id:t),e}isUploading(){return this.uploadQueueItem&&!this.uploadQueueItem.completed}submit(){if(this.albumForm)return;this.loading$.next(!0);const t=this.getPayload();(this.track?this.tracks.update(this.track.id,t):this.tracks.create(t)).pipe((0,r.x)(()=>this.loading$.next(!1))).subscribe(t=>{this.uploadQueueItem&&this.uploadQueue.remove(this.uploadQueueItem.id),this.toast.open("Track saved."),this.form.markAsPristine(),this.saved.emit(t.track)},t=>{this.errors$.next(t.errors),(0,ie.f)(this.errors$.value,`track-form-${this.uniqueId}`)})}toggleExpandedState(){this.expanded=!this.expanded}getExpandedState(){return this.expanded?"expanded":"collapsed"}maybeCancel(){this.modal.show(bt.z,{title:"Remove Track",body:"Are you sure you want to cancel the upload and remove this track?",ok:"Remove"}).beforeClosed().subscribe(t=>{!t||(this.uploadQueueItem?(this.uploadQueue.remove(this.uploadQueueItem.id),this.canceled.emit(this.uploadQueueItem),this.toast.open("Upload canceled.")):this.track&&this.tracks.delete([this.track.id]).subscribe(()=>{this.canceled.emit(this.track),this.toast.open("Track deleted.")}))})}openUploadMusicModal(){const t={uri:"uploads",validator:this.audioValidator,httpParams:{diskPrefix:"track_media",disk:"public"},willProcessFiles:!0};(0,Kt.r)({types:[te.j.audio,te.j.video]}).then(e=>{e&&(this.uploadQueue.start(this.uploadQueueItem?{[this.uploadQueueItem.id]:e[0]}:e,t).subscribe(t=>{const e=this.uploadQueue.find(t.queueItemId);this.waveGenerator.generate(e.uploadedFile.native).then(t=>{this.form.patchValue({waveData:t}),e.finishProcessing()}),this.patchFormUsingFileUpload(t),this.toast.open("Track uploaded.")},()=>this.toast.open("Could not upload track")),this.uploadQueueItem||(this.uploadQueueItem=this.uploadQueue.uploads$.value[0],this.cd.markForCheck()))})}patchFormUsingFileUpload(t){const e={name:t.metadata.title,duration:t.metadata.duration,url:t.fileEntry.url,genres:t.metadata.genres||[],description:t.metadata.comment,lyrics:t.metadata.lyrics};t.metadata.album&&(e.album=t.metadata.album),t.metadata.artist&&(e.artists=[t.metadata.artist],this.albumForm&&!this.albumForm.value.artist&&this.albumForm.patchValue({artist:t.metadata.artist})),t.metadata.image&&(e.image=t.metadata.image.url,this.albumForm&&!this.albumForm.value.image&&this.albumForm.patchValue({image:t.metadata.image.url})),t.metadata.release_date&&this.albumForm&&!this.albumForm.value.release_date&&this.albumForm.patchValue({release_date:t.metadata.release_date}),this.form.patchValue(e)}insideAdmin(){return this.router.url.indexOf("admin")>-1}shouldShowDurationField(){const t=this.form.get("url").value;return!t||(0,ee.s)(t)}}return t.\u0275fac=function(e){return new(e||t)(c.Y36(u.qu),c.Y36(p.z),c.Y36(ae.O),c.Y36(dt.F),c.Y36(vt.u),c.Y36(le),c.Y36(g.A),c.Y36(ue.qQ),c.Y36(a.F0),c.Y36(d.Z),c.Y36(c.sBO),c.Y36(q.o))},t.\u0275cmp=c.Xpm({type:t,selectors:[["track-form"]],inputs:{track:"track",uploadQueueItem:"uploadQueueItem",albumForm:"albumForm",number:"number"},outputs:{canceled:"canceled",saved:"saved"},features:[c.TTD],ngContentSelectors:on,decls:2,vars:3,consts:[["class","many-inputs",3,"formGroup","ngSubmit",4,"ngIf"],[1,"many-inputs",3,"formGroup","ngSubmit"],[3,"upload",4,"ngIf"],["class","inline-form",3,"formGroup",4,"ngIf"],[1,"full-form"],[1,"full-form-container"],[1,"left-column"],["formControlName","image","diskPrefix","track_image",3,"defaultBackground"],["mat-flat-button","","color","accent","type","button",1,"left-column-action-button",3,"click"],["trans","",4,"ngIf"],[1,"many-inputs","fields-container"],["class","input-container",4,"ngIf"],["formControlName","album",3,"id",4,"ngIf"],["formControlName","artists",3,"error","id"],[1,"input-container"],["trans","",3,"for"],["type","number","formControlName","duration","min","1","required","",3,"id"],["class","error",4,"ngIf"],["placeholder","+Add genre","formControlName","genres",3,"id","suggestFn"],["placeholder","+Add tag","formControlName","tags",3,"id","suggestFn"],["type","text","formControlName","description","minlength","10","maxlength","999","rows","5",3,"id"],["type","submit","mat-raised-button","","color","accent","trans","",3,"disabled",4,"ngIf"],["type","button","mat-button","","trans","",3,"click",4,"ngIf"],[3,"upload"],[1,"inline-form",3,"formGroup"],["trans","",1,"hidden",3,"for"],["type","text","formControlName","name","required","",3,"id"],[1,"actions"],["type","button","mat-icon-button","",3,"click"],["svgIcon","edit"],["svgIcon","delete"],["trans",""],[1,"error"],["formControlName","album",3,"id"],["type","text","formControlName","youtube_id","minlength","1","maxlength","30",3,"id"],["type","url","formControlName","url","minlength","1","maxlength","191",3,"id"],["for","track-spotify-id","trans",""],["type","text","id","track-spotify-id","formControlName","spotify_id","minlength","22","maxlength","22"],["type","submit","mat-raised-button","","color","accent","trans","",3,"disabled"],["type","button","mat-button","","trans","",3,"click"]],template:function(t,e){1&t&&(c.F$t(),c.YNc(0,an,39,33,"form",0),c.ALo(1,"async")),2&t&&c.Q6J("ngIf",c.lcZ(1,1,e.errors$))},directives:[i.O5,u._Y,u.JL,u.sg,b.V,u.JJ,u.u,x.lW,Ze,f.P,u.wV,u.qQ,u.Fj,u.Q7,gt.S,u.wO,u.nD,Ie,v.Hw,$e],pipes:[i.Ov],styles:["[_nghost-%COMP%]{display:block}.inline-form[_ngcontent-%COMP%]{display:flex}.inline-form[_ngcontent-%COMP%]   .actions[_ngcontent-%COMP%]{flex-shrink:0;color:var(--be-secondary-text);margin-left:20px}.full-form[_ngcontent-%COMP%]{overflow:hidden}.full-form-container[_ngcontent-%COMP%]{display:flex}.full-form-container.inside-album[_ngcontent-%COMP%]{margin:25px 100px 0 60px}.fields-container[_ngcontent-%COMP%]{flex:1 1 auto;margin-left:20px;min-width:0}.cdk-drag-handle[_ngcontent-%COMP%]{flex-shrink:0;color:var(--be-secondary-text);margin-right:20px}.active[_ngcontent-%COMP%]{color:var(--be-accent-default)}track-upload-header[_ngcontent-%COMP%]{margin-bottom:15px}.drag-handle[_ngcontent-%COMP%]{cursor:move}.left-column-action-button[_ngcontent-%COMP%]{margin-top:15px;width:100%;line-height:40px}@media only screen and (max-width: 768px){.full-form-container[_ngcontent-%COMP%]{display:block}.left-column[_ngcontent-%COMP%]{max-width:220px;margin:auto auto 25px}.fields-container[_ngcontent-%COMP%]{margin-left:0}}"],data:{animation:[Wt.FX.bodyExpansion]},changeDetection:0}),t})();function sn(t,e){if(1&t&&(c.TgZ(0,"div",24),c._uU(1),c.qZA()),2&t){const t=c.oxw();c.xp6(1),c.Oqu(t.errors.name)}}function cn(t,e){if(1&t&&(c.TgZ(0,"div",24),c._uU(1),c.qZA()),2&t){const t=c.oxw();c.xp6(1),c.Oqu(t.errors.release_date)}}function ln(t,e){if(1&t&&(c.TgZ(0,"div",24),c._uU(1),c.qZA()),2&t){const t=c.oxw();c.xp6(1),c.Oqu(t.errors.description)}}function un(t,e){if(1&t&&(c.TgZ(0,"div",24),c._uU(1),c.qZA()),2&t){const t=c.oxw();c.xp6(1),c.Oqu(t.errors.genres)}}function dn(t,e){if(1&t&&(c.TgZ(0,"div",24),c._uU(1),c.qZA()),2&t){const t=c.oxw();c.xp6(1),c.Oqu(t.errors.tags)}}function pn(t,e){1&t&&(c.TgZ(0,"div",6),c.TgZ(1,"label",25),c._uU(2,"Spotify ID"),c.qZA(),c._UZ(3,"input",26),c.qZA())}function mn(t,e){if(1&t){const t=c.EpF();c.TgZ(0,"track-form",30),c.NdJ("canceled",function(){c.CHM(t);const e=c.oxw().$implicit;return c.oxw().trackRemoved(e)}),c.TgZ(1,"button",31),c._UZ(2,"mat-icon",32),c.qZA(),c.qZA()}if(2&t){const t=c.oxw(),e=t.$implicit,n=t.index,i=c.oxw();c.Q6J("albumForm",i.form)("track",e)("number",n+1)}}function gn(t,e){if(1&t){const t=c.EpF();c.TgZ(0,"track-form",33),c.NdJ("canceled",function(){c.CHM(t);const e=c.oxw().$implicit;return c.oxw().trackRemoved(e)}),c.TgZ(1,"button",31),c._UZ(2,"mat-icon",32),c.qZA(),c.qZA()}if(2&t){const t=c.oxw(),e=t.$implicit,n=t.index,i=c.oxw();c.Q6J("albumForm",i.form)("uploadQueueItem",e)("number",n+1)}}function hn(t,e){if(1&t&&(c.TgZ(0,"li",27),c.YNc(1,mn,3,3,"track-form",28),c.YNc(2,gn,3,3,"track-form",29),c.qZA()),2&t){const t=e.$implicit;c.xp6(1),c.Q6J("ngIf",t.model_type),c.xp6(1),c.Q6J("ngIf",!t.model_type)}}const fn=function(){return["music.update"]};let bn=(()=>{class t{constructor(t,e,n,i,a,r,s,l,u,d,p,m){this.fb=t,this.uploadQueue=e,this.albums=n,this.cd=i,this.currentUser=a,this.modal=r,this.toast=s,this.audioValidator=l,this.settings=u,this.search=d,this.router=p,this.waveform=m,this.uploadButtonConfig={multiple:!0,types:[te.j.audio,te.j.video]},this.confirmCancel=!0,this.canceled=new c.vpe,this.saved=new c.vpe,this.errors={},this.loading$=new o.X(!1),this.allTracks$=new o.X([]),this.form=this.fb.group({name:[""],image:[""],artists:[[]],release_date:[(new Date).toISOString().slice(0,10)],description:[""],spotify_id:[""],tags:[[]],genres:[[]]}),this.trackByFn=(t,e)=>e.id,this.suggestTagFn=t=>this.search.media(t,{types:["tag"],limit:5}).pipe((0,T.U)(t=>t.results.tags.map(t=>t.name))),this.suggestGenreFn=t=>this.search.media(t,{types:[lt.J],limit:5}).pipe((0,T.U)(t=>t.results.genres.map(t=>t.name)))}ngOnInit(){if(this.insideAdmin=this.router.url.includes("admin"),this.allTracks$=new o.X([...this.album?this.album.tracks:[],...this.onlyValidUploads(this.uploadQueue.uploads$.value)]),this.uploadQueue.uploadsAdded$.subscribe(t=>{this.allTracks$.next([...this.allTracks$.value,...this.onlyValidUploads(t)])}),this.album){const t=Object.assign(Object.assign({},this.album),{tags:this.album.tags.map(t=>t.name),genres:this.album.genres.map(t=>t.display_name||t.name)});this.form.patchValue(t)}else this.artist?this.form.get("artists").setValue([this.artist]):this.currentUser.canAttachMusicToAnyArtist()||this.form.get("artists").setValue([this.currentUser.get("artists")[0]||this.currentUser.artistPlaceholder()])}onlyValidUploads(t){return t.filter(t=>!t.error$.value)}reorderTracks(t){const e=this.allTracks$.value;(0,jt.bA)(e,t.previousIndex,t.currentIndex),this.allTracks$.next(e)}submit(){if(this.trackForms.some(t=>t.isUploading()))return void this.toast.open("Some tracks are still uploading or failed to upload.");this.loading$.next(!0);const t=Object.assign(Object.assign({},this.form.value),{tracks:this.trackForms.map(t=>t.getPayload())});t.artists=t.artists.map(t=>"number"!=typeof t?t.id:t),(this.album?this.albums.update(this.album.id,t):this.albums.create(t)).pipe((0,r.x)(()=>this.loading$.next(!1))).subscribe(t=>{this.form.markAsPristine(),this.trackForms.forEach(t=>t.form.markAsPristine()),this.toast.open("Album saved."),this.uploadQueue.reset(),this.saved.emit(t.album)},t=>{this.errors=t.errors,(0,ie.f)(this.errors,"track-form"),this.cd.markForCheck()})}maybeCancel(){this.confirmCancel?this.modal.show(bt.z,{title:"Delete Album",body:"Are you sure you want to cancel all uploads and delete this album?",ok:"Delete"}).beforeClosed().subscribe(t=>{t&&(this.form.reset(),this.uploadQueue.reset(),this.canceled.emit())}):this.canceled.emit()}uploadFiles(t){this.uploadQueue.start(t,{uri:"uploads",httpParams:{autoMatchAlbum:!1,diskPrefix:"track_media",disk:"public"},validator:this.audioValidator}).subscribe(t=>{const e=this.uploadQueue.find(t.queueItemId),n=this.trackForms.find(e=>{var n;return(null===(n=e.uploadQueueItem)||void 0===n?void 0:n.id)===t.queueItemId}).form;this.waveform.generate(e.uploadedFile.native).then(t=>{n.patchValue({waveData:t}),e.finishProcessing()}),n.markAsDirty()},()=>this.toast.open("Could not upload tracks."))}trackRemoved(t){const e=this.allTracks$.value.filter(e=>e.id!==t.id);this.allTracks$.next(e)}}return t.\u0275fac=function(e){return new(e||t)(c.Y36(u.qu),c.Y36(g.A),c.Y36(Zt.R),c.Y36(c.sBO),c.Y36(p.z),c.Y36(vt.u),c.Y36(dt.F),c.Y36(le),c.Y36(d.Z),c.Y36(q.o),c.Y36(a.F0),c.Y36(ue.qQ))},t.\u0275cmp=c.Xpm({type:t,selectors:[["album-form"]],viewQuery:function(t,e){if(1&t&&c.Gf(rn,5),2&t){let t;c.iGM(t=c.CRH())&&(e.trackForms=t)}},inputs:{album:"album",artist:"artist",confirmCancel:"confirmCancel"},outputs:{canceled:"canceled",saved:"saved"},decls:42,vars:20,consts:[[3,"formGroup","ngSubmit"],[1,"main-info-fields"],[1,"left-column"],["formControlName","image","diskPrefix","album"],["mat-flat-button","","color","accent","type","button","trans","",1,"upload-tracks-button",3,"uploadButton","filesSelected"],[1,"text-fields-container","many-inputs"],[1,"input-container"],["for","album-form-name","trans",""],["type","text","id","album-form-name","formControlName","name","required","",3,"readOnly"],["class","error",4,"ngIf"],["for","album-form-release_date","trans",""],["type","date","placeholder","YYYY-MM-DD","id","album-form-release_date","formControlName","release_date","required",""],["id","album-form-artists","formControlName","artists",3,"error"],["for","album-form-description","trans",""],["type","text","id","album-form-description","formControlName","description","minlength","10","maxlength","250","rows","5"],["for","album-form-genres","trans",""],["placeholder","+Add genre","id","album-form-genres","formControlName","genres",3,"suggestFn"],["for","album-form-tags","trans",""],["placeholder","+Add tag","id","album-form-tags","formControlName","tags",3,"suggestFn"],["class","input-container",4,"ngIf"],["type","submit","mat-raised-button","","color","accent","trans","",3,"disabled"],["type","button","mat-button","","trans","",3,"click"],["cdkDropList","",1,"track-list","unstyled-list",3,"cdkDropListDropped"],["class","track-list-item","cdkDrag","",4,"ngFor","ngForOf","ngForTrackBy"],[1,"error"],["for","album-spotify-id","trans",""],["type","text","id","album-spotify-id","formControlName","spotify_id","minlength","22","maxlength","22"],["cdkDrag","",1,"track-list-item"],[3,"albumForm","track","number","canceled",4,"ngIf"],[3,"albumForm","uploadQueueItem","number","canceled",4,"ngIf"],[3,"albumForm","track","number","canceled"],["mat-icon-button","","cdkDragHandle","","type","button"],["svgIcon","drag-handle"],[3,"albumForm","uploadQueueItem","number","canceled"]],template:function(t,e){1&t&&(c.TgZ(0,"form",0),c.NdJ("ngSubmit",function(){return e.submit()}),c.TgZ(1,"div",1),c.TgZ(2,"div",2),c._UZ(3,"upload-image-control",3),c.TgZ(4,"button",4),c.NdJ("filesSelected",function(t){return e.uploadFiles(t)}),c._uU(5,"Upload Tracks"),c.qZA(),c.qZA(),c.TgZ(6,"div",5),c.TgZ(7,"div",6),c.TgZ(8,"label",7),c._uU(9,"Name"),c.qZA(),c._UZ(10,"input",8),c.YNc(11,sn,2,1,"div",9),c.qZA(),c.TgZ(12,"div",6),c.TgZ(13,"label",10),c._uU(14,"Release Date"),c.qZA(),c._UZ(15,"input",11),c.YNc(16,cn,2,1,"div",9),c.qZA(),c._UZ(17,"track-artist-control",12),c.TgZ(18,"div",6),c.TgZ(19,"label",13),c._uU(20,"Description"),c.qZA(),c._UZ(21,"textarea",14),c.YNc(22,ln,2,1,"div",9),c.qZA(),c.TgZ(23,"div",6),c.TgZ(24,"label",15),c._uU(25,"Genres"),c.qZA(),c._UZ(26,"chip-input",16),c.YNc(27,un,2,1,"div",9),c.qZA(),c.TgZ(28,"div",6),c.TgZ(29,"label",17),c._uU(30,"Tags"),c.qZA(),c._UZ(31,"chip-input",18),c.YNc(32,dn,2,1,"div",9),c.qZA(),c.YNc(33,pn,4,0,"div",19),c.TgZ(34,"button",20),c.ALo(35,"async"),c._uU(36,"Save"),c.qZA(),c.TgZ(37,"button",21),c.NdJ("click",function(){return e.maybeCancel()}),c._uU(38,"Cancel"),c.qZA(),c.qZA(),c.qZA(),c.qZA(),c.TgZ(39,"ul",22),c.NdJ("cdkDropListDropped",function(t){return e.reorderTracks(t)}),c.YNc(40,hn,3,2,"li",23),c.ALo(41,"async"),c.qZA()),2&t&&(c.Q6J("formGroup",e.form),c.xp6(4),c.Q6J("uploadButton",e.uploadButtonConfig),c.xp6(6),c.Q6J("readOnly",e.album&&!e.currentUser.hasPermissions(c.DdM(19,fn))),c.xp6(1),c.Q6J("ngIf",e.errors.name),c.xp6(5),c.Q6J("ngIf",e.errors.release_date),c.xp6(1),c.Q6J("error",e.errors.artists),c.xp6(5),c.Q6J("ngIf",e.errors.description),c.xp6(4),c.Q6J("suggestFn",e.suggestGenreFn),c.xp6(1),c.Q6J("ngIf",e.errors.genres),c.xp6(4),c.Q6J("suggestFn",e.suggestTagFn),c.xp6(1),c.Q6J("ngIf",e.errors.tags),c.xp6(1),c.Q6J("ngIf",e.insideAdmin&&e.settings.get("spotify_is_setup")),c.xp6(1),c.Q6J("disabled",c.lcZ(35,15,e.loading$)),c.xp6(6),c.Q6J("ngForOf",c.lcZ(41,17,e.allTracks$))("ngForTrackBy",e.trackByFn))},directives:[u._Y,u.JL,u.sg,b.V,u.JJ,u.u,x.lW,f.P,Z.c,u.Fj,u.Q7,i.O5,Ze,u.wO,u.nD,gt.S,jt.Wj,i.sg,jt.Zt,rn,jt.Bh,v.Hw],pipes:[i.Ov],styles:["[_nghost-%COMP%]{display:block;padding:25px}.main-info-fields[_ngcontent-%COMP%]{display:flex}.text-fields-container[_ngcontent-%COMP%]{flex:1 1 auto;margin-left:20px}.track-list[_ngcontent-%COMP%]{margin-top:30px;padding:0 15px}.track-list-item[_ngcontent-%COMP%]:not(.cdk-drag-preview){border-bottom:1px solid var(--be-divider-lighter);padding-bottom:15px;margin-bottom:15px}.upload-tracks-button[_ngcontent-%COMP%]{margin-top:15px;width:100%;line-height:40px}@media only screen and (max-width: 768px){[_nghost-%COMP%]{padding:10px}.track-list[_ngcontent-%COMP%]{padding:0}.main-info-fields[_ngcontent-%COMP%]{display:block}.left-column[_ngcontent-%COMP%]{max-width:220px;margin:auto auto 25px}.text-fields-container[_ngcontent-%COMP%]{margin-left:0}}"],changeDetection:0}),t})(),xn=(()=>{class t{constructor(t,e,n,i){this.route=t,this.router=e,this.settings=n,this.urls=i}ngOnInit(){this.route.data.subscribe(t=>{t.api&&(this.album=t.api.album)}),this.route.queryParams.subscribe(t=>{t.artist&&(this.artist=JSON.parse(atob(t.artist)))})}toAlbumsPage(){this.router.url.includes("admin")?this.router.navigate(this.artist?this.urls.editArtist(this.artist.id,!0):["/admin/albums"]):this.router.navigate(["/"])}canDeactivate(){return!this.albumForm.form.dirty&&!this.albumForm.trackForms.some(t=>t.form.dirty)}}return t.\u0275fac=function(e){return new(e||t)(c.Y36(a.gz),c.Y36(a.F0),c.Y36(d.Z),c.Y36(pt.J))},t.\u0275cmp=c.Xpm({type:t,selectors:[["crupdate-album-page"]],viewQuery:function(t,e){if(1&t&&c.Gf(bn,7),2&t){let t;c.iGM(t=c.CRH())&&(e.albumForm=t.first)}},features:[c._Bn([g.A])],decls:1,vars:3,consts:[[1,"material-panel",3,"album","artist","confirmCancel","canceled","saved"]],template:function(t,e){1&t&&(c.TgZ(0,"album-form",0),c.NdJ("canceled",function(){return e.toAlbumsPage()})("saved",function(){return e.toAlbumsPage()}),c.qZA()),2&t&&c.Q6J("album",e.album)("artist",e.artist)("confirmCancel",!1)},directives:[bn],styles:[""],changeDetection:0}),t})(),vn=(()=>{class t{constructor(t){this.modal=t}canDeactivate(t){return!!t.canDeactivate()||this.modal.show(bt.z,{title:"Unsaved Changes",body:"You have unsaved changes. Do you want to discard them?",ok:"Discard"}).beforeClosed()}}return t.\u0275fac=function(e){return new(e||t)(c.LFG(vt.u))},t.\u0275prov=c.Yz7({token:t,factory:t.\u0275fac,providedIn:"root"}),t})(),Zn=(()=>{class t{constructor(t,e,n){this.route=t,this.router=e,this.settings=n}ngOnInit(){this.route.data.subscribe(t=>{t.api&&(this.track=t.api.track)})}toTracksPage(){this.insideAdmin()?this.router.navigate(["/admin/tracks"]):this.router.navigate(["/"])}canDeactivate(){return!this.trackForm.form.dirty}insideAdmin(){return this.router.url.includes("admin")}}return t.\u0275fac=function(e){return new(e||t)(c.Y36(a.gz),c.Y36(a.F0),c.Y36(d.Z))},t.\u0275cmp=c.Xpm({type:t,selectors:[["crupdate-track-page"]],viewQuery:function(t,e){if(1&t&&c.Gf(rn,7),2&t){let t;c.iGM(t=c.CRH())&&(e.trackForm=t.first)}},decls:1,vars:1,consts:[[1,"material-panel",3,"track","canceled","saved"]],template:function(t,e){1&t&&(c.TgZ(0,"track-form",0),c.NdJ("canceled",function(){return e.toTracksPage()})("saved",function(){return e.toTracksPage()}),c.qZA()),2&t&&c.Q6J("track",e.track)},directives:[rn],styles:[""],changeDetection:0}),t})();var _n=n(30189),An=n(83106);function yn(t,e=[]){return(0,ft.mG)(this,void 0,void 0,function*(){const n=yield function(t){return new Promise(e=>{Cn(t.createReader(),e)})}(t);for(const t in n){const i=n[t];i.isDirectory?yield yn(i,e):e.push(yield kn(i))}return e})}function Cn(t,e,n=[]){t.readEntries(i=>{i.length?(n=n.concat(i),Cn(t,e,n)):e(n)})}function kn(t){return new Promise(e=>{t.file(n=>{e(new An.D(n,t.fullPath))})})}let wn=(()=>{class t{constructor(t){this.el=t,this.disableDropzoneClick=!1,this.disableDropzone=!1,this.uploadConfig={},this.filesDropped=new c.vpe}ngOnInit(){const t=this.el.nativeElement;t.addEventListener("dragenter",t=>this.handleDragEnter(t)),t.addEventListener("dragover",t=>this.handleDragOver(t)),t.addEventListener("dragleave",t=>this.handleDragLeave(t)),t.addEventListener("drop",t=>this.handleDrop(t)),this.disableDropzoneClick||(this.clickButton?this.clickButton.nativeElement:t).addEventListener("click",()=>this.handleClick())}ngOnDestroy(){this.removeClassesFromDropzone()}handleClick(){this.disableDropzone||(0,Kt.r)(this.uploadConfig).then(t=>{this.emitUploadEvent(t)})}handleDragEnter(t){this.dropzoneDisabled(t)||this.el.nativeElement.classList.add("file-over-dropzone")}handleDragOver(t){return t.preventDefault&&t.preventDefault(),t.dataTransfer.dropEffect=this.dropzoneDisabled(t)?"none":"move",!1}handleDragLeave(t){const e=document.elementFromPoint(t.clientX,t.clientY);this.el.nativeElement.contains(e)||this.removeClassesFromDropzone()}handleDrop(t){return(0,ft.mG)(this,void 0,void 0,function*(){if(t.stopPropagation(),t.preventDefault(),this.removeClassesFromDropzone(),this.dropzoneDisabled(t)||!t.dataTransfer.items)return;const e=Array.from(t.dataTransfer.items).filter(t=>"file"===t.kind).map(t=>t.webkitGetAsEntry());e.length&&this.emitUploadEvent(yield function(t){return(0,ft.mG)(this,void 0,void 0,function*(){let e=[];for(const n in t){const i=t[n];i.isDirectory?e=e.concat(yield yn(i)):e.push(yield kn(i))}return e})}(e))})}emitUploadEvent(t){this.filesDropped.emit(t)}removeClassesFromDropzone(){this.el.nativeElement.classList.remove("file-over-dropzone")}dropzoneDisabled(t){const e=t.dataTransfer.types.find(t=>"files"===t.toLowerCase());return this.disableDropzone||!e}}return t.\u0275fac=function(e){return new(e||t)(c.Y36(c.SBq))},t.\u0275dir=c.lG2({type:t,selectors:[["","fileDropzone",""]],inputs:{disableDropzoneClick:"disableDropzoneClick",disableDropzone:"disableDropzone",clickButton:"clickButton",uploadConfig:["fileDropzone","uploadConfig"]},outputs:{filesDropped:"filesDropped"}}),t})();var Tn=n(67451),qn=n(26982);const On=["trackLinkInput"];function In(t,e){if(1&t&&(c.TgZ(0,"mat-chip",23),c._uU(1),c.qZA()),2&t){const t=c.oxw();c.xp6(1),c.Oqu(t.media.genres[0].name)}}let Pn=(()=>{class t{constructor(t,e){this.settings=t,this.urls=e}ngOnInit(){setTimeout(()=>{this.trackLinkInput.nativeElement.focus(),this.trackLinkInput.nativeElement.select()})}mediaLink(){return this.isTrack(this.media)?this.urls.track(this.media):this.urls.album(this.media)}mediaUrl(){return this.urls.routerLinkToUrl(this.mediaLink())}shareUsing(t){(0,qn.u)(t,this.mediaUrl())}isTrack(t){return t.model_type===Tn.l}}return t.\u0275fac=function(e){return new(e||t)(c.Y36(d.Z),c.Y36(pt.J))},t.\u0275cmp=c.Xpm({type:t,selectors:[["uploaded-media-preview"]],viewQuery:function(t,e){if(1&t&&c.Gf(On,7),2&t){let t;c.iGM(t=c.CRH())&&(e.trackLinkInput=t.first)}},hostAttrs:[1,"material-panel"],inputs:{media:"media"},decls:32,vars:14,consts:[[1,"media-image-container"],[3,"media"],["alt","album border image",1,"album-border-image",3,"src"],[1,"middle-column"],[1,"artist-name"],[1,"track-name"],[1,"genre-row"],["class","track-genre",4,"ngIf"],[1,"message"],["trans",""],["trans","",3,"routerLink"],[1,"right-column"],["trans","",1,"title"],[1,"share-icons"],["mat-icon-button","",3,"click"],["alt","facebook-icon",3,"src"],["alt","twitter-icon",3,"src"],["alt","tumblr-icon",3,"src"],["alt","blogger-icon",3,"src"],[1,"track-link-input","input-container"],["for","media-item-link","trans","",1,"hidden"],["id","media-item-link","type","text","readonly","",3,"value","click"],["trackLinkInput",""],[1,"track-genre"]],template:function(t,e){1&t&&(c.TgZ(0,"div",0),c._UZ(1,"media-image",1),c._UZ(2,"img",2),c.qZA(),c.TgZ(3,"div",3),c.TgZ(4,"div",4),c._uU(5),c.qZA(),c.TgZ(6,"div",5),c._uU(7),c.qZA(),c.TgZ(8,"div",6),c.YNc(9,In,2,1,"mat-chip",7),c.qZA(),c.TgZ(10,"div",8),c.TgZ(11,"span",9),c._uU(12,"Upload complete."),c.qZA(),c.TgZ(13,"a",10),c._uU(14," View now."),c.qZA(),c.qZA(),c.qZA(),c.TgZ(15,"div",11),c.TgZ(16,"div",12),c._uU(17),c.qZA(),c.TgZ(18,"div",13),c.TgZ(19,"button",14),c.NdJ("click",function(){return e.shareUsing("facebook")}),c._UZ(20,"img",15),c.qZA(),c.TgZ(21,"button",14),c.NdJ("click",function(){return e.shareUsing("twitter")}),c._UZ(22,"img",16),c.qZA(),c.TgZ(23,"button",14),c.NdJ("click",function(){return e.shareUsing("tumblr")}),c._UZ(24,"img",17),c.qZA(),c.TgZ(25,"button",14),c.NdJ("click",function(){return e.shareUsing("blogger")}),c._UZ(26,"img",18),c.qZA(),c.qZA(),c.TgZ(27,"div",19),c.TgZ(28,"label",20),c._uU(29,"Media link"),c.qZA(),c.TgZ(30,"input",21,22),c.NdJ("click",function(t){return t.target.select()}),c.qZA(),c.qZA(),c.qZA()),2&t&&(c.ekj("show-album-border",!e.isTrack(e.media)),c.xp6(1),c.Q6J("media",e.media),c.xp6(1),c.Q6J("src",e.settings.getAssetUrl("images/album-border.png"),c.LSH),c.xp6(3),c.Oqu(e.media.artists[0].name),c.xp6(2),c.Oqu(e.media.name),c.xp6(2),c.Q6J("ngIf",e.media.genres.length),c.xp6(4),c.Q6J("routerLink",e.mediaLink()),c.xp6(4),c.hij("Share your new ",e.isTrack(e.media)?"track":"album",""),c.xp6(3),c.s9C("src",e.settings.getAssetUrl("images/social-icons/facebook.png"),c.LSH),c.xp6(2),c.s9C("src",e.settings.getAssetUrl("images/social-icons/twitter.png"),c.LSH),c.xp6(2),c.s9C("src",e.settings.getAssetUrl("images/social-icons/tumblr.png"),c.LSH),c.xp6(2),c.s9C("src",e.settings.getAssetUrl("images/social-icons/bloggr.png"),c.LSH),c.xp6(4),c.Q6J("value",e.mediaUrl()))},directives:[P.P,i.O5,f.P,a.yS,x.lW,ge.HS],styles:["[_nghost-%COMP%]{display:flex;align-items:center;min-width:800px;max-width:100%}.media-image-container[_ngcontent-%COMP%]{flex-shrink:0;width:130px;height:130px}.media-image-container.show-album-border[_ngcontent-%COMP%]{position:relative;margin:15px 15px 15px 20px}.media-image-container.show-album-border[_ngcontent-%COMP%]   .album-border-image[_ngcontent-%COMP%]{display:block}media-image[_ngcontent-%COMP%]     img{position:relative;z-index:2}.album-border-image[_ngcontent-%COMP%]{display:none;position:absolute;width:160px;height:160px;top:-15px;left:-15px;z-index:1}.middle-column[_ngcontent-%COMP%], .right-column[_ngcontent-%COMP%]{flex:1 1 auto}.middle-column[_ngcontent-%COMP%]{padding:0 20px}.artist-name[_ngcontent-%COMP%]{color:var(--be-secondary-text)}.track-name[_ngcontent-%COMP%]{font-weight:500}.genre-row[_ngcontent-%COMP%]{margin:10px 0 20px}.right-column[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{color:var(--be-secondary-text);margin-bottom:5px}.right-column[_ngcontent-%COMP%]   .share-icons[_ngcontent-%COMP%]{margin-bottom:30px}.right-column[_ngcontent-%COMP%]   .mat-icon-button[_ngcontent-%COMP%]{margin-right:5px;width:32px;height:32px;line-height:32px}.right-column[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:100%;height:100%}.input-container[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{height:35px}"],changeDetection:0}),t})();const Mn=["clickMatButton"];function Un(t,e){if(1&t){const t=c.EpF();c.TgZ(0,"div",10),c.TgZ(1,"mat-slide-toggle",11),c.NdJ("change",function(e){return c.CHM(t),c.oxw().createAlbum$.next(e.checked)}),c._uU(2,"Make an album when multiple files are selected"),c.qZA(),c.qZA()}}function Jn(t,e){if(1&t&&(c.TgZ(0,"div",12),c.TgZ(1,"span"),c._uU(2),c.TgZ(3,"a",13),c._uU(4,"Pro accounts"),c.qZA(),c._uU(5," to get more time and access to advanced features."),c.qZA(),c.qZA()),2&t){const t=e.ngIf;c.xp6(2),c.hij("You have ",t," minutes left. Try ")}}function Qn(t,e){if(1&t){const t=c.EpF();c.TgZ(0,"album-form",18),c.NdJ("saved",function(e){return c.CHM(t),c.oxw(3).addSavedMedia(e)}),c.qZA()}}function Fn(t,e){if(1&t){const t=c.EpF();c.TgZ(0,"div",20),c.TgZ(1,"track-form",21),c.NdJ("saved",function(e){return c.CHM(t),c.oxw(5).addSavedMedia(e)}),c.qZA(),c.qZA()}if(2&t){const t=e.$implicit;c.xp6(1),c.Q6J("uploadQueueItem",t)}}function Nn(t,e){if(1&t&&(c.ynx(0),c.YNc(1,Fn,2,1,"div",19),c.BQk()),2&t){const t=c.oxw(3).ngIf,e=c.oxw();c.xp6(1),c.Q6J("ngForOf",t)("ngForTrackBy",e.trackByFn)}}function Yn(t,e){if(1&t&&(c.YNc(0,Nn,2,2,"ng-container",15),c.ALo(1,"async")),2&t){const t=c.oxw(3);c.Q6J("ngIf",c.lcZ(1,1,t.errors$))}}function $n(t,e){if(1&t&&(c.ynx(0),c.YNc(1,Qn,1,0,"album-form",16),c.ALo(2,"async"),c.YNc(3,Yn,2,3,"ng-template",null,17,c.W1O),c.BQk()),2&t){const t=c.MAs(4),e=c.oxw(2);c.xp6(1),c.Q6J("ngIf",c.lcZ(2,2,e.createAlbum$))("ngIfElse",t)}}function Sn(t,e){if(1&t&&(c.TgZ(0,"div",14),c.YNc(1,$n,5,4,"ng-container",15),c.qZA()),2&t){const t=e.ngIf;c.xp6(1),c.Q6J("ngIf",t.length)}}function Dn(t,e){1&t&&c._UZ(0,"uploaded-media-preview",22),2&t&&c.Q6J("media",e.$implicit)}const En=[{path:"",redirectTo:"/",pathMatch:"full"},{path:"requests",component:ct},{path:"requests/verify-artist",component:nt},{path:"requests/become-artist",component:nt},{path:"requests/claim-artist",component:nt},{path:"requests/:requestId/request-submitted",component:it},{path:"upload",component:(()=>{class t{constructor(t,e,n,i,a,r,s,c){this.track=t,this.currentUser=e,this.uploadQueue=n,this.settings=i,this.tracks=a,this.toast=r,this.audioValidator=s,this.waveGenerator=c,this.errors$=new o.X({}),this.uploadConfig={types:[te.j.video,te.j.audio],multiple:!0},this.savedMedia$=new o.X([]),this.createAlbum$=new o.X(!1),this.trackByFn=(t,e)=>e.id}uploadTracks(t){this.uploadQueue.start(t,{uri:"uploads",httpParams:{diskPrefix:"track_media",disk:"public"},validator:this.audioValidator,willProcessFiles:!0,autoMatchAlbum:!this.createAlbum$.value}).subscribe(t=>{const e=this.uploadQueue.find(t.queueItemId);this.waveGenerator.generate(e.uploadedFile.native).then(t=>{e.customData={waveData:t},e.finishProcessing()}),this.albumForm&&!this.albumForm.form.get("name").value&&t.metadata.album_name&&this.albumForm.form.patchValue({name:t.metadata.album_name})})}addSavedMedia(t){this.savedMedia$.next([...this.savedMedia$.value,t])}}return t.\u0275fac=function(e){return new(e||t)(c.Y36(ae.O),c.Y36(_t.I),c.Y36(g.A),c.Y36(d.Z),c.Y36(ae.O),c.Y36(dt.F),c.Y36(le),c.Y36(ue.qQ))},t.\u0275cmp=c.Xpm({type:t,selectors:[["upload-page"]],viewQuery:function(t,e){if(1&t&&(c.Gf(Mn,7,c.SBq),c.Gf(bn,5),c.Gf(rn,5)),2&t){let t;c.iGM(t=c.CRH())&&(e.clickButton=t.first),c.iGM(t=c.CRH())&&(e.albumForm=t.first),c.iGM(t=c.CRH())&&(e.trackForms=t)}},features:[c._Bn([g.A])],decls:14,vars:10,consts:[[1,"dropzone",3,"fileDropzone","clickButton","filesDropped"],["trans","",1,"title"],[1,"action-button"],["mat-flat-button","","color","accent","type","button","trans","",1,"upload-button"],["clickMatButton",""],["class","setting-toggle-container",4,"ngIf"],["class","minutes-container",4,"ngIf"],["class","track-upload-queue",4,"ngIf"],[1,"saved-tracks"],[3,"media",4,"ngFor","ngForOf"],[1,"setting-toggle-container"],["trans","",3,"change"],[1,"minutes-container"],["routerLink","/billing/upgrade","target","_blank",1,"hover-underline"],[1,"track-upload-queue"],[4,"ngIf"],["class","material-panel",3,"saved",4,"ngIf","ngIfElse"],["createTracks",""],[1,"material-panel",3,"saved"],["class","track-panel material-panel",4,"ngFor","ngForOf","ngForTrackBy"],[1,"track-panel","material-panel"],[3,"uploadQueueItem","saved"],[3,"media"]],template:function(t,e){1&t&&(c.TgZ(0,"div",0),c.NdJ("filesDropped",function(t){return e.uploadTracks(t)}),c.TgZ(1,"div",1),c._uU(2,"Drag and drop your tracks, videos & albums here."),c.qZA(),c.TgZ(3,"div",2),c.TgZ(4,"button",3,4),c._uU(6," or choose files to upload "),c.qZA(),c.qZA(),c.YNc(7,Un,3,0,"div",5),c.qZA(),c.YNc(8,Jn,6,1,"div",6),c.YNc(9,Sn,2,1,"div",7),c.ALo(10,"async"),c.TgZ(11,"div",8),c.YNc(12,Dn,1,1,"uploaded-media-preview",9),c.ALo(13,"async"),c.qZA()),2&t&&(c.Q6J("fileDropzone",e.uploadConfig)("clickButton",e.clickButton),c.xp6(7),c.Q6J("ngIf",e.uploadQueue.isEmpty()),c.xp6(1),c.Q6J("ngIf",e.currentUser.getRestrictionValue("tracks.create","minutes")),c.xp6(1),c.Q6J("ngIf",c.lcZ(10,6,e.uploadQueue.uploads$)),c.xp6(3),c.Q6J("ngForOf",c.lcZ(13,8,e.savedMedia$)))},directives:[wn,f.P,x.lW,i.O5,i.sg,Qt.Rr,a.yS,bn,rn,Pn],pipes:[i.Ov],styles:["admin[_nghost-%COMP%], admin   [_nghost-%COMP%]{min-height:calc(100vh - 120px)}[_nghost-%COMP%]{display:flex;align-items:center;justify-content:center;flex-direction:column;min-height:100%}.dropzone[_ngcontent-%COMP%]{background:var(--be-background);padding:50px;border-radius:4px;text-align:center;border:1px solid var(--be-divider-default);min-width:520px;max-width:90%}.dropzone[_ngcontent-%COMP%]   .action-button[_ngcontent-%COMP%]{margin-top:20px}.dropzone[_ngcontent-%COMP%]   .setting-toggle-container[_ngcontent-%COMP%]{margin-top:20px;padding-top:20px;border-top:1px solid var(--be-divider-lighter);font-size:1.3rem}.dropzone[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{font-size:1.8rem}.dropzone[_ngcontent-%COMP%]   p[_ngcontent-%COMP%], .dropzone[_ngcontent-%COMP%]   .setting-toggle-container[_ngcontent-%COMP%]{margin-bottom:0}.dropzone.file-over-dropzone[_ngcontent-%COMP%]{border-color:var(--be-accent-default);background-color:var(--be-accent-emphasis)}.create-artists-toggle[_ngcontent-%COMP%]{margin-top:20px;min-width:520px;text-align:center}.minutes-container[_ngcontent-%COMP%]{color:var(--be-secondary-text);font-size:1.5rem;margin-top:20px}.minutes-container[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{color:var(--be-accent-default)}.track-upload-queue[_ngcontent-%COMP%]{width:100%;margin-top:40px}.track-panel[_ngcontent-%COMP%]{margin-bottom:20px;padding:20px 25px}uploaded-media-preview[_ngcontent-%COMP%]{margin-bottom:15px}"],changeDetection:0}),t})()},{path:"artists/new",component:Bt},{path:"artists/:id/edit",component:Bt,resolve:{api:Gt},canDeactivate:[vn]},{path:"albums/:id/edit",component:xn,resolve:{api:(()=>{class t{constructor(t,e){this.albums=t,this.router=e}resolve(t,e){const n=+t.paramMap.get("id");return this.albums.get(n,{with:["tags","genres","artists","fullTracks"],albumsPerPage:50,forEditing:!0}).pipe((0,w.K)(()=>(this.router.navigate(["/"]),Vt.E)),(0,Rt.zg)(t=>t.album?(0,A.of)(t):(this.router.navigate(["/"]),Vt.E)))}}return t.\u0275fac=function(e){return new(e||t)(c.LFG(Zt.R),c.LFG(a.F0))},t.\u0275prov=c.Yz7({token:t,factory:t.\u0275fac,providedIn:"root"}),t})()},canDeactivate:[vn]},{path:"albums/new",component:xn,canDeactivate:[vn]},{path:"tracks/:id/edit",component:Zn,resolve:{api:_n.T},canDeactivate:[vn]},{path:"tracks/new",component:Zn,canDeactivate:[vn]}];let Ln=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=c.oAB({type:t}),t.\u0275inj=c.cJS({imports:[[a.Bz.forChild(En)],a.Bz]}),t})();var Hn=n(18295),zn=n(49866),Bn=n(36702),Rn=n(66705),Vn=n(98097),Gn=n(39079),jn=n(43389);let Xn=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=c.oAB({type:t}),t.\u0275inj=c.cJS({imports:[[i.ez,O.Tx,Gn.M,zn.N,u.u5,u.UX,v.Ps,jn.p,x.ot]]}),t})();var Wn=n(87738),Kn=n(40557),ti=n(55688),ei=n(22449);let ni=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=c.oAB({type:t}),t.\u0275inj=c.cJS({imports:[[i.ez,a.Bz,Gn.M,Xn,v.Ps,ye.Cv,zn.N,Rn.z,u.UX,u.u5,x.ot,Wn.G,ge.Hi,Qt.rP,kt.AV,Bn.a,jt._t,me.Bb,O.Tx,jn.p,ei.W]]}),t})();var ii=n(22213);let ai=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=c.oAB({type:t}),t.\u0275inj=c.cJS({imports:[[i.ez,Ln,ni,u.UX,u.u5,Xn,zn.N,Hn.l,x.ot,v.Ps,Qt.rP,Rn.z,Bn.a,Vn.X,ti.s,jn.p,ii.Is,mt.Nh,Wn.G,Kn.x,Gn.M,kt.AV]]}),t})()},81371:function(t,e,n){n.d(e,{T:function(){return o}});var i=n(2316),a=n(90299);let o=(()=>{class t{constructor(t){this.http=t}getRequest(t){return this.http.get(`backstage-request/${t}`)}submitRequest(t){return this.http.post("backstage-request",t)}approveRequest(t,e={}){return this.http.post(`backstage-request/${t}/approve`,e)}denyRequest(t,e={}){return this.http.post(`backstage-request/${t}/deny`,e)}deleteRequests(t){return this.http.delete(`backstage-request/${t.join(",")}`)}}return t.\u0275fac=function(e){return new(e||t)(i.LFG(a.r))},t.\u0275prov=i.Yz7({token:t,factory:t.\u0275fac,providedIn:"root"}),t})()},56297:function(t,e,n){n.d(e,{n:function(){return i}});var i=(()=>{return(t=i||(i={})).becomeArtist="become-artist",t.verifyArtist="verify-artist",t.claimArtist="claim-artist",i;var t})()},44666:function(t,e,n){n.d(e,{S:function(){return w}});var i=n(1707),a=n(76491),o=n(81134),r=n(80639),s=n(83720),c=n(79902),l=n(18293),u=n(2316),d=n(79243),p=n(54364),m=n(65924),g=n(52529),h=n(24298),f=n(63297);const b=["auto"],x=["inputEl"],v=["selectModeTemplate"];function Z(t,e){if(1&t){const t=u.EpF();u.TgZ(0,"mat-chip",8),u.NdJ("removed",function(){const e=u.CHM(t).index;return u.oxw().remove(e)}),u._uU(1),u._UZ(2,"mat-icon",9),u.qZA()}if(2&t){const t=e.$implicit,n=u.oxw();u.Q6J("selectable",!1)("removable",!n.selectMode),u.xp6(1),u.hij(" ",n.displayChipValue(t)," ")}}const _=function(t){return{elementRef:t}};function A(t,e){if(1&t){const t=u.EpF();u.TgZ(0,"input",10,11),u.NdJ("matChipInputTokenEnd",function(e){return u.CHM(t),u.oxw().addFromChipInput(e.value)}),u.ALo(2,"trans"),u.qZA()}if(2&t){const t=u.oxw(),e=u.MAs(1),n=u.MAs(6);u.Q6J("placeholder",u.lcZ(2,7,t.placeholder))("type",t.type)("matChipInputFor",e)("matChipInputAddOnBlur",!0)("matAutocomplete",n)("matAutocompleteConnectedTo",u.VKq(9,_,t.el))("formControl",t.formControl)}}function y(t,e){if(1&t&&(u.TgZ(0,"mat-option",12),u._uU(1),u.qZA()),2&t){const t=e.$implicit,n=u.oxw();u.Q6J("value",t),u.xp6(1),u.Oqu(n.displayChipValue(t))}}function C(t,e){if(1&t&&(u.TgZ(0,"mat-option",12),u._uU(1),u.qZA()),2&t){const t=e.$implicit,n=u.oxw(2);u.Q6J("value",t),u.xp6(1),u.Oqu(n.displayChipValue(t))}}function k(t,e){1&t&&u.YNc(0,C,2,2,"mat-option",6),2&t&&u.Q6J("ngForOf",e.suggestions)}let w=(()=>{class t{constructor(t){this.el=t,this.type="text",this.emailsInput=!1,this.selectMode=!1,this.formControl=new i.NI,this.items$=new a.X([]),this.suggestedValues$=new a.X([])}set suggestedValues(t){this.suggestedValues$.next(t)}ngOnInit(){this.suggestFn&&this.bindToSearchControl()}ngAfterViewInit(){this.emailsInput&&this.parseEmailsOnPaste()}remove(t){const e=[...this.items$.value];e.splice(t,1),this.items$.next(e),this.propagateChange(this.items$.value)}addFromChipInput(t,e=!0){t&&!this.matAutocomplete.isOpen&&!this.selectMode&&this.add(t,e)}addFromAutocomplete(t,e=!0){this.add(t,e)}add(t,e=!0){t="string"==typeof t?t.trim():t;const n=this.findValueIndex(t)>-1;t&&!n&&(this.items$.next([...this.items$.value,t]),e&&this.propagateChange(this.items$.value)),this.inputEl&&(this.inputEl.nativeElement.value=""),this.formControl.setValue(null),this.suggestedValues$.next([])}findValueIndex(t){return"string"==typeof t?this.items$.value.indexOf(t):this.items$.value.findIndex(e=>e.id===t.id)}writeValue(t=[]){this.items$.next(t||[])}registerOnChange(t){this.propagateChange=t}registerOnTouched(){}bindToSearchControl(){this.formControl.valueChanges.pipe((0,r.b)(150),(0,s.x)(),(0,c.w)(t=>t?this.suggestFn(t):(0,o.of)([])),(0,l.K)(()=>(0,o.of)([]))).subscribe(t=>{const e=t.filter(t=>-1===this.findValueIndex(t));this.suggestedValues$.next(e)})}displayChipValue(t){return"object"==typeof t?t.name:t}parseEmailsOnPaste(){this.inputEl.nativeElement.addEventListener("paste",t=>{const e=(t.clipboardData||window.clipboardData).getData("text").match(/([a-zA-Z0-9._-]+@[a-zA-Z0-9._-]+\.[a-zA-Z0-9._-]+)/gi);if(e){t.preventDefault();const n=window.getSelection();n.rangeCount&&(n.deleteFromDocument(),e.forEach(t=>this.add(t)))}})}}return t.\u0275fac=function(e){return new(e||t)(u.Y36(u.SBq))},t.\u0275cmp=u.Xpm({type:t,selectors:[["chip-input"]],viewQuery:function(t,e){if(1&t&&(u.Gf(b,5),u.Gf(x,5),u.Gf(v,5)),2&t){let t;u.iGM(t=u.CRH())&&(e.matAutocomplete=t.first),u.iGM(t=u.CRH())&&(e.inputEl=t.first),u.iGM(t=u.CRH())&&(e.selectModeTemplate=t.first)}},hostVars:2,hostBindings:function(t,e){2&t&&u.ekj("select-mode",e.selectMode)},inputs:{placeholder:"placeholder",type:"type",emailsInput:"emailsInput",suggestFn:"suggestFn",selectMode:"selectMode",suggestedValues:"suggestedValues"},features:[u._Bn([{provide:i.JU,useExisting:t,multi:!0}])],decls:11,vars:9,consts:[[3,"selectable"],["chipList",""],[3,"selectable","removable","removed",4,"ngFor","ngForOf"],["class","mat-chip-input mat-input-element",3,"placeholder","type","matChipInputFor","matChipInputAddOnBlur","matAutocomplete","matAutocompleteConnectedTo","formControl","matChipInputTokenEnd",4,"ngIf"],[1,"chip-input-autocomplete-panel",3,"autoActiveFirstOption","optionSelected"],["auto","matAutocomplete"],[3,"value",4,"ngFor","ngForOf"],["selectModeTemplate",""],[3,"selectable","removable","removed"],["matChipRemove","","svgIcon","cancel"],[1,"mat-chip-input","mat-input-element",3,"placeholder","type","matChipInputFor","matChipInputAddOnBlur","matAutocomplete","matAutocompleteConnectedTo","formControl","matChipInputTokenEnd"],["inputEl",""],[3,"value"]],template:function(t,e){1&t&&(u.TgZ(0,"mat-chip-list",0,1),u.YNc(2,Z,3,3,"mat-chip",2),u.ALo(3,"async"),u.YNc(4,A,3,11,"input",3),u.qZA(),u.TgZ(5,"mat-autocomplete",4,5),u.NdJ("optionSelected",function(t){return e.addFromAutocomplete(t.option.value)}),u.YNc(7,y,2,2,"mat-option",6),u.ALo(8,"async"),u.qZA(),u.YNc(9,k,1,1,"ng-template",null,7,u.W1O)),2&t&&(u.Q6J("selectable",!1),u.xp6(2),u.Q6J("ngForOf",u.lcZ(3,5,e.items$)),u.xp6(2),u.Q6J("ngIf",!e.selectMode),u.xp6(1),u.Q6J("autoActiveFirstOption",!0),u.xp6(2),u.Q6J("ngForOf",u.lcZ(8,7,e.suggestedValues$)))},directives:[d.qn,p.sg,p.O5,m.XC,d.HS,g.Hw,d.qH,d.oH,m.ZL,i.Fj,i.JJ,i.oH,h.ey],pipes:[p.Ov,f.R],styles:["chip-input{display:block;min-height:46px}chip-input .mat-chip-list-wrapper{width:100%;height:100%;color:inherit;border:1px solid var(--be-divider-default);padding:6px;line-height:normal;font-size:1.4rem;font-family:inherit;background-color:inherit;box-sizing:border-box;border-radius:2px;margin:0}chip-input .mat-chip-input{height:24px;font:inherit;background:0 0;color:currentColor;border:none;outline:0;padding:0;margin:0;width:0;max-width:100%;vertical-align:bottom;text-align:inherit}chip-input .mat-chip-input:focus{outline:none;box-shadow:none}.chip-input-select-panel{background-color:var(--be-background);min-width:180px;box-shadow:0 2px 4px -1px rgba(0,0,0,.2),0 4px 5px rgba(0,0,0,.141),0 1px 10px rgba(0,0,0,.122)}\n"],encapsulation:2,changeDetection:0}),t})()},18909:function(t,e,n){n.d(e,{r:function(){return o}});var i=n(54364),a=n(2316);let o=(()=>{class t extends i.rS{transform(t){return t?super.transform(t.replace("-"," ").replace("_"," ")):""}}return t.\u0275fac=function(){let e;return function(n){return(e||(e=a.n5z(t)))(n||t)}}(),t.\u0275pipe=a.Yjl({name:"titleCase",type:t,pure:!0}),t})()},47332:function(t,e,n){function i(t,e=""){let n=Object.keys(t)[0];if(n){e&&(n=`${e}-${n}`);const t=document.getElementById(n);t&&t.scrollIntoView({behavior:"smooth",block:"center",inline:"center"})}}n.d(e,{f:function(){return i}})},70236:function(t,e,n){n.d(e,{G:function(){return F}});var i=n(2316);const a=[{originX:"start",originY:"center",overlayX:"end",overlayY:"center",offsetX:50},{originX:"end",originY:"center",overlayX:"start",overlayY:"center",offsetX:50}];var o=n(72100),r=n(22213),s=n(67310),c=n(52529),l=n(15515),u=n(1707),d=n(54364),p=n(70781);function m(t,e){1&t&&i.GkF(0)}let g=(()=>{class t{constructor(t,e){this.data=t,this.overlayPanelRef=e}close(){this.overlayPanelRef.close()}}return t.\u0275fac=function(e){return new(e||t)(i.Y36(o.p),i.Y36(s.L))},t.\u0275cmp=i.Xpm({type:t,selectors:[["datatable-filters-panel"]],hostVars:1,hostBindings:function(t,e){2&t&&i.d8E("@dialogContainer","enter")},decls:9,vars:1,consts:[["svgIcon","filter-list"],["trans",""],[1,"body",3,"ngSubmit"],[4,"ngTemplateOutlet"],["type","button","mat-button","","color","accent","trans","",3,"click"]],template:function(t,e){1&t&&(i.TgZ(0,"header"),i._UZ(1,"mat-icon",0),i.TgZ(2,"span",1),i._uU(3,"Filters"),i.qZA(),i.qZA(),i.TgZ(4,"form",2),i.NdJ("ngSubmit",function(){return e.close()}),i.YNc(5,m,1,0,"ng-container",3),i.qZA(),i.TgZ(6,"footer"),i.TgZ(7,"button",4),i.NdJ("click",function(){return e.close()}),i._uU(8,"Close"),i.qZA(),i.qZA()),2&t&&(i.xp6(5),i.Q6J("ngTemplateOutlet",e.data.filters))},directives:[c.Hw,l.P,u._Y,u.JL,u.F,d.tP,p.lW],styles:["[_nghost-%COMP%]{display:block;min-width:250px;margin:auto;background-color:var(--be-background);border-radius:4px;box-shadow:0 8px 9px -5px rgba(0,0,0,.2),0 15px 22px 2px rgba(0,0,0,.141),0 6px 28px 5px rgba(0,0,0,.122)}header[_ngcontent-%COMP%]{border-bottom:1px solid var(--be-divider-default);padding:15px 20px;margin-bottom:20px;font-weight:500}header[_ngcontent-%COMP%]   .mat-icon[_ngcontent-%COMP%]{vertical-align:middle;margin-right:5px}.body[_ngcontent-%COMP%]{padding-left:20px;padding-right:20px}footer[_ngcontent-%COMP%]{border-top:1px solid var(--be-divider-default);text-align:right;margin-top:10px;padding:10px 20px}"],data:{animation:[r.Nv.dialogContainer]},changeDetection:0}),t})();var h=n(33927),f=n(84889),b=n(66142),x=n(7964),v=n(365),Z=n(3028),_=n(79243),A=n(63297),y=n(18909);const C=["tableFilters"],k=["filterButton"];function w(t,e){1&t&&i._UZ(0,"mat-progress-bar",7)}function T(t,e){1&t&&(i.TgZ(0,"div",8),i.Hsn(1),i.qZA())}const q=function(t,e){return{count:t,resource:e}};function O(t,e){if(1&t&&(i.TgZ(0,"div",9),i._uU(1),i.ALo(2,"trans"),i.qZA()),2&t){const t=i.oxw();i.xp6(1),i.hij(" ",i.xi3(2,1,":count :resource selected",i.WLB(4,q,t.numberOfRowsSelected,t.pluralResourceName))," ")}}function I(t,e){if(1&t){const t=i.EpF();i.TgZ(0,"mat-chip",18),i.NdJ("removed",function(){const e=i.CHM(t).$implicit;return i.oxw(3).datatable.removeFilter(e.key)}),i._uU(1),i.ALo(2,"trans"),i.ALo(3,"titleCase"),i._UZ(4,"mat-icon",19),i.qZA()}if(2&t){const t=e.$implicit,n=i.oxw(3);i.Q6J("removable",!0)("selectable",!1),i.xp6(1),i.AsE(" ",i.lcZ(2,4,i.lcZ(3,6,t.key)),": ",n.isModel(t.value)?t.value.name||t.value.display_name:t.value," ")}}function P(t,e){if(1&t){const t=i.EpF();i.ynx(0),i.TgZ(1,"mat-chip-list",13),i.YNc(2,I,5,8,"mat-chip",14),i.ALo(3,"keyvalue"),i.ALo(4,"async"),i.qZA(),i.TgZ(5,"button",15,16),i.NdJ("click",function(){return i.CHM(t),i.oxw(2).openFiltersPanel()}),i._UZ(7,"mat-icon",17),i.qZA(),i.BQk()}if(2&t){const t=i.oxw(2);i.xp6(2),i.Q6J("ngForOf",i.lcZ(3,3,i.lcZ(4,5,t.filters$))),i.xp6(3),i.ekj("active",t.filterPanelRef)}}function M(t,e){if(1&t&&(i.TgZ(0,"div",10),i.YNc(1,P,8,7,"ng-container",11),i._UZ(2,"datatable-header-search-input",12),i.qZA()),2&t){const t=i.oxw();i.xp6(1),i.Q6J("ngIf",t.filterPanelTemplate),i.xp6(1),i.MGl("placeholder","Search ",t.pluralResourceName,"")}}function U(t,e){1&t&&(i.TgZ(0,"div",20),i.Hsn(1,1),i.qZA())}const J=[[["","leftContent",""]],[["","rightContent",""]]],Q=["[leftContent]","[rightContent]"];let F=(()=>{class t{constructor(t,e,n){this.datatable=t,this.cd=e,this.overlayPanel=n,this.showSelectedActions=!0,this.subscriptions=[],this.filters$=this.datatable.filters$.pipe((0,h.U)(t=>{const e=(0,f.N)(t);return delete e.query,e}))}ngOnInit(){const t=this.datatable.filters$.subscribe(()=>{this.filterPanelRef&&this.filterPanelRef.close()}),e=this.datatable.selectedRows$.subscribe(t=>{this.numberOfRowsSelected=t.length,this.cd.markForCheck()});this.subscriptions=[t,e]}ngOnDestroy(){this.subscriptions.forEach(t=>t.unsubscribe())}openFiltersPanel(){if(this.filterPanelRef)this.filterPanelRef.close();else{const t=a.slice();t[0].offsetY=40,t[1].offsetY=40,this.filterPanelRef=this.overlayPanel.open(g,{origin:this.filterButton,position:t,mobilePosition:"center",data:{filters:this.filterPanelTemplate},maxWidth:"90%"}),this.filterButton.nativeElement.classList.add("active"),this.filterPanelRef.afterClosed().subscribe(()=>{this.filterPanelRef=null,this.filterButton.nativeElement.classList.remove("active")})}}isModel(t){return"object"==typeof t&&t.id}}return t.\u0275fac=function(e){return new(e||t)(i.Y36(b.x),i.Y36(i.sBO),i.Y36(x.T))},t.\u0275cmp=i.Xpm({type:t,selectors:[["datatable-header"]],contentQueries:function(t,e,n){if(1&t&&i.Suo(n,C,5),2&t){let t;i.iGM(t=i.CRH())&&(e.filterPanelTemplate=t.first)}},viewQuery:function(t,e){if(1&t&&i.Gf(k,5,i.SBq),2&t){let t;i.iGM(t=i.CRH())&&(e.filterButton=t.first)}},hostVars:2,hostBindings:function(t,e){2&t&&i.ekj("rows-selected",e.numberOfRowsSelected)},inputs:{pluralResourceName:"pluralResourceName",showSelectedActions:"showSelectedActions"},ngContentSelectors:Q,decls:8,vars:7,consts:[["mode","indeterminate","color","accent",4,"ngIf"],[1,"left-column"],["class","default-left-content",4,"ngIf"],["class","selected-left-content capitalize",4,"ngIf"],[1,"right-column"],["class","default-right-content",4,"ngIf"],["class","selected-right-actions",4,"ngIf"],["mode","indeterminate","color","accent"],[1,"default-left-content"],[1,"selected-left-content","capitalize"],[1,"default-right-content"],[4,"ngIf"],[3,"placeholder"],["aria-label","Active Filters",1,"filter-chip-list"],[3,"removable","selectable","removed",4,"ngFor","ngForOf"],["mat-icon-button","",1,"filter-button",3,"click"],["filterButton",""],["svgIcon","filter-list"],[3,"removable","selectable","removed"],["matChipRemove","","svgIcon","cancel"],[1,"selected-right-actions"]],template:function(t,e){1&t&&(i.F$t(J),i.YNc(0,w,1,0,"mat-progress-bar",0),i.ALo(1,"async"),i.TgZ(2,"div",1),i.YNc(3,T,2,0,"div",2),i.YNc(4,O,3,7,"div",3),i.qZA(),i.TgZ(5,"div",4),i.YNc(6,M,3,2,"div",5),i.YNc(7,U,2,0,"div",6),i.qZA()),2&t&&(i.Q6J("ngIf",i.lcZ(1,5,e.datatable.paginator&&e.datatable.paginator.loading$)),i.xp6(3),i.Q6J("ngIf",!e.showSelectedActions||!e.numberOfRowsSelected),i.xp6(1),i.Q6J("ngIf",e.showSelectedActions&&e.numberOfRowsSelected),i.xp6(2),i.Q6J("ngIf",!e.showSelectedActions||!e.numberOfRowsSelected),i.xp6(1),i.Q6J("ngIf",e.showSelectedActions&&e.numberOfRowsSelected))},directives:[d.O5,v.pW,Z.w,_.qn,d.sg,p.lW,c.Hw,_.HS,_.qH],pipes:[d.Ov,A.R,d.Nd,y.r],styles:[".rows-selected[_nghost-%COMP%], .rows-selected   [_nghost-%COMP%]{background-color:var(--be-accent-emphasis);color:var(--be-secondary-text);font-size:1.5rem;border-color:var(--be-divider-default)}[_nghost-%COMP%]{display:flex;align-items:center;height:85px;padding:15px;border-bottom:1px solid transparent;position:relative}.mat-progress-bar[_ngcontent-%COMP%]{position:absolute;top:0;left:0}.left-column[_ngcontent-%COMP%]{margin-right:auto}.right-column[_ngcontent-%COMP%]{margin-left:25px}.default-right-content[_ngcontent-%COMP%]{display:flex;align-items:center}.filter-button[_ngcontent-%COMP%]{margin-right:10px}.active[_ngcontent-%COMP%]{color:var(--be-accent-default)}.mat-chip[_ngcontent-%COMP%]{text-transform:capitalize}  datatable-header info-popover{margin-left:10px}"],changeDetection:0}),t})()},52644:function(t,e,n){n.d(e,{y:function(){return o}});var i=n(1796),a=n(2316);let o=(()=>{class t{transform(t=0,e){return isNaN(parseFloat(String(t)))||!isFinite(t)?"-":(0,i.H)(t,e)}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275pipe=a.Yjl({name:"formattedFileSize",type:t,pure:!0}),t})()}}]);
//# sourceMappingURL=383-es2015.4bf7792b989b917dd276.js.map